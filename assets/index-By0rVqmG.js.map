{"version":3,"file":"index-By0rVqmG.js","sources":["../../src/pages/register/index.tsx"],"sourcesContent":["import { SetStateAction, useContext, useEffect, useState } from \"react\";\nimport { EscolaLMSContext } from \"@escolalms/sdk/lib/react/context\";\nimport { Link, useHistory } from \"react-router-dom\";\nimport Layout from \"@/components/_App/Layout\";\nimport { isMobile } from \"react-device-detect\";\nimport { useLocation } from \"react-router-dom\";\nimport { Title } from \"@escolalms/components/lib/components/atoms/Typography/Title\";\n\nimport { Text } from \"@escolalms/components/lib/components/atoms/Typography/Text\";\nimport { RegisterForm } from \"@escolalms/components/lib/components/organisms/RegisterForm/RegisterForm\";\nimport { useTranslation } from \"react-i18next\";\nimport styled from \"styled-components\";\nimport { MarkdownRenderer } from \"@escolalms/components/lib/components/molecules/MarkdownRenderer/MarkdownRenderer\";\nimport { Modal } from \"@escolalms/components/lib/components/atoms/Modal/Modal\";\nimport { Button } from \"@escolalms/components/lib/components/atoms/Button/Button\";\n\nimport { Link as LinkComponent } from \"@escolalms/components/lib/components/atoms/Link/Link\";\nimport Container from \"@/components/Common/Container\";\nimport routeRoutes from \"@/components/Routes/routes\";\nimport { EmailActivationImg } from \"@/icons/index\";\nimport { APP_URL } from \"@/config/index\";\nimport { redirectPrefix } from \"@/utils/router\";\nimport { isMobilePlatform } from \"@/utils/index\";\nimport { metaDataKeys } from \"@/utils/meta\";\n\nconst StyledRegisterPage = styled.div`\n  padding-top: 100px;\n  padding-bottom: 50px;\n  min-height: 900px;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  background-color: ${({ theme }) => theme.gray4};\n\n  @media (max-width: 991px) {\n    padding-top: 100px;\n    height: 100%;\n    padding-bottom: 50px;\n    * {\n      p,\n      a {\n        text-align: center;\n      }\n    }\n  }\n`;\n\nconst StyledLink = styled(Link)`\n  color: ${({ theme }) => theme.primaryColor}!important;\n`;\n\nconst StyledContent = styled.div`\n  background-color: ${({ theme }) => theme.gray4};\n  padding-top: 100px;\n  /* height: calc(100vh - 452px); */\n  @media (max-width: 991px) {\n    height: 100%;\n    padding: 100px 0px;\n    text-align: center;\n  }\n  .image-wrapper {\n    width: 100%;\n    display: flex;\n    justify-content: center;\n    align-items: center;\n    margin-bottom: 50px;\n  }\n  .content-container {\n    display: flex;\n    justify-content: flex-start;\n    align-items: center;\n    flex-direction: column;\n\n    .email-title {\n      text-align: center;\n    }\n\n    .email-main-text {\n      text-align: center;\n      margin: 25px 0 85px;\n      font-weight: 700;\n      span {\n        color: ${({ theme }) => theme.primaryColor};\n      }\n    }\n\n    .email-help-text {\n      margin: 0 auto 20px 0;\n      ul {\n        padding-left: 15px;\n        margin-left: 0;\n        li {\n          font-size: 12px;\n        }\n      }\n    }\n\n    .back-text {\n      text-align: center;\n      margin-top: 20px;\n    }\n  }\n  .back-to-login {\n    margin: 20px 0px;\n  }\n`;\n\nconst StyledModal = styled(Modal)`\n  a {\n    font-size: 1.14em;\n  }\n`;\n\nconst RegisterPage = () => {\n  const { search } = useLocation();\n  const { user, socialAuthorize } = useContext(EscolaLMSContext);\n  const [view, setView] = useState<\"\" | \"success\" | \"register\">(\"\");\n  const [modalVisible, setModalVisible] = useState(false);\n  const { settings } = useContext(EscolaLMSContext);\n\n  const [email, setEmail] = useState<string>(\"\");\n  const history = useHistory();\n  const token = search.split(\"?token=\")[1];\n  const { t } = useTranslation();\n\n  const footerFromApi: string =\n    settings?.value?.config?.[metaDataKeys.registerWarningMetaKey];\n\n  const fieldLabels = {\n    \"AdditionalFields.Privacy Policy\": (\n      <Text size=\"14\">\n        {t(\"AcceptCheckbox\")}{\" \"}\n        <StyledLink to={routeRoutes.privacyPolicy}>\n          {t(\"PrivacyPolicy\")}\n        </StyledLink>\n      </Text>\n    ),\n    \"AdditionalFields.Terms of Service\": (\n      <Text size=\"14\">\n        {t(\"AcceptCheckbox\")}{\" \"}\n        <StyledLink to={routeRoutes.privacyPolicy}>\n          {t(\"TermsOfService\")}\n        </StyledLink>\n      </Text>\n    ),\n  };\n  if (token) {\n    socialAuthorize(token);\n    setTimeout(() => {\n      history.push(routeRoutes.home);\n    }, 1000);\n  }\n\n  if (!user.loading && !token && user.value) {\n    history.push(routeRoutes.home);\n  }\n\n  useEffect(() => {\n    setModalVisible(view === \"success\");\n  }, [view]);\n\n  const EmailActivation = () => {\n    const { config } = useContext(EscolaLMSContext);\n\n    const accountActivationByAdmin =\n      config?.value?.escola_auth?.account_must_be_enabled_by_admin ===\n      \"enabled\";\n\n    return (\n      <StyledContent>\n        <Container>\n          <div className=\"image-wrapper\">\n            <EmailActivationImg />\n          </div>\n\n          <div className=\"content-container\">\n            <Title className=\"email-title\" level={3}>\n              {t(\n                `EmailActivation.${\n                  accountActivationByAdmin ? \"Title2\" : \"Title\"\n                }`\n              )}\n            </Title>\n            {!accountActivationByAdmin && (\n              <MarkdownRenderer\n                components={{\n                  a: (props) => <span>{props.children}</span>,\n                }}\n              >\n                {t(\"EmailActivation.Text\", { email })}\n              </MarkdownRenderer>\n            )}\n\n            <MarkdownRenderer>\n              {t(\n                `EmailActivation.${\n                  accountActivationByAdmin ? \"HelpText2\" : \"HelpText\"\n                }`\n              )}\n            </MarkdownRenderer>\n            {!accountActivationByAdmin && (\n              <div className=\"back-text\">\n                <LinkComponent onClick={() => setView(\"register\")}>\n                  {t(\"EmailActivation.RegisterAgain\")}\n                </LinkComponent>\n              </div>\n            )}\n            <div className=\"back-to-login\">\n              <Button onClick={() => history.push(routeRoutes.login)}>\n                {t(\"ResetForm.BackToLogin\")}\n              </Button>\n            </div>\n          </div>\n        </Container>\n      </StyledContent>\n    );\n  };\n\n  return (\n    <Layout metaTitle={t(\"LoginAndRegister\")}>\n      {footerFromApi && (\n        <StyledModal\n          onClose={() => setModalVisible(false)}\n          visible={modalVisible}\n          animation=\"zoom\"\n          maskAnimation=\"fade\"\n          destroyOnClose={true}\n          width={800}\n        >\n          <Title level={4} className=\"modal-title\">\n            {t(\"Warning\")}\n          </Title>\n          <MarkdownRenderer>{footerFromApi}</MarkdownRenderer>\n          <Button mode=\"outline\" onClick={() => setModalVisible(false)}>\n            {t(\"I'm aware\")}\n          </Button>\n        </StyledModal>\n      )}\n\n      {view !== \"success\" ? (\n        <StyledRegisterPage>\n          <Container>\n            <RegisterForm\n              return_url={`${APP_URL}${redirectPrefix()}${\n                routeRoutes.emailVerify\n              }`}\n              fieldLabels={fieldLabels}\n              mobile={isMobile}\n              onLoginLink={() => history.push(routeRoutes.login)}\n              onSuccess={(\n                _: unknown,\n                values: { email: SetStateAction<string> }\n              ) => {\n                setView(\"success\");\n                setEmail(values.email);\n              }}\n              {...(isMobilePlatform\n                ? { submitText: \"Załóż darmowe konto\" }\n                : {})}\n            />\n          </Container>\n        </StyledRegisterPage>\n      ) : (\n        <EmailActivation />\n      )}\n    </Layout>\n  );\n};\n\nexport default RegisterPage;\n"],"names":["StyledRegisterPage","styled","theme","StyledLink","Link","StyledContent","StyledModal","Modal","RegisterPage","search","useLocation","user","socialAuthorize","useContext","EscolaLMSContext","view","setView","useState","modalVisible","setModalVisible","settings","email","setEmail","history","useHistory","token","useTranslation","footerFromApi","_b","_a","metaDataKeys","fieldLabels","jsxs","Text","routeRoutes","useEffect","EmailActivation","config","accountActivationByAdmin","jsx","Container","EmailActivationImg","Title","MarkdownRenderer","props","LinkComponent","Button","Layout","RegisterForm","APP_URL","redirectPrefix","isMobile","_","values","isMobilePlatform"],"mappings":"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"}