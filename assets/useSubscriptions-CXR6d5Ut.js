import{r as s,H as k,f as w,F as l}from"./index-BRyshI_t.js";const z=()=>{var g,h,S,y,E;const{fetchProducts:b,fetchMyProducts:p,products:r,userProducts:e,user:u,attachProduct:M,cancelSubscription:f}=s.useContext(k.EscolaLMSContext),{t:a}=w(),c=s.useCallback(async()=>{try{await b({type:"subscription-all-in",pageSize:500})}catch(t){console.error("Error fetching subscriptions:",t),l(String(a("UnexpectedError")),"error")}},[b,a]),o=s.useCallback(async()=>{try{await p({type:"subscription-all-in",pageSize:500})}catch(t){console.error("Error fetching subscriptions:",t),l(String(a("UnexpectedError")),"error")}},[p,a]),d=s.useCallback(async t=>{try{await f(t)}catch(i){console.error("Error fetching subscriptions:",i),l(String(a("UnexpectedError")),"error")}},[a,f]),m=s.useMemo(()=>{var t,i,n;return(n=(t=r==null?void 0:r.list)==null?void 0:t.data)==null?void 0:n.reduce((x,C)=>x.price>C.price?C:x,(i=r==null?void 0:r.list)==null?void 0:i.data[0])},[(g=r==null?void 0:r.list)==null?void 0:g.data]),v=s.useMemo(()=>{var t,i;return(i=(t=e==null?void 0:e.list)==null?void 0:t.data)==null?void 0:i.find(n=>n==null?void 0:n.is_active)},[(h=e==null?void 0:e.list)==null?void 0:h.data]);return s.useEffect(()=>{var t;(t=u.value)!=null&&t.id&&o(),c()},[c,o,(S=u.value)==null?void 0:S.id]),{fetchSubscriptions:c,fetchMySubscriptions:o,userProducts:((y=e==null?void 0:e.list)==null?void 0:y.data)??[],subscriptions:((E=r==null?void 0:r.list)==null?void 0:E.data)??[],isLoading:r.loading,getCheapestSubscription:m,getActiveSubscription:v,attachProduct:M,subscriptionCancel:d}};export{z as u};
