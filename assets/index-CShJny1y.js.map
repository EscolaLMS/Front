{"version":3,"file":"index-CShJny1y.js","sources":["../../src/pages/verify-email/index.tsx"],"sourcesContent":["import React, { useContext, useEffect, useState, useCallback } from \"react\";\nimport { useLocation, useHistory } from \"react-router-dom\";\nimport Layout from \"@/components/_App/Layout\";\nimport { useTranslation } from \"react-i18next\";\nimport { EscolaLMSContext } from \"@escolalms/sdk/lib/react\";\nimport { Spin } from \"@escolalms/components/lib/components/atoms/Spin/Spin\";\nimport { useTheme } from \"styled-components\";\nimport routeRoutes from \"@/components/Routes/routes\";\nimport { ThankYouIcon } from \"@/icons/index\";\nimport styled from \"styled-components\";\nimport { getStylesBasedOnTheme } from \"@escolalms/components/lib/utils/utils\";\nimport { Title } from \"@escolalms/components/lib/components/atoms/Typography/Title\";\n\nconst StyledEmailConfirmation = styled.div`\n  background-color: ${({ theme }) => theme.gray4};\n\n  height: 550px;\n  display: flex;\n  flex-direction: column;\n  align-items: center;\n  justify-content: center;\n  @media (max-width: 991px) {\n    height: 100%;\n    padding: 100px 0px;\n    text-align: center;\n  }\n\n  .content-wrapper {\n    background: ${({ theme }) =>\n      getStylesBasedOnTheme(theme.mode, theme.black, theme.white, theme.white)};\n    border-radius: ${({ theme }) => theme.cardRadius}px;\n    padding: 98px 20px;\n    width: 100%;\n    min-width: 600px;\n    display: grid;\n    place-content: center;\n    display: flex;\n    flex-direction: column;\n    justify-content: center;\n    align-items: center;\n    @media (max-width: 991px) {\n      min-width: auto;\n      padding: 20px;\n      width: auto;\n    }\n    svg {\n      margin: 20px 0px;\n    }\n    h2 {\n      margin-top: 20px;\n    }\n  }\n`;\n\nconst VerifyEmail: React.FC = () => {\n  const { push } = useHistory();\n  const { search } = useLocation();\n  const id = search && search?.split(\"&\")[0]?.split(\"=\")[1];\n  const hash = search && search?.split(\"&\")[1]?.split(\"=\")[1];\n  const { t } = useTranslation();\n  const theme = useTheme();\n  const { emailVerify } = useContext(EscolaLMSContext);\n\n  const [state, setState] = useState({\n    loading: false,\n    state: \"init\",\n    isVerified: false,\n    message: \"\",\n  });\n\n  const verifyEmail = useCallback(async () => {\n    setState((prevState) => ({\n      ...prevState,\n      loading: true,\n    }));\n\n    try {\n      const request =\n        id && hash && (await emailVerify(String(id), String(hash)));\n\n      if (request) {\n        setState((prevState) => ({\n          ...prevState,\n          state: \"success\",\n          message: request.message,\n          isVerified: true,\n        }));\n      }\n    } catch (error) {\n      console.error(error);\n    } finally {\n      setState((prevState) => ({\n        ...prevState,\n        loading: false,\n      }));\n    }\n  }, [id, hash, emailVerify]);\n\n  useEffect(() => {\n    if (!hash) {\n      push(routeRoutes.home);\n    }\n    id && hash && verifyEmail();\n  }, [id, hash, verifyEmail, push]);\n\n  return (\n    <Layout>\n      <StyledEmailConfirmation className=\"profile-authentication-area\">\n        <div className=\"container\">\n          <div className=\"row \">\n            <div className=\"col-lg-12 col-md-12\">\n              <div className=\"content-wrapper\">\n                <ThankYouIcon />\n                {state.loading && <Spin color={theme.primaryColor} />}{\" \"}\n                {state.isVerified && (\n                  <Title level={2}>{t(\"EmailWasVerified\")}</Title>\n                )}\n              </div>\n            </div>\n          </div>\n        </div>\n      </StyledEmailConfirmation>\n    </Layout>\n  );\n};\n\nexport default VerifyEmail;\n"],"names":["StyledEmailConfirmation","styled","theme","getStylesBasedOnTheme","VerifyEmail","push","useHistory","search","useLocation","id","_a","hash","_b","t","useTranslation","useTheme","emailVerify","useContext","EscolaLMSContext","state","setState","useState","verifyEmail","useCallback","prevState","request","error","useEffect","routeRoutes","jsx","Layout","jsxs","ThankYouIcon","Spin","Title"],"mappings":"mIAaA,MAAMA,EAA0BC,EAAO;AAAA,sBACjB,CAAC,CAAE,MAAAC,KAAYA,EAAM,KAAK;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,kBAc9B,CAAC,CAAE,MAAAA,CAAM,IACrBC,EAAsBD,EAAM,KAAMA,EAAM,MAAOA,EAAM,MAAOA,EAAM,KAAK,CAAC;AAAA,qBACzD,CAAC,CAAE,MAAAA,KAAYA,EAAM,UAAU;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EAwB9CE,EAAwB,IAAM,SAC5B,KAAA,CAAE,KAAAC,CAAK,EAAIC,EAAW,EACtB,CAAE,OAAAC,CAAO,EAAIC,EAAY,EACzBC,EAAKF,KAAUG,EAAAH,GAAA,YAAAA,EAAQ,MAAM,KAAK,KAAnB,YAAAG,EAAuB,MAAM,KAAK,IACjDC,EAAOJ,KAAUK,EAAAL,GAAA,YAAAA,EAAQ,MAAM,KAAK,KAAnB,YAAAK,EAAuB,MAAM,KAAK,IACnD,CAAE,EAAAC,CAAE,EAAIC,EAAe,EACvBZ,EAAQa,EAAS,EACjB,CAAE,YAAAC,CAAA,EAAgBC,EAAA,WAAWC,kBAAgB,EAE7C,CAACC,EAAOC,CAAQ,EAAIC,WAAS,CACjC,QAAS,GACT,MAAO,OACP,WAAY,GACZ,QAAS,EAAA,CACV,EAEKC,EAAcC,EAAAA,YAAY,SAAY,CAC1CH,EAAUI,IAAe,CACvB,GAAGA,EACH,QAAS,EAAA,EACT,EAEE,GAAA,CACI,MAAAC,EACJhB,GAAME,GAAS,MAAMK,EAAY,OAAOP,CAAE,EAAG,OAAOE,CAAI,CAAC,EAEvDc,GACFL,EAAUI,IAAe,CACvB,GAAGA,EACH,MAAO,UACP,QAASC,EAAQ,QACjB,WAAY,EAAA,EACZ,QAEGC,EAAO,CACd,QAAQ,MAAMA,CAAK,CAAA,QACnB,CACAN,EAAUI,IAAe,CACvB,GAAGA,EACH,QAAS,EAAA,EACT,CAAA,CAEH,EAAA,CAACf,EAAIE,EAAMK,CAAW,CAAC,EAE1BW,OAAAA,EAAAA,UAAU,IAAM,CACThB,GACHN,EAAKuB,EAAY,IAAI,EAEvBnB,GAAME,GAAQW,EAAY,GACzB,CAACb,EAAIE,EAAMW,EAAajB,CAAI,CAAC,EAG9BwB,EAAAA,IAACC,GACC,SAACD,EAAA,IAAA7B,EAAA,CAAwB,UAAU,8BACjC,SAAA6B,EAAAA,IAAC,OAAI,UAAU,YACb,eAAC,MAAI,CAAA,UAAU,OACb,SAACA,EAAA,IAAA,MAAA,CAAI,UAAU,sBACb,SAAAE,EAAAA,KAAC,MAAI,CAAA,UAAU,kBACb,SAAA,CAAAF,EAAA,IAACG,EAAa,EAAA,EACbb,EAAM,SAAWU,MAACI,EAAAA,KAAK,CAAA,MAAO/B,EAAM,aAAc,EAAI,IACtDiB,EAAM,YACJU,EAAA,IAAAK,QAAA,CAAM,MAAO,EAAI,SAAArB,EAAE,kBAAkB,CAAE,CAAA,CAAA,CAAA,CAE5C,CACF,CAAA,CAAA,CACF,CACF,CAAA,CAAA,CACF,CACF,CAAA,CAEJ"}