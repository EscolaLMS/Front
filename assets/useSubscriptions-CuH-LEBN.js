import{r,A as v,f as d,aR as x}from"./index-qD7U5zMV.js";const w=()=>{var p,u,g,h,S;const{fetchProducts:l,fetchMyProducts:f,products:t,userProducts:i,user:b,attachProduct:C}=r.useContext(v.EscolaLMSContext),{t:n}=d(),o=r.useCallback(async()=>{try{await l({type:"subscription-all-in",pageSize:500})}catch(e){console.error("Error fetching subscriptions:",e),x.error(String(n("UnexpectedError")))}},[l,n]),c=r.useCallback(async()=>{try{await f({type:"subscription-all-in",pageSize:500})}catch(e){console.error("Error fetching subscriptions:",e),x.error(String(n("UnexpectedError")))}},[f,n]),M=r.useMemo(()=>{var e,s,a;return(a=(e=t==null?void 0:t.list)==null?void 0:e.data)==null?void 0:a.reduce((y,E)=>y.price>E.price?E:y,(s=t==null?void 0:t.list)==null?void 0:s.data[0])},[(p=t==null?void 0:t.list)==null?void 0:p.data]),m=r.useMemo(()=>{var e,s;return(s=(e=i==null?void 0:i.list)==null?void 0:e.data)==null?void 0:s.find(a=>a==null?void 0:a.is_active)},[(u=i==null?void 0:i.list)==null?void 0:u.data]);return r.useEffect(()=>{var e;(e=b.value)!=null&&e.id&&c(),o()},[o,c,(g=b.value)==null?void 0:g.id]),{fetchSubscriptions:o,fetchMySubscriptions:c,userProducts:((h=i==null?void 0:i.list)==null?void 0:h.data)??[],subscriptions:((S=t==null?void 0:t.list)==null?void 0:S.data)??[],isLoading:t.loading,getCheapestSubscription:M,getActiveSubscription:m,attachProduct:C}};export{w as u};
