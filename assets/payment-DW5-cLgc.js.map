{"version":3,"mappings":"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","names":["__extends","extendStatics","d","b","p","__","PURCHASES_ERROR_CODE","_super","UninitializedPurchasesError","_this","UnsupportedPlatformError","PACKAGE_TYPE","INTRO_ELIGIBILITY_STATUS","PRODUCT_CATEGORY","PRODUCT_TYPE","PRORATION_MODE","RECURRENCE_MODE","OFFER_PAYMENT_MODE","PERIOD_UNIT","PURCHASE_TYPE","BILLING_FEATURE","REFUND_REQUEST_STATUS","LOG_LEVEL","IN_APP_MESSAGE_TYPE","ENTITLEMENT_VERIFICATION_MODE","VERIFICATION_RESULT","PAYWALL_RESULT","Purchases","registerPlugin","__vitePreload","m","useSubscriptions","fetchProducts","fetchMyProducts","products","userProducts","user","attachProduct","cancelSubscription","useContext","EscolaLMSContext","t","useTranslation","fetchSubscriptions","useCallback","error","toast","fetchMySubscriptions","subscriptionCancel","productId","getCheapestSubscription","useMemo","_c","_a","acc","curr","_b","getActiveSubscription","product","useEffect","_d","_e","findProductByIdentifier","packages","targetIdentifier","pkg","getRevenuecatId","course","id","Capacitor","_h","_g","_f","getRevenuecatIdForSubscription","subscription","revenuecatErrorHandler","key"],"ignoreList":[0,1,2,3],"sources":["../../node_modules/@revenuecat/purchases-typescript-internal-esm/dist/errors.js","../../node_modules/@revenuecat/purchases-typescript-internal-esm/dist/offerings.js","../../node_modules/@revenuecat/purchases-typescript-internal-esm/dist/enums.js","../../node_modules/@revenuecat/purchases-capacitor/dist/esm/index.js","../../src/hooks/useSubscriptions.ts","../../src/utils/payment.ts"],"sourcesContent":["var __extends = (this && this.__extends) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (Object.prototype.hasOwnProperty.call(b, p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    };\n    return function (d, b) {\n        if (typeof b !== \"function\" && b !== null)\n            throw new TypeError(\"Class extends value \" + String(b) + \" is not a constructor or null\");\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\n/* tslint:disable:max-classes-per-file */\n/**\n * Error codes indicating the reason for an error.\n * @public\n */\nexport var PURCHASES_ERROR_CODE;\n(function (PURCHASES_ERROR_CODE) {\n    PURCHASES_ERROR_CODE[\"UNKNOWN_ERROR\"] = \"0\";\n    PURCHASES_ERROR_CODE[\"PURCHASE_CANCELLED_ERROR\"] = \"1\";\n    PURCHASES_ERROR_CODE[\"STORE_PROBLEM_ERROR\"] = \"2\";\n    PURCHASES_ERROR_CODE[\"PURCHASE_NOT_ALLOWED_ERROR\"] = \"3\";\n    PURCHASES_ERROR_CODE[\"PURCHASE_INVALID_ERROR\"] = \"4\";\n    PURCHASES_ERROR_CODE[\"PRODUCT_NOT_AVAILABLE_FOR_PURCHASE_ERROR\"] = \"5\";\n    PURCHASES_ERROR_CODE[\"PRODUCT_ALREADY_PURCHASED_ERROR\"] = \"6\";\n    PURCHASES_ERROR_CODE[\"RECEIPT_ALREADY_IN_USE_ERROR\"] = \"7\";\n    PURCHASES_ERROR_CODE[\"INVALID_RECEIPT_ERROR\"] = \"8\";\n    PURCHASES_ERROR_CODE[\"MISSING_RECEIPT_FILE_ERROR\"] = \"9\";\n    PURCHASES_ERROR_CODE[\"NETWORK_ERROR\"] = \"10\";\n    PURCHASES_ERROR_CODE[\"INVALID_CREDENTIALS_ERROR\"] = \"11\";\n    PURCHASES_ERROR_CODE[\"UNEXPECTED_BACKEND_RESPONSE_ERROR\"] = \"12\";\n    PURCHASES_ERROR_CODE[\"RECEIPT_IN_USE_BY_OTHER_SUBSCRIBER_ERROR\"] = \"13\";\n    PURCHASES_ERROR_CODE[\"INVALID_APP_USER_ID_ERROR\"] = \"14\";\n    PURCHASES_ERROR_CODE[\"OPERATION_ALREADY_IN_PROGRESS_ERROR\"] = \"15\";\n    PURCHASES_ERROR_CODE[\"UNKNOWN_BACKEND_ERROR\"] = \"16\";\n    PURCHASES_ERROR_CODE[\"INVALID_APPLE_SUBSCRIPTION_KEY_ERROR\"] = \"17\";\n    PURCHASES_ERROR_CODE[\"INELIGIBLE_ERROR\"] = \"18\";\n    PURCHASES_ERROR_CODE[\"INSUFFICIENT_PERMISSIONS_ERROR\"] = \"19\";\n    PURCHASES_ERROR_CODE[\"PAYMENT_PENDING_ERROR\"] = \"20\";\n    PURCHASES_ERROR_CODE[\"INVALID_SUBSCRIBER_ATTRIBUTES_ERROR\"] = \"21\";\n    PURCHASES_ERROR_CODE[\"LOG_OUT_ANONYMOUS_USER_ERROR\"] = \"22\";\n    PURCHASES_ERROR_CODE[\"CONFIGURATION_ERROR\"] = \"23\";\n    PURCHASES_ERROR_CODE[\"UNSUPPORTED_ERROR\"] = \"24\";\n    PURCHASES_ERROR_CODE[\"EMPTY_SUBSCRIBER_ATTRIBUTES_ERROR\"] = \"25\";\n    PURCHASES_ERROR_CODE[\"PRODUCT_DISCOUNT_MISSING_IDENTIFIER_ERROR\"] = \"26\";\n    PURCHASES_ERROR_CODE[\"PRODUCT_DISCOUNT_MISSING_SUBSCRIPTION_GROUP_IDENTIFIER_ERROR\"] = \"28\";\n    PURCHASES_ERROR_CODE[\"CUSTOMER_INFO_ERROR\"] = \"29\";\n    PURCHASES_ERROR_CODE[\"SYSTEM_INFO_ERROR\"] = \"30\";\n    PURCHASES_ERROR_CODE[\"BEGIN_REFUND_REQUEST_ERROR\"] = \"31\";\n    PURCHASES_ERROR_CODE[\"PRODUCT_REQUEST_TIMED_OUT_ERROR\"] = \"32\";\n    PURCHASES_ERROR_CODE[\"API_ENDPOINT_BLOCKED\"] = \"33\";\n    PURCHASES_ERROR_CODE[\"INVALID_PROMOTIONAL_OFFER_ERROR\"] = \"34\";\n    PURCHASES_ERROR_CODE[\"OFFLINE_CONNECTION_ERROR\"] = \"35\";\n})(PURCHASES_ERROR_CODE || (PURCHASES_ERROR_CODE = {}));\n/**\n * @internal\n */\nvar UninitializedPurchasesError = /** @class */ (function (_super) {\n    __extends(UninitializedPurchasesError, _super);\n    function UninitializedPurchasesError() {\n        var _this = _super.call(this, \"There is no singleton instance. \" +\n            \"Make sure you configure Purchases before trying to get the default instance. \" +\n            \"More info here: https://errors.rev.cat/configuring-sdk\") || this;\n        // Set the prototype explicitly.\n        Object.setPrototypeOf(_this, UninitializedPurchasesError.prototype);\n        return _this;\n    }\n    return UninitializedPurchasesError;\n}(Error));\nexport { UninitializedPurchasesError };\n/**\n * @internal\n */\nvar UnsupportedPlatformError = /** @class */ (function (_super) {\n    __extends(UnsupportedPlatformError, _super);\n    function UnsupportedPlatformError() {\n        var _this = _super.call(this, \"This method is not available in the current platform.\") || this;\n        // Set the prototype explicitly.\n        Object.setPrototypeOf(_this, UnsupportedPlatformError.prototype);\n        return _this;\n    }\n    return UnsupportedPlatformError;\n}(Error));\nexport { UnsupportedPlatformError };\n","/**\n * Enum indicating possible package types.\n * @public\n */\nexport var PACKAGE_TYPE;\n(function (PACKAGE_TYPE) {\n    /**\n     * A package that was defined with a custom identifier.\n     */\n    PACKAGE_TYPE[\"UNKNOWN\"] = \"UNKNOWN\";\n    /**\n     * A package that was defined with a custom identifier.\n     */\n    PACKAGE_TYPE[\"CUSTOM\"] = \"CUSTOM\";\n    /**\n     * A package configured with the predefined lifetime identifier.\n     */\n    PACKAGE_TYPE[\"LIFETIME\"] = \"LIFETIME\";\n    /**\n     * A package configured with the predefined annual identifier.\n     */\n    PACKAGE_TYPE[\"ANNUAL\"] = \"ANNUAL\";\n    /**\n     * A package configured with the predefined six month identifier.\n     */\n    PACKAGE_TYPE[\"SIX_MONTH\"] = \"SIX_MONTH\";\n    /**\n     * A package configured with the predefined three month identifier.\n     */\n    PACKAGE_TYPE[\"THREE_MONTH\"] = \"THREE_MONTH\";\n    /**\n     * A package configured with the predefined two month identifier.\n     */\n    PACKAGE_TYPE[\"TWO_MONTH\"] = \"TWO_MONTH\";\n    /**\n     * A package configured with the predefined monthly identifier.\n     */\n    PACKAGE_TYPE[\"MONTHLY\"] = \"MONTHLY\";\n    /**\n     * A package configured with the predefined weekly identifier.\n     */\n    PACKAGE_TYPE[\"WEEKLY\"] = \"WEEKLY\";\n})(PACKAGE_TYPE || (PACKAGE_TYPE = {}));\n/**\n * Enum indicating possible eligibility status for introductory pricing.\n * @public\n */\nexport var INTRO_ELIGIBILITY_STATUS;\n(function (INTRO_ELIGIBILITY_STATUS) {\n    /**\n     * RevenueCat doesn't have enough information to determine eligibility.\n     */\n    INTRO_ELIGIBILITY_STATUS[INTRO_ELIGIBILITY_STATUS[\"INTRO_ELIGIBILITY_STATUS_UNKNOWN\"] = 0] = \"INTRO_ELIGIBILITY_STATUS_UNKNOWN\";\n    /**\n     * The user is not eligible for a free trial or intro pricing for this product.\n     */\n    INTRO_ELIGIBILITY_STATUS[INTRO_ELIGIBILITY_STATUS[\"INTRO_ELIGIBILITY_STATUS_INELIGIBLE\"] = 1] = \"INTRO_ELIGIBILITY_STATUS_INELIGIBLE\";\n    /**\n     * The user is eligible for a free trial or intro pricing for this product.\n     */\n    INTRO_ELIGIBILITY_STATUS[INTRO_ELIGIBILITY_STATUS[\"INTRO_ELIGIBILITY_STATUS_ELIGIBLE\"] = 2] = \"INTRO_ELIGIBILITY_STATUS_ELIGIBLE\";\n    /**\n     * There is no free trial or intro pricing for this product.\n     */\n    INTRO_ELIGIBILITY_STATUS[INTRO_ELIGIBILITY_STATUS[\"INTRO_ELIGIBILITY_STATUS_NO_INTRO_OFFER_EXISTS\"] = 3] = \"INTRO_ELIGIBILITY_STATUS_NO_INTRO_OFFER_EXISTS\";\n})(INTRO_ELIGIBILITY_STATUS || (INTRO_ELIGIBILITY_STATUS = {}));\n/**\n * Enum indicating possible product categories.\n * @public\n */\nexport var PRODUCT_CATEGORY;\n(function (PRODUCT_CATEGORY) {\n    /**\n     * A type of product for non-subscription.\n     */\n    PRODUCT_CATEGORY[\"NON_SUBSCRIPTION\"] = \"NON_SUBSCRIPTION\";\n    /**\n     * A type of product for subscriptions.\n     */\n    PRODUCT_CATEGORY[\"SUBSCRIPTION\"] = \"SUBSCRIPTION\";\n    /**\n     * A type of product for unknowns.\n     */\n    PRODUCT_CATEGORY[\"UNKNOWN\"] = \"UNKNOWN\";\n})(PRODUCT_CATEGORY || (PRODUCT_CATEGORY = {}));\n/**\n * Enum indicating possible product types.\n * @public\n */\nexport var PRODUCT_TYPE;\n(function (PRODUCT_TYPE) {\n    /**\n     * A consumable in-app purchase.\n     */\n    PRODUCT_TYPE[\"CONSUMABLE\"] = \"CONSUMABLE\";\n    /**\n     * A non-consumable in-app purchase. Only applies to Apple Store products.\n     */\n    PRODUCT_TYPE[\"NON_CONSUMABLE\"] = \"NON_CONSUMABLE\";\n    /**\n     * A non-renewing subscription. Only applies to Apple Store products.\n     */\n    PRODUCT_TYPE[\"NON_RENEWABLE_SUBSCRIPTION\"] = \"NON_RENEWABLE_SUBSCRIPTION\";\n    /**\n     * An auto-renewable subscription.\n     */\n    PRODUCT_TYPE[\"AUTO_RENEWABLE_SUBSCRIPTION\"] = \"AUTO_RENEWABLE_SUBSCRIPTION\";\n    /**\n     * A subscription that is pre-paid. Only applies to Google Play products.\n     */\n    PRODUCT_TYPE[\"PREPAID_SUBSCRIPTION\"] = \"PREPAID_SUBSCRIPTION\";\n    /**\n     * Unable to determine product type.\n     */\n    PRODUCT_TYPE[\"UNKNOWN\"] = \"UNKNOWN\";\n})(PRODUCT_TYPE || (PRODUCT_TYPE = {}));\n/**\n * Enum with possible proration modes in a subscription upgrade or downgrade in the Play Store. Used only for Google.\n * @public\n */\nexport var PRORATION_MODE;\n(function (PRORATION_MODE) {\n    PRORATION_MODE[PRORATION_MODE[\"UNKNOWN_SUBSCRIPTION_UPGRADE_DOWNGRADE_POLICY\"] = 0] = \"UNKNOWN_SUBSCRIPTION_UPGRADE_DOWNGRADE_POLICY\";\n    /**\n     * Replacement takes effect immediately, and the remaining time will be\n     * prorated and credited to the user. This is the current default behavior.\n     */\n    PRORATION_MODE[PRORATION_MODE[\"IMMEDIATE_WITH_TIME_PRORATION\"] = 1] = \"IMMEDIATE_WITH_TIME_PRORATION\";\n    /**\n     * Replacement takes effect immediately, and the billing cycle remains the\n     * same. The price for the remaining period will be charged. This option is\n     * only available for subscription upgrade.\n     */\n    PRORATION_MODE[PRORATION_MODE[\"IMMEDIATE_AND_CHARGE_PRORATED_PRICE\"] = 2] = \"IMMEDIATE_AND_CHARGE_PRORATED_PRICE\";\n    /**\n     * Replacement takes effect immediately, and the new price will be charged on\n     * next recurrence time. The billing cycle stays the same.\n     */\n    PRORATION_MODE[PRORATION_MODE[\"IMMEDIATE_WITHOUT_PRORATION\"] = 3] = \"IMMEDIATE_WITHOUT_PRORATION\";\n    /**\n     * Replacement takes effect when the old plan expires, and the new price will\n     * be charged at the same time.\n     */\n    PRORATION_MODE[PRORATION_MODE[\"DEFERRED\"] = 4] = \"DEFERRED\";\n    /**\n     * Replacement takes effect immediately, and the user is charged full price\n     * of new plan and is given a full billing cycle of subscription,\n     * plus remaining prorated time from the old plan.\n     */\n    PRORATION_MODE[PRORATION_MODE[\"IMMEDIATE_AND_CHARGE_FULL_PRICE\"] = 5] = \"IMMEDIATE_AND_CHARGE_FULL_PRICE\";\n})(PRORATION_MODE || (PRORATION_MODE = {}));\n/**\n * Recurrence mode for a pricing phase\n * @public\n */\nexport var RECURRENCE_MODE;\n(function (RECURRENCE_MODE) {\n    /**\n     * Pricing phase repeats infinitely until cancellation\n     */\n    RECURRENCE_MODE[RECURRENCE_MODE[\"INFINITE_RECURRING\"] = 1] = \"INFINITE_RECURRING\";\n    /**\n     * Pricing phase repeats for a fixed number of billing periods\n     */\n    RECURRENCE_MODE[RECURRENCE_MODE[\"FINITE_RECURRING\"] = 2] = \"FINITE_RECURRING\";\n    /**\n     * Pricing phase does not repeat\n     */\n    RECURRENCE_MODE[RECURRENCE_MODE[\"NON_RECURRING\"] = 3] = \"NON_RECURRING\";\n})(RECURRENCE_MODE || (RECURRENCE_MODE = {}));\n/**\n * Payment mode for offer pricing phases. Google Play only.\n * @public\n */\nexport var OFFER_PAYMENT_MODE;\n(function (OFFER_PAYMENT_MODE) {\n    /**\n     * Subscribers don't pay until the specified period ends\n     */\n    OFFER_PAYMENT_MODE[\"FREE_TRIAL\"] = \"FREE_TRIAL\";\n    /**\n     * Subscribers pay up front for a specified period\n     */\n    OFFER_PAYMENT_MODE[\"SINGLE_PAYMENT\"] = \"SINGLE_PAYMENT\";\n    /**\n     * Subscribers pay a discounted amount for a specified number of periods\n     */\n    OFFER_PAYMENT_MODE[\"DISCOUNTED_RECURRING_PAYMENT\"] = \"DISCOUNTED_RECURRING_PAYMENT\";\n})(OFFER_PAYMENT_MODE || (OFFER_PAYMENT_MODE = {}));\n/**\n * Time duration unit for Period.\n * @public\n */\nexport var PERIOD_UNIT;\n(function (PERIOD_UNIT) {\n    PERIOD_UNIT[\"DAY\"] = \"DAY\";\n    PERIOD_UNIT[\"WEEK\"] = \"WEEK\";\n    PERIOD_UNIT[\"MONTH\"] = \"MONTH\";\n    PERIOD_UNIT[\"YEAR\"] = \"YEAR\";\n    PERIOD_UNIT[\"UNKNOWN\"] = \"UNKNOWN\";\n})(PERIOD_UNIT || (PERIOD_UNIT = {}));\n","/**\n * @deprecated Use PRODUCT_CATEGORY\n * @public\n */\nexport var PURCHASE_TYPE;\n(function (PURCHASE_TYPE) {\n    /**\n     * A type of SKU for in-app products.\n     */\n    PURCHASE_TYPE[\"INAPP\"] = \"inapp\";\n    /**\n     * A type of SKU for subscriptions.\n     */\n    PURCHASE_TYPE[\"SUBS\"] = \"subs\";\n})(PURCHASE_TYPE || (PURCHASE_TYPE = {}));\n/**\n * Enum for billing features.\n * Currently, these are only relevant for Google Play Android users:\n * https://developer.android.com/reference/com/android/billingclient/api/BillingClient.FeatureType\n * @public\n */\nexport var BILLING_FEATURE;\n(function (BILLING_FEATURE) {\n    /**\n     * Purchase/query for subscriptions.\n     */\n    BILLING_FEATURE[BILLING_FEATURE[\"SUBSCRIPTIONS\"] = 0] = \"SUBSCRIPTIONS\";\n    /**\n     * Subscriptions update/replace.\n     */\n    BILLING_FEATURE[BILLING_FEATURE[\"SUBSCRIPTIONS_UPDATE\"] = 1] = \"SUBSCRIPTIONS_UPDATE\";\n    /**\n     * Purchase/query for in-app items on VR.\n     */\n    BILLING_FEATURE[BILLING_FEATURE[\"IN_APP_ITEMS_ON_VR\"] = 2] = \"IN_APP_ITEMS_ON_VR\";\n    /**\n     * Purchase/query for subscriptions on VR.\n     */\n    BILLING_FEATURE[BILLING_FEATURE[\"SUBSCRIPTIONS_ON_VR\"] = 3] = \"SUBSCRIPTIONS_ON_VR\";\n    /**\n     * Launch a price change confirmation flow.\n     */\n    BILLING_FEATURE[BILLING_FEATURE[\"PRICE_CHANGE_CONFIRMATION\"] = 4] = \"PRICE_CHANGE_CONFIRMATION\";\n})(BILLING_FEATURE || (BILLING_FEATURE = {}));\n/**\n * Enum for possible refund request results.\n * @public\n */\nexport var REFUND_REQUEST_STATUS;\n(function (REFUND_REQUEST_STATUS) {\n    /**\n     * Apple has received the refund request.\n     */\n    REFUND_REQUEST_STATUS[REFUND_REQUEST_STATUS[\"SUCCESS\"] = 0] = \"SUCCESS\";\n    /**\n     * User canceled submission of the refund request.\n     */\n    REFUND_REQUEST_STATUS[REFUND_REQUEST_STATUS[\"USER_CANCELLED\"] = 1] = \"USER_CANCELLED\";\n    /**\n     * There was an error with the request. See message for more details.\n     */\n    REFUND_REQUEST_STATUS[REFUND_REQUEST_STATUS[\"ERROR\"] = 2] = \"ERROR\";\n})(REFUND_REQUEST_STATUS || (REFUND_REQUEST_STATUS = {}));\n/**\n * Enum for possible log levels to print.\n * @public\n */\nexport var LOG_LEVEL;\n(function (LOG_LEVEL) {\n    LOG_LEVEL[\"VERBOSE\"] = \"VERBOSE\";\n    LOG_LEVEL[\"DEBUG\"] = \"DEBUG\";\n    LOG_LEVEL[\"INFO\"] = \"INFO\";\n    LOG_LEVEL[\"WARN\"] = \"WARN\";\n    LOG_LEVEL[\"ERROR\"] = \"ERROR\";\n})(LOG_LEVEL || (LOG_LEVEL = {}));\n/**\n * Enum for in-app message types.\n * This can be used if you disable automatic in-app message from showing automatically.\n * Then, you can pass what type of messages you want to show in the `showInAppMessages`\n * method in Purchases.\n * @public\n */\nexport var IN_APP_MESSAGE_TYPE;\n(function (IN_APP_MESSAGE_TYPE) {\n    // Make sure the enum values are in sync with those defined in iOS/Android\n    /**\n     * In-app messages to indicate there has been a billing issue charging the user.\n     */\n    IN_APP_MESSAGE_TYPE[IN_APP_MESSAGE_TYPE[\"BILLING_ISSUE\"] = 0] = \"BILLING_ISSUE\";\n    /**\n     * iOS-only. This message will show if you increase the price of a subscription and\n     * the user needs to opt-in to the increase.\n     */\n    IN_APP_MESSAGE_TYPE[IN_APP_MESSAGE_TYPE[\"PRICE_INCREASE_CONSENT\"] = 1] = \"PRICE_INCREASE_CONSENT\";\n    /**\n     * iOS-only. StoreKit generic messages.\n     */\n    IN_APP_MESSAGE_TYPE[IN_APP_MESSAGE_TYPE[\"GENERIC\"] = 2] = \"GENERIC\";\n})(IN_APP_MESSAGE_TYPE || (IN_APP_MESSAGE_TYPE = {}));\n/**\n * Enum of entitlement verification modes.\n * @public\n */\nexport var ENTITLEMENT_VERIFICATION_MODE;\n(function (ENTITLEMENT_VERIFICATION_MODE) {\n    /**\n     * The SDK will not perform any entitlement verification.\n     */\n    ENTITLEMENT_VERIFICATION_MODE[\"DISABLED\"] = \"DISABLED\";\n    /**\n       * Enable entitlement verification.\n       *\n       * If verification fails, this will be indicated with [VerificationResult.FAILED] in\n       * the [EntitlementInfos.verification] and [EntitlementInfo.verification] properties but parsing will not fail\n       * (i.e. Entitlements will still be granted).\n       *\n       * This can be useful if you want to handle verification failures to display an error/warning to the user\n       * or to track this situation but still grant access.\n       */\n    ENTITLEMENT_VERIFICATION_MODE[\"INFORMATIONAL\"] = \"INFORMATIONAL\";\n    // Add ENFORCED mode once we're ready to ship it.\n    // ENFORCED = \"ENFORCED\"\n})(ENTITLEMENT_VERIFICATION_MODE || (ENTITLEMENT_VERIFICATION_MODE = {}));\n/**\n * The result of the verification process. For more details check: http://rev.cat/trusted-entitlements\n *\n * This is accomplished by preventing MiTM attacks between the SDK and the RevenueCat server.\n * With verification enabled, the SDK ensures that the response created by the server was not\n * modified by a third-party, and the response received is exactly what was sent.\n *\n * - Note: Verification is only performed if enabled using PurchasesConfiguration's\n * entitlementVerificationMode property. This is disabled by default.\n *\n * @public\n */\nexport var VERIFICATION_RESULT;\n(function (VERIFICATION_RESULT) {\n    /**\n     * No verification was done.\n     *\n     * This value is returned when verification is not enabled in PurchasesConfiguration\n     */\n    VERIFICATION_RESULT[\"NOT_REQUESTED\"] = \"NOT_REQUESTED\";\n    /**\n     * Verification with our server was performed successfully.\n     */\n    VERIFICATION_RESULT[\"VERIFIED\"] = \"VERIFIED\";\n    /**\n     * Verification failed, possibly due to a MiTM attack.\n     */\n    VERIFICATION_RESULT[\"FAILED\"] = \"FAILED\";\n    /**\n     * Verification was performed on device.\n     */\n    VERIFICATION_RESULT[\"VERIFIED_ON_DEVICE\"] = \"VERIFIED_ON_DEVICE\";\n})(VERIFICATION_RESULT || (VERIFICATION_RESULT = {}));\n/**\n * The result of presenting a paywall. This will be the last situation the user experienced before the\n * paywall closed.\n *\n * @public\n */\nexport var PAYWALL_RESULT;\n(function (PAYWALL_RESULT) {\n    /**\n     * If the paywall wasn't presented. Only returned when using \"presentPaywallIfNeeded\"\n     */\n    PAYWALL_RESULT[\"NOT_PRESENTED\"] = \"NOT_PRESENTED\";\n    /**\n     * If an error happened during purchase/restoration.\n     */\n    PAYWALL_RESULT[\"ERROR\"] = \"ERROR\";\n    /**\n     * If the paywall was closed without performing an operation\n     */\n    PAYWALL_RESULT[\"CANCELLED\"] = \"CANCELLED\";\n    /**\n     * If a successful purchase happened inside the paywall\n     */\n    PAYWALL_RESULT[\"PURCHASED\"] = \"PURCHASED\";\n    /**\n     * If a successful restore happened inside the paywall\n     */\n    PAYWALL_RESULT[\"RESTORED\"] = \"RESTORED\";\n})(PAYWALL_RESULT || (PAYWALL_RESULT = {}));\n","import { registerPlugin } from '@capacitor/core';\nconst Purchases = registerPlugin('Purchases', {\n    web: () => import('./web').then(m => new m.PurchasesWeb()),\n});\nexport * from './definitions';\nexport { Purchases };\n//# sourceMappingURL=index.js.map","import { toast } from \"@/utils/toast\";\nimport { EscolaLMSContext } from \"@escolalms/sdk/lib/react\";\nimport { useContext, useCallback, useEffect, useMemo } from \"react\";\nimport { useTranslation } from \"react-i18next\";\n\n// available subscriptions  ['subscription-all-in', 'subscription']\n\nconst useSubscriptions = () => {\n  const {\n    fetchProducts,\n    fetchMyProducts,\n    products,\n    userProducts,\n    user,\n    attachProduct,\n    cancelSubscription,\n  } = useContext(EscolaLMSContext);\n\n  const { t } = useTranslation();\n\n  const fetchSubscriptions = useCallback(async () => {\n    try {\n      await fetchProducts({\n        type: \"subscription-all-in\",\n        pageSize: 500,\n      });\n    } catch (error) {\n      console.error(\"Error fetching subscriptions:\", error);\n      toast(String(t(\"UnexpectedError\")), \"error\");\n    }\n  }, [fetchProducts, t]);\n\n  const fetchMySubscriptions = useCallback(async () => {\n    try {\n      await fetchMyProducts({\n        type: \"subscription-all-in\",\n        pageSize: 500,\n      });\n    } catch (error) {\n      console.error(\"Error fetching subscriptions:\", error);\n      toast(String(t(\"UnexpectedError\")), \"error\");\n    }\n  }, [fetchMyProducts, t]);\n\n  const subscriptionCancel = useCallback(\n    async (productId: number) => {\n      try {\n        await cancelSubscription(productId);\n      } catch (error) {\n        console.error(\"Error fetching subscriptions:\", error);\n        toast(String(t(\"UnexpectedError\")), \"error\");\n      }\n    },\n    [t, cancelSubscription]\n  );\n\n  const getCheapestSubscription = useMemo(() => {\n    return products?.list?.data?.reduce((acc, curr) => {\n      if (acc.price > curr.price) {\n        return curr;\n      }\n      return acc;\n    }, products?.list?.data[0]);\n  }, [products?.list?.data]);\n\n  const getActiveSubscription = useMemo(() => {\n    // TODO: when ts models are ready, remove  this comment\n    // @ts-ignore\n    return userProducts?.list?.data?.find((product) => product?.is_active);\n  }, [userProducts?.list?.data]);\n\n  useEffect(() => {\n    if (user.value?.id) {\n      fetchMySubscriptions();\n    }\n    fetchSubscriptions();\n  }, [fetchSubscriptions, fetchMySubscriptions, user.value?.id]);\n\n  return {\n    fetchSubscriptions,\n    fetchMySubscriptions,\n    userProducts: userProducts?.list?.data ?? [],\n    subscriptions: products?.list?.data ?? [],\n    isLoading: products.loading,\n    getCheapestSubscription,\n    getActiveSubscription,\n    attachProduct,\n    subscriptionCancel,\n  };\n};\n\nexport default useSubscriptions;\n","import { API } from \"@escolalms/sdk/lib\";\nimport {\n  PURCHASES_ERROR_CODE,\n  PurchasesPackage,\n  PurchasesStoreProduct,\n} from \"@revenuecat/purchases-capacitor\";\nimport { Capacitor } from \"@capacitor/core\";\nimport { toast } from \"@/utils/toast\";\nimport { CapacitorPaymentError } from \"@/types/index\";\nimport { t } from \"i18next\";\n\n// helper function to retrieve product details from revenuecat\nexport const findProductByIdentifier = (\n  packages: PurchasesPackage[],\n  targetIdentifier: string\n): PurchasesStoreProduct | null => {\n  for (const pkg of packages) {\n    if (pkg.product.identifier === targetIdentifier) {\n      return pkg.product;\n    }\n  }\n  return null;\n};\n\nexport const getRevenuecatId = (course: API.Course) => {\n  let id = \"\";\n  if (Capacitor.getPlatform() === \"ios\") {\n    id =\n      course.product?.fields?.in_app_purchase_ids?.revenuecat?.app_store || \"\";\n  }\n  if (Capacitor.getPlatform() === \"android\") {\n    id =\n      course.product?.fields?.in_app_purchase_ids?.revenuecat?.play_store || \"\";\n  }\n  return id;\n};\n\nexport const getRevenuecatIdForSubscription = (subscription: API.Product) => {\n  let id = \"\";\n  if (Capacitor.getPlatform() === \"ios\") {\n    id = subscription?.fields?.in_app_purchase_ids?.revenuecat?.app_store || \"\";\n  }\n  if (Capacitor.getPlatform() === \"android\") {\n    id =\n      subscription?.fields?.in_app_purchase_ids?.revenuecat?.play_store || \"\";\n  }\n  return id;\n};\n\nexport const revenuecatErrorHandler = (error: CapacitorPaymentError) => {\n  if (!error.code) {\n    return toast(`${t(\"UnexpectedError\")}`, \"error\");\n  }\n  if (error.code === PURCHASES_ERROR_CODE.PURCHASE_CANCELLED_ERROR) {\n    return null;\n  }\n  return toast(\n    t(\n      `RevenuecatErrors.${Object.keys(PURCHASES_ERROR_CODE).find(\n        // @ts-ignore\n        (key) => error.code === PURCHASES_ERROR_CODE[key]\n      )}`\n    ) as string,\n    \"error\"\n  );\n};\n"],"file":"assets/payment-DW5-cLgc.js"}