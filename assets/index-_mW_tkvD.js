import{j as t,U as d,b as j,ay as y,r as p,K as w,l as P,k as S,h as b,v as D}from"./index-DMEaDbL2.js";import{C as E}from"./index-zF0PeBkq.js";import{C as _}from"./index-CMl1UQ5b.js";import{P as v}from"./index-Cgok2pEk.js";import{c as F,M as C,u as M,d as L,S as R,e as N,C as T,f as q,E as O}from"./index-CUbULyce.js";import{q as x}from"./base-DdFT33YW.js";import"./swiper-react-CcMmZze_.js";import"./warning-bWiOVVW-.js";import"./useRoles-ClkkD2v2.js";import"./index-2_Yu-yEN.js";import"./index-C0fOHUKL.js";import"./CourseCard-BVopZ_ZN.js";import"./index-BcMNIAcd.js";const k=({consultation:e})=>t.jsx(_,{consultation:e}),I=({consultations:e,loading:o,handlePageChange:n})=>{const a=e==null?void 0:e.meta;return o?t.jsx(F,{}):t.jsxs(t.Fragment,{children:[t.jsx(d.Row,{style:{gap:"30px 0",marginBottom:"30px"},children:!o&&(e==null?void 0:e.data.map(r=>t.jsx(d.Col,{md:6,lg:4,xl:3,children:t.jsx(k,{consultation:r})},r.id)))}),a&&(Number(a==null?void 0:a.total)||0)>(Number(a==null?void 0:a.per_page)||0)&&t.jsx(v,{total:a.total,perPage:Number(a.per_page),currentPage:a.current_page,onPage:r=>n(r)})]})},U=()=>{var h;const[e,o]=j.useState({showDrawer:!1,type:C.categories}),{entities:n,loading:a,prevCategories:r,handleSortChange:c,handlePageChange:u,handleRemoveCategory:i,handleCategoryChange:m,onClearCategories:s,params:g,categoryTree:l}=M("consultations");return t.jsxs(t.Fragment,{children:[t.jsx(L,{prevCategories:r,onClearCategories:s,handleCategoryChange:m,categories:l.list||[],handleSortChange:c,params:g,setMobileDrawerState:o,parentState:e}),r.length>0&&t.jsx(R,{onClearCategories:s,prevCategories:r,handleRemoveCategory:i}),t.jsx(I,{consultations:n||[],loading:a,handlePageChange:u}),l&&t.jsx(t.Fragment,{children:t.jsx(E,{categories:((h=l.list)==null?void 0:h.filter(f=>!!f.icon))||[]})}),t.jsx(y,{isOpen:e.showDrawer,onClose:()=>o({showDrawer:!1,type:C.categories}),height:e.type===C.categories?"40vh":"12vh",children:t.jsx(N,{showDrawer:e.showDrawer,type:e.type,prevCategories:r,onClearCategories:s,handleCategoryChange:m,categories:l.list||[],handleSortChange:c,setMobileDrawerState:o})})]})},$=(e,o)=>{const[n,a]=p.useState(),[r,c]=p.useState(!0),{fetchConsultations:u}=p.useContext(w.EscolaLMSContext),i=async m=>{c(!0);try{const s=await u(m);s&&a(s)}catch(s){console.error(s),a(void 0)}finally{c(!1)}};return p.useEffect(()=>{e&&!o&&i(e)},[u]),{consultations:n,loading:r,fetchConsultationsData:i}},A=(e={})=>x.stringify(e),B=e=>{const{children:o}=e,[n,a]=p.useState({page:1,per_page:T,order_by:"created_at"}),{consultations:r,loading:c,fetchConsultationsData:u}=$(n,!0),i=P(),{push:m}=S(),s=x.parse(i.search),g=p.useMemo(()=>s&&{...s,order_by:"created_at"},[s]),l=g||n;return p.useEffect(()=>{m(`${i.pathname}?${A(l)}`),u(l)},[i.search]),t.jsx(q.Provider,{value:{params:n,setParams:a,consultations:r,loading:c},children:o})},ae=()=>{const{t:e}=b();return t.jsx(D,{metaTitle:e("ConsultationsPageMeta"),children:t.jsx(B,{children:t.jsx(O,{title:e("ConsultationsPageMeta"),children:t.jsx(U,{})})})})};export{ae as default};
