import{r as n,i as B,h as W,k as q,J as o,A as p}from"./index-Y9RNIFp-.js";const L=()=>{var E,v,x,$;const{user:t,cart:l,fetchCart:h,removeFromCart:P,payWithStripe:f,payWithP24:y,subscriptionPayWithP24:m,courses:C,realizeVoucher:S,resetCart:i}=n.useContext(B.EscolaLMSContext),{t:e}=W(),{push:d,location:w}=q(),[b,r]=n.useState(!1),[g,U]=n.useState(((E=l==null?void 0:l.value)==null?void 0:E.additional_discount)>0?"granted":void 0),_=n.useCallback(async u=>{var s;r(!0);try{if(!((s=t.value)!=null&&s.email)){o(`${e("MissingEmailError")}`,"error"),r(!1);return}await f(u,`${p}/#/cart?status=success`),r(!1),d("/cart?status=success"),i()}catch(c){o(`${e("UnexpectedError")}`,"error"),r(!1),console.error(c)}},[f,d,e,(v=t.value)==null?void 0:v.email,i]),k=n.useCallback(async u=>{var s,c;r(!0);try{if(!((s=t.value)!=null&&s.email)){o(`${e("MissingEmailError")}`,"error"),r(!1);return}const a=await y((c=t.value)==null?void 0:c.email,`${p}/#/cart?status=success`,u||void 0);if(a.data.redirect_url===void 0){o(`${e("UnexpectedError")}`,"error"),r(!1);return}r(!1),i(),window.open(a.data.redirect_url)}catch(a){o(`${e("UnexpectedError")}`,"error"),r(!1),console.error(a)}},[y,e,(x=t.value)==null?void 0:x.email,i]),M=n.useCallback(async u=>{var s,c;if(r(!0),!((s=t.value)!=null&&s.email)){o(`${e("MissingEmailError")}`,"error"),r(!1);return}try{const a=await m(u,(c=t.value)==null?void 0:c.email,`${p}/#/cart?status=success`);if(a.data.redirect_url===void 0){o(`${e("UnexpectedError")}`,"error"),r(!1);return}r(!1),window.open(a.data.redirect_url),i()}catch{o(`${e("UnexpectedError")}`,"error")}},[e,m,($=t.value)==null?void 0:$.email,i]);return{user:t,processing:b,setProcessing:r,discountStatus:g,payByStripe:_,payByP24:k,removeFromCart:P,courses:C,cart:l,location:w,push:d,realizeVoucher:S,setDiscountStatus:U,fetchCart:h,buySubscriptionByP24:M}};export{L as u};
