import{r as u,n as M,h as k,i as B,N as o,D as l}from"./index-BrDgRaEo.js";const q=()=>{var m,E,v;const{user:t,cart:d,fetchCart:x,removeFromCart:$,payWithStripe:p,payWithP24:f,subscriptionPayWithP24:y,courses:h,realizeVoucher:P}=u.useContext(M.EscolaLMSContext),{t:e}=k(),{push:n,location:S}=B(),[w,r]=u.useState(!1),[C,b]=u.useState(d.value.additional_discount>0?"granted":void 0),g=u.useCallback(async i=>{var a;r(!0);try{if(!((a=t.value)!=null&&a.email)){o(`${e("MissingEmailError")}`,"error"),r(!1);return}await p(i,`${l}/#/cart?status=success`),r(!1),n("/cart?status=success")}catch(c){o(`${e("UnexpectedError")}`,"error"),r(!1),console.error(c)}},[p,n,e,(m=t.value)==null?void 0:m.email]),U=u.useCallback(async i=>{var a,c;r(!0);try{if(!((a=t.value)!=null&&a.email)){o(`${e("MissingEmailError")}`,"error"),r(!1);return}const s=await f((c=t.value)==null?void 0:c.email,`${l}/#/cart?status=success`,i||void 0);if(s.data.redirect_url===void 0){o(`${e("UnexpectedError")}`,"error"),r(!1);return}r(!1),window.open(s.data.redirect_url)}catch(s){o(`${e("UnexpectedError")}`,"error"),r(!1),console.error(s)}},[f,e,(E=t.value)==null?void 0:E.email]),_=u.useCallback(async i=>{var a,c;if(r(!0),!((a=t.value)!=null&&a.email)){o(`${e("MissingEmailError")}`,"error"),r(!1);return}try{const s=await y(i,(c=t.value)==null?void 0:c.email,`${l}/#/cart?status=success`);if(s.data.redirect_url===void 0){o(`${e("UnexpectedError")}`,"error"),r(!1);return}r(!1),window.open(s.data.redirect_url)}catch{o(`${e("UnexpectedError")}`,"error")}},[e,y,(v=t.value)==null?void 0:v.email]);return{user:t,processing:w,setProcessing:r,discountStatus:C,payByStripe:g,payByP24:U,removeFromCart:$,courses:h,cart:d,location:S,push:n,realizeVoucher:P,setDiscountStatus:b,fetchCart:x,buySubscriptionByP24:_}};export{q as u};
