import{j as t,V as d,b as j,ay as y,r as u,N as w,l as P,k as S,h as b,v as D}from"./index-_i66FZVw.js";import{C as E}from"./index-DHCVtFJM.js";import{C as _}from"./index-EpQHIcgZ.js";import{P as v}from"./index-DiyfmUy4.js";import{c as F,M as h,u as M,d as L,S as N,e as R,C as T,f as q,E as O}from"./index-BmMpBZvP.js";import{q as x}from"./base-7gvCcPfx.js";import"./swiper-react-DsQnZ3yO.js";import"./floating-ui.react-dom-C5Jr9n5A.js";import"./CourseCard-Dk0UU9ib.js";import"./index-DwmytEkL.js";import"./index-NLuswLRA.js";const k=({consultation:e})=>t.jsx(_,{consultation:e,showPrice:!0}),I=({consultations:e,loading:n,handlePageChange:i})=>{var o;const s=e==null?void 0:e.meta;return n?t.jsx(F,{}):t.jsxs(t.Fragment,{children:[t.jsx(d.Row,{style:{gap:"30px 0",marginBottom:"30px"},children:!n&&((o=e==null?void 0:e.data)==null?void 0:o.map(a=>t.jsx(d.Col,{md:6,lg:4,xl:3,children:t.jsx(k,{consultation:a})},a.id)))}),s&&(Number(s==null?void 0:s.total)||0)>(Number(s==null?void 0:s.per_page)||0)&&t.jsx(v,{total:s.total,perPage:Number(s.per_page),currentPage:s.current_page,onPage:a=>i(a)}),t.jsx("br",{})]})},$=()=>{var C;const[e,n]=j.useState({showDrawer:!1,type:h.categories}),{entities:i,loading:s,prevCategories:o,handleSortChange:a,handlePageChange:p,handleRemoveCategory:c,handleCategoryChange:g,onClearCategories:r,params:m,categoryTree:l}=M("consultations");return t.jsxs(t.Fragment,{children:[t.jsx(L,{prevCategories:o,onClearCategories:r,handleCategoryChange:g,categories:l.list||[],handleSortChange:a,params:m,setMobileDrawerState:n,parentState:e}),o.length>0&&t.jsx(N,{onClearCategories:r,prevCategories:o,handleRemoveCategory:c}),t.jsx(I,{consultations:i||[],loading:s,handlePageChange:p}),l&&t.jsx(t.Fragment,{children:t.jsx(E,{categories:((C=l.list)==null?void 0:C.filter(f=>!!f.icon))||[],entity:"consultations"})}),t.jsx(y,{isOpen:e.showDrawer,onClose:()=>n({showDrawer:!1,type:h.categories}),height:e.type===h.categories?"40vh":"12vh",children:t.jsx(R,{showDrawer:e.showDrawer,type:e.type,prevCategories:o,onClearCategories:r,handleCategoryChange:g,categories:l.list||[],handleSortChange:a,setMobileDrawerState:n})})]})},A=(e,n)=>{const[i,s]=u.useState(),[o,a]=u.useState(!0),{fetchConsultations:p}=u.useContext(w.EscolaLMSContext),c=async g=>{a(!0);try{const r=await p(g);r&&s(r)}catch(r){console.error(r),s(void 0)}finally{a(!1)}};return u.useEffect(()=>{e&&!n&&c(e)},[p]),{consultations:i,loading:o,fetchConsultationsData:c}},B=(e={})=>x.stringify(e),G=e=>{const{children:n}=e,[i,s]=u.useState({page:1,per_page:T,order_by:"created_at"}),{consultations:o,loading:a,fetchConsultationsData:p}=A(i,!0),c=P(),{push:g}=S(),r=x.parse(c.search),m=u.useMemo(()=>r&&{...r,order_by:"created_at"},[r]),l=m||i;return u.useEffect(()=>{g(`${c.pathname}?${B(l)}`),p(l)},[c.search]),t.jsx(q.Provider,{value:{params:i,setParams:s,consultations:o,loading:a},children:n})},ee=()=>{const{t:e}=b();return t.jsx(D,{metaTitle:e("ConsultationsPageMeta"),children:t.jsx(G,{children:t.jsx(O,{title:e("ConsultationsPageMeta"),children:t.jsx($,{})})})})};export{ee as default};
