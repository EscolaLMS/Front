import{j as t,V as d,b as j,az as y,r as u,N as w,l as P,k as S,h as b,v as D}from"./index-BqSOc7pd.js";import{C as E}from"./index-S6fk6J-3.js";import{C as _}from"./index-DnPQP2A3.js";import{P as v}from"./index-QEd7Mvtd.js";import{c as F,M as h,u as M,d as L,S as N,e as R,C as T,f as q,E as O}from"./index-7r8R_aMV.js";import{q as x}from"./base-7gvCcPfx.js";import"./swiper-react-Cbe2lyV1.js";import"./floating-ui.react-dom-DLwwW5-O.js";import"./index-CQART5pN.js";import"./index-C4zwrq8c.js";import"./CourseCard-DBwbD2Cv.js";import"./index-C4SeeOYt.js";const k=({consultation:e})=>t.jsx(_,{consultation:e,showPrice:!0}),I=({consultations:e,loading:o,handlePageChange:n})=>{const r=e==null?void 0:e.meta;return o?t.jsx(F,{}):t.jsxs(t.Fragment,{children:[t.jsx(d.Row,{style:{gap:"30px 0",marginBottom:"30px"},children:!o&&(e==null?void 0:e.data.map(s=>t.jsx(d.Col,{md:6,lg:4,xl:3,children:t.jsx(k,{consultation:s})},s.id)))}),r&&(Number(r==null?void 0:r.total)||0)>(Number(r==null?void 0:r.per_page)||0)&&t.jsx(v,{total:r.total,perPage:Number(r.per_page),currentPage:r.current_page,onPage:s=>n(s)})]})},$=()=>{var C;const[e,o]=j.useState({showDrawer:!1,type:h.categories}),{entities:n,loading:r,prevCategories:s,handleSortChange:c,handlePageChange:p,handleRemoveCategory:i,handleCategoryChange:g,onClearCategories:a,params:m,categoryTree:l}=M("consultations");return t.jsxs(t.Fragment,{children:[t.jsx(L,{prevCategories:s,onClearCategories:a,handleCategoryChange:g,categories:l.list||[],handleSortChange:c,params:m,setMobileDrawerState:o,parentState:e}),s.length>0&&t.jsx(N,{onClearCategories:a,prevCategories:s,handleRemoveCategory:i}),t.jsx(I,{consultations:n||[],loading:r,handlePageChange:p}),l&&t.jsx(t.Fragment,{children:t.jsx(E,{categories:((C=l.list)==null?void 0:C.filter(f=>!!f.icon))||[]})}),t.jsx(y,{isOpen:e.showDrawer,onClose:()=>o({showDrawer:!1,type:h.categories}),height:e.type===h.categories?"40vh":"12vh",children:t.jsx(R,{showDrawer:e.showDrawer,type:e.type,prevCategories:s,onClearCategories:a,handleCategoryChange:g,categories:l.list||[],handleSortChange:c,setMobileDrawerState:o})})]})},z=(e,o)=>{const[n,r]=u.useState(),[s,c]=u.useState(!0),{fetchConsultations:p}=u.useContext(w.EscolaLMSContext),i=async g=>{c(!0);try{const a=await p(g);a&&r(a)}catch(a){console.error(a),r(void 0)}finally{c(!1)}};return u.useEffect(()=>{e&&!o&&i(e)},[p]),{consultations:n,loading:s,fetchConsultationsData:i}},A=(e={})=>x.stringify(e),B=e=>{const{children:o}=e,[n,r]=u.useState({page:1,per_page:T,order_by:"created_at"}),{consultations:s,loading:c,fetchConsultationsData:p}=z(n,!0),i=P(),{push:g}=S(),a=x.parse(i.search),m=u.useMemo(()=>a&&{...a,order_by:"created_at"},[a]),l=m||n;return u.useEffect(()=>{g(`${i.pathname}?${A(l)}`),p(l)},[i.search]),t.jsx(q.Provider,{value:{params:n,setParams:r,consultations:s,loading:c},children:o})},te=()=>{const{t:e}=b();return t.jsx(D,{metaTitle:e("ConsultationsPageMeta"),children:t.jsx(B,{children:t.jsx(O,{title:e("ConsultationsPageMeta"),children:t.jsx($,{})})})})};export{te as default};
