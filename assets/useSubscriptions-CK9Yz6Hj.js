import{t as m}from"./toast-8bhsWSTr.js";import{r as a,A as v,f as d}from"./index-CcQ9x6fP.js";const z=()=>{var p,u,g,h,S;const{fetchProducts:l,fetchMyProducts:f,products:t,userProducts:i,user:b,attachProduct:x}=a.useContext(v.EscolaLMSContext),{t:n}=d(),o=a.useCallback(async()=>{try{await l({type:"subscription-all-in",pageSize:500})}catch(e){console.error("Error fetching subscriptions:",e),m(String(n("UnexpectedError")),"error")}},[l,n]),c=a.useCallback(async()=>{try{await f({type:"subscription-all-in",pageSize:500})}catch(e){console.error("Error fetching subscriptions:",e),m(String(n("UnexpectedError")),"error")}},[f,n]),C=a.useMemo(()=>{var e,s,r;return(r=(e=t==null?void 0:t.list)==null?void 0:e.data)==null?void 0:r.reduce((y,E)=>y.price>E.price?E:y,(s=t==null?void 0:t.list)==null?void 0:s.data[0])},[(p=t==null?void 0:t.list)==null?void 0:p.data]),M=a.useMemo(()=>{var e,s;return(s=(e=i==null?void 0:i.list)==null?void 0:e.data)==null?void 0:s.find(r=>r==null?void 0:r.is_active)},[(u=i==null?void 0:i.list)==null?void 0:u.data]);return a.useEffect(()=>{var e;(e=b.value)!=null&&e.id&&c(),o()},[o,c,(g=b.value)==null?void 0:g.id]),{fetchSubscriptions:o,fetchMySubscriptions:c,userProducts:((h=i==null?void 0:i.list)==null?void 0:h.data)??[],subscriptions:((S=t==null?void 0:t.list)==null?void 0:S.data)??[],isLoading:t.loading,getCheapestSubscription:C,getActiveSubscription:M,attachProduct:x}};export{z as u};
