{"version":3,"sources":["pages/register/index.tsx"],"names":["StyledRegisterPage","styled","div","StyledLink","Link","theme","primaryColor","StyledContent","StyledModal","Modal","RegisterPage","search","useLocation","useContext","EscolaLMSContext","user","socialAuthorize","useState","view","setView","modalVisible","setModalVisible","settings","email","setEmail","history","useHistory","token","split","t","useTranslation","footerFromApi","value","config","registerWarning","fieldLabels","size","to","setTimeout","push","loading","useEffect","EmailActivation","justify","md","className","level","components","a","props","children","onClick","underline","metaTitle","onClose","visible","animation","maskAnimation","destroyOnClose","width","mode","style","paddingBottom","isMobile","return_url","mobile","onLoginLink","onSuccess","_","values"],"mappings":"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","file":"static/js/30.d549360c.chunk.js","sourcesContent":["import { SetStateAction, useContext, useEffect, useState } from \"react\";\nimport { EscolaLMSContext } from \"@escolalms/sdk/lib/react/context\";\nimport { Link, useHistory } from \"react-router-dom\";\nimport Layout from \"@/components/_App/Layout\";\nimport { isMobile } from \"react-device-detect\";\nimport { useLocation } from \"react-router-dom\";\nimport { Title } from \"@escolalms/components/lib/components/atoms/Typography/Title\";\nimport { RegisterForm, Text } from \"@escolalms/components\";\nimport { useTranslation } from \"react-i18next\";\nimport styled from \"styled-components\";\nimport { MarkdownRenderer } from \"@escolalms/components/lib/components/molecules/MarkdownRenderer/MarkdownRenderer\";\nimport { Modal } from \"@escolalms/components/lib/components/atoms/Modal/Modal\";\nimport { Button } from \"@escolalms/components/lib/components/atoms/Button/Button\";\nimport { Col, Container, Row } from \"react-grid-system\";\nimport { Link as LinkComponent } from \"@escolalms/components/lib/components/atoms/Link/Link\";\n\nconst StyledRegisterPage = styled.div`\n  min-height: calc(100vh - 500px);\n  display: flex;\n  align-items: center;\n  justify-content: center;\n`;\n\nconst StyledLink = styled(Link)`\n  color: ${({ theme }) => theme.primaryColor}!important;\n`;\n\nconst StyledContent = styled.div`\n  .content-container {\n    display: flex;\n    justify-content: flex-start;\n    align-items: center;\n    flex-direction: column;\n\n    .email-title {\n      text-align: center;\n    }\n\n    .email-main-text {\n      text-align: center;\n      margin: 25px 0 85px;\n      font-weight: 700;\n      span {\n        color: ${({ theme }) => theme.primaryColor};\n      }\n    }\n\n    .email-help-text {\n      margin: 0 auto 20px 0;\n      ul {\n        padding-left: 15px;\n        margin-left: 0;\n        li {\n          font-size: 12px;\n        }\n      }\n    }\n\n    .back-text {\n      text-align: center;\n      margin-top: 20px;\n    }\n  }\n`;\n\nconst StyledModal = styled(Modal)`\n  a {\n    font-size: 1.14em;\n  }\n`;\n\nconst RegisterPage = () => {\n  const { search } = useLocation();\n  const { user, socialAuthorize } = useContext(EscolaLMSContext);\n  const [view, setView] = useState<\"\" | \"success\" | \"register\">(\"\");\n  const [modalVisible, setModalVisible] = useState(false);\n  const { settings } = useContext(EscolaLMSContext);\n\n  const [email, setEmail] = useState<string>(\"\");\n  const history = useHistory();\n  const token = search.split(\"?token=\")[1];\n  const { t } = useTranslation();\n\n  const footerFromApi: string = settings?.value?.config?.registerWarning;\n\n  const fieldLabels = {\n    \"AdditionalFields.Privacy Policy\": (\n      <Text size=\"14\">\n        {t(\"AcceptCheckbox\")}{\" \"}\n        <StyledLink to=\"/privacy-policy\">{t(\"PrivacyPolicy\")}</StyledLink>\n      </Text>\n    ),\n    \"AdditionalFields.Terms of Service\": (\n      <Text size=\"14\">\n        {t(\"AcceptCheckbox\")}{\" \"}\n        <StyledLink to=\"/privacy-policy\">{t(\"TermsOfService\")}</StyledLink>\n      </Text>\n    ),\n  };\n  if (token) {\n    socialAuthorize(token);\n    setTimeout(() => {\n      history.push(\"/\");\n    }, 1000);\n  }\n\n  if (!user.loading && !token && user.value) {\n    history.push(\"/\");\n  }\n\n  useEffect(() => {\n    setModalVisible(view === \"success\");\n  }, [view]);\n\n  const EmailActivation = () => {\n    return (\n      <StyledContent>\n        <Container>\n          <Row justify={\"center\"}>\n            <Col md={12}>\n              <div className=\"content-container\">\n                <Title className=\"email-title\" level={3}>\n                  {t(\"EmailActivation.Title\")}\n                </Title>\n                <MarkdownRenderer\n                  components={{\n                    a: (props) => <span>{props.children}</span>,\n                  }}\n                >\n                  {t(\"EmailActivation.Text\", { email })}\n                </MarkdownRenderer>\n                <MarkdownRenderer>\n                  {t(\"EmailActivation.HelpText\")}\n                </MarkdownRenderer>\n\n                <div className=\"back-text\">\n                  <LinkComponent onClick={() => setView(\"register\")} underline>\n                    {t(\"EmailActivation.RegisterAgain\")}\n                  </LinkComponent>\n                </div>\n              </div>\n            </Col>\n          </Row>\n        </Container>\n      </StyledContent>\n    );\n  };\n\n  return (\n    <Layout metaTitle={t(\"LoginAndRegister\")}>\n      {footerFromApi && (\n        <StyledModal\n          onClose={() => setModalVisible(false)}\n          visible={modalVisible}\n          animation=\"zoom\"\n          maskAnimation=\"fade\"\n          destroyOnClose={true}\n          width={800}\n        >\n          <Title level={4} className=\"modal-title\">\n            {t(\"Warning\")}\n          </Title>\n          <MarkdownRenderer>{footerFromApi}</MarkdownRenderer>\n          <Button mode=\"outline\" onClick={() => setModalVisible(false)}>\n            {t(\"I'm aware\")}\n          </Button>\n        </StyledModal>\n      )}\n\n      {view !== \"success\" ? (\n        <StyledRegisterPage>\n          <Container\n            style={{\n              paddingBottom: `${isMobile ? \"50px\" : \"100px\"}`,\n            }}\n          >\n            <Row justify=\"center\">\n              <Col md={12}>\n                <RegisterForm\n                  return_url={\"#/email-verify\"}\n                  fieldLabels={fieldLabels}\n                  mobile={isMobile}\n                  onLoginLink={() => history.push(\"/login\")}\n                  onSuccess={(\n                    _: any,\n                    values: { email: SetStateAction<string> }\n                  ) => {\n                    setView(\"success\");\n                    setEmail(values.email);\n                  }}\n                />\n              </Col>\n            </Row>\n          </Container>\n        </StyledRegisterPage>\n      ) : (\n        <EmailActivation />\n      )}\n    </Layout>\n  );\n};\n\nexport default RegisterPage;\n"],"sourceRoot":""}