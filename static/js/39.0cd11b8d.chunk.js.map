{"version":3,"sources":["pages/register/index.tsx"],"names":["StyledRegisterPage","styled","div","_templateObject","_taggedTemplateLiteral","StyledLink","Link","_templateObject2","_ref","theme","primaryColor","StyledContent","_templateObject3","_ref2","StyledModal","Modal","_templateObject4","RegisterPage","_settings$value","_settings$value$confi","search","useLocation","_useContext","useContext","EscolaLMSContext","user","socialAuthorize","_useState","useState","_useState2","_slicedToArray","view","setView","_useState3","_useState4","modalVisible","setModalVisible","settings","_useState5","_useState6","email","setEmail","history","useHistory","token","split","t","useTranslation","footerFromApi","value","config","registerWarning","fieldLabels","_jsxs","Text","size","children","_jsx","to","setTimeout","push","loading","useEffect","EmailActivation","Container","Row","justify","Col","md","className","Title","level","MarkdownRenderer","components","a","props","LinkComponent","onClick","underline","Layout","metaTitle","onClose","visible","animation","maskAnimation","destroyOnClose","width","Button","mode","RegisterForm","return_url","mobile","isMobile","onLoginLink","onSuccess","_","values"],"mappings":"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","file":"static/js/39.0cd11b8d.chunk.js","sourcesContent":["import { SetStateAction, useContext, useEffect, useState } from \"react\";\nimport { EscolaLMSContext } from \"@escolalms/sdk/lib/react/context\";\nimport { Link, useHistory } from \"react-router-dom\";\nimport Layout from \"@/components/_App/Layout\";\nimport { isMobile } from \"react-device-detect\";\nimport { useLocation } from \"react-router-dom\";\nimport { Title } from \"@escolalms/components/lib/components/atoms/Typography/Title\";\nimport { RegisterForm, Text } from \"@escolalms/components\";\nimport { useTranslation } from \"react-i18next\";\nimport styled from \"styled-components\";\nimport { MarkdownRenderer } from \"@escolalms/components/lib/components/molecules/MarkdownRenderer/MarkdownRenderer\";\nimport { Modal } from \"@escolalms/components/lib/components/atoms/Modal/Modal\";\nimport { Button } from \"@escolalms/components/lib/components/atoms/Button/Button\";\nimport { Col, Row } from \"react-grid-system\";\nimport { Link as LinkComponent } from \"@escolalms/components/lib/components/atoms/Link/Link\";\nimport Container from \"@/components/Container\";\n\nconst StyledRegisterPage = styled.div`\n  min-height: calc(100vh - 500px);\n  display: flex;\n  align-items: center;\n  justify-content: center;\n`;\n\nconst StyledLink = styled(Link)`\n  color: ${({ theme }) => theme.primaryColor}!important;\n`;\n\nconst StyledContent = styled.div`\n  .content-container {\n    display: flex;\n    justify-content: flex-start;\n    align-items: center;\n    flex-direction: column;\n\n    .email-title {\n      text-align: center;\n    }\n\n    .email-main-text {\n      text-align: center;\n      margin: 25px 0 85px;\n      font-weight: 700;\n      span {\n        color: ${({ theme }) => theme.primaryColor};\n      }\n    }\n\n    .email-help-text {\n      margin: 0 auto 20px 0;\n      ul {\n        padding-left: 15px;\n        margin-left: 0;\n        li {\n          font-size: 12px;\n        }\n      }\n    }\n\n    .back-text {\n      text-align: center;\n      margin-top: 20px;\n    }\n  }\n`;\n\nconst StyledModal = styled(Modal)`\n  a {\n    font-size: 1.14em;\n  }\n`;\n\nconst RegisterPage = () => {\n  const { search } = useLocation();\n  const { user, socialAuthorize } = useContext(EscolaLMSContext);\n  const [view, setView] = useState<\"\" | \"success\" | \"register\">(\"\");\n  const [modalVisible, setModalVisible] = useState(false);\n  const { settings } = useContext(EscolaLMSContext);\n\n  const [email, setEmail] = useState<string>(\"\");\n  const history = useHistory();\n  const token = search.split(\"?token=\")[1];\n  const { t } = useTranslation();\n\n  const footerFromApi: string = settings?.value?.config?.registerWarning;\n\n  const fieldLabels = {\n    \"AdditionalFields.Privacy Policy\": (\n      <Text size=\"14\">\n        {t(\"AcceptCheckbox\")}{\" \"}\n        <StyledLink to=\"/privacy-policy\">{t(\"PrivacyPolicy\")}</StyledLink>\n      </Text>\n    ),\n    \"AdditionalFields.Terms of Service\": (\n      <Text size=\"14\">\n        {t(\"AcceptCheckbox\")}{\" \"}\n        <StyledLink to=\"/privacy-policy\">{t(\"TermsOfService\")}</StyledLink>\n      </Text>\n    ),\n  };\n  if (token) {\n    socialAuthorize(token);\n    setTimeout(() => {\n      history.push(\"/\");\n    }, 1000);\n  }\n\n  if (!user.loading && !token && user.value) {\n    history.push(\"/\");\n  }\n\n  useEffect(() => {\n    setModalVisible(view === \"success\");\n  }, [view]);\n\n  const EmailActivation = () => {\n    return (\n      <StyledContent>\n        <Container>\n          <Row justify={\"center\"}>\n            <Col md={12}>\n              <div className=\"content-container\">\n                <Title className=\"email-title\" level={3}>\n                  {t(\"EmailActivation.Title\")}\n                </Title>\n                <MarkdownRenderer\n                  components={{\n                    a: (props) => <span>{props.children}</span>,\n                  }}\n                >\n                  {t(\"EmailActivation.Text\", { email })}\n                </MarkdownRenderer>\n                <MarkdownRenderer>\n                  {t(\"EmailActivation.HelpText\")}\n                </MarkdownRenderer>\n\n                <div className=\"back-text\">\n                  <LinkComponent onClick={() => setView(\"register\")} underline>\n                    {t(\"EmailActivation.RegisterAgain\")}\n                  </LinkComponent>\n                </div>\n              </div>\n            </Col>\n          </Row>\n        </Container>\n      </StyledContent>\n    );\n  };\n\n  return (\n    <Layout metaTitle={t(\"LoginAndRegister\")}>\n      {footerFromApi && (\n        <StyledModal\n          onClose={() => setModalVisible(false)}\n          visible={modalVisible}\n          animation=\"zoom\"\n          maskAnimation=\"fade\"\n          destroyOnClose={true}\n          width={800}\n        >\n          <Title level={4} className=\"modal-title\">\n            {t(\"Warning\")}\n          </Title>\n          <MarkdownRenderer>{footerFromApi}</MarkdownRenderer>\n          <Button mode=\"outline\" onClick={() => setModalVisible(false)}>\n            {t(\"I'm aware\")}\n          </Button>\n        </StyledModal>\n      )}\n\n      {view !== \"success\" ? (\n        <StyledRegisterPage>\n          <Container>\n            <Row justify=\"center\">\n              <Col md={12}>\n                <RegisterForm\n                  return_url={\"#/email-verify\"}\n                  fieldLabels={fieldLabels}\n                  mobile={isMobile}\n                  onLoginLink={() => history.push(\"/login\")}\n                  onSuccess={(\n                    _: any,\n                    values: { email: SetStateAction<string> }\n                  ) => {\n                    setView(\"success\");\n                    setEmail(values.email);\n                  }}\n                />\n              </Col>\n            </Row>\n          </Container>\n        </StyledRegisterPage>\n      ) : (\n        <EmailActivation />\n      )}\n    </Layout>\n  );\n};\n\nexport default RegisterPage;\n"],"sourceRoot":""}