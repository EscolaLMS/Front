{"version":3,"sources":["pages/register/index.tsx"],"names":["StyledRegisterPage","styled","div","StyledLink","Link","theme","primaryColor","StyledContent","StyledModal","Modal","RegisterPage","search","useLocation","useContext","EscolaLMSContext","user","socialAuthorize","useState","view","setView","modalVisible","setModalVisible","settings","email","setEmail","history","useHistory","token","split","t","useTranslation","footerFromApi","value","config","registerWarning","fieldLabels","size","to","setTimeout","push","loading","useEffect","EmailActivation","justify","md","className","level","components","a","props","children","onClick","underline","metaTitle","onClose","visible","animation","maskAnimation","destroyOnClose","width","mode","style","paddingBottom","isMobile","return_url","mobile","onLoginLink","onSuccess","_","values"],"mappings":"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","file":"static/js/33.c93ab2b8.chunk.js","sourcesContent":["import { SetStateAction, useContext, useEffect, useState } from \"react\";\nimport { EscolaLMSContext } from \"@escolalms/sdk/lib/react/context\";\nimport { Link, useHistory } from \"react-router-dom\";\nimport Layout from \"@/components/_App/Layout\";\nimport { isMobile } from \"react-device-detect\";\nimport { useLocation } from \"react-router-dom\";\nimport { Title } from \"@escolalms/components/lib/components/atoms/Typography/Title\";\nimport { RegisterForm, Text } from \"@escolalms/components\";\nimport { useTranslation } from \"react-i18next\";\nimport styled from \"styled-components\";\nimport { MarkdownRenderer } from \"@escolalms/components/lib/components/molecules/MarkdownRenderer/MarkdownRenderer\";\nimport { Modal } from \"@escolalms/components/lib/components/atoms/Modal/Modal\";\nimport { Button } from \"@escolalms/components/lib/components/atoms/Button/Button\";\nimport { Col, Row } from \"react-grid-system\";\nimport { Link as LinkComponent } from \"@escolalms/components/lib/components/atoms/Link/Link\";\nimport Container from \"@/components/Container\";\n\nconst StyledRegisterPage = styled.div`\n  min-height: calc(100vh - 500px);\n  display: flex;\n  align-items: center;\n  justify-content: center;\n`;\n\nconst StyledLink = styled(Link)`\n  color: ${({ theme }) => theme.primaryColor}!important;\n`;\n\nconst StyledContent = styled.div`\n  .content-container {\n    display: flex;\n    justify-content: flex-start;\n    align-items: center;\n    flex-direction: column;\n\n    .email-title {\n      text-align: center;\n    }\n\n    .email-main-text {\n      text-align: center;\n      margin: 25px 0 85px;\n      font-weight: 700;\n      span {\n        color: ${({ theme }) => theme.primaryColor};\n      }\n    }\n\n    .email-help-text {\n      margin: 0 auto 20px 0;\n      ul {\n        padding-left: 15px;\n        margin-left: 0;\n        li {\n          font-size: 12px;\n        }\n      }\n    }\n\n    .back-text {\n      text-align: center;\n      margin-top: 20px;\n    }\n  }\n`;\n\nconst StyledModal = styled(Modal)`\n  a {\n    font-size: 1.14em;\n  }\n`;\n\nconst RegisterPage = () => {\n  const { search } = useLocation();\n  const { user, socialAuthorize } = useContext(EscolaLMSContext);\n  const [view, setView] = useState<\"\" | \"success\" | \"register\">(\"\");\n  const [modalVisible, setModalVisible] = useState(false);\n  const { settings } = useContext(EscolaLMSContext);\n\n  const [email, setEmail] = useState<string>(\"\");\n  const history = useHistory();\n  const token = search.split(\"?token=\")[1];\n  const { t } = useTranslation();\n\n  const footerFromApi: string = settings?.value?.config?.registerWarning;\n\n  const fieldLabels = {\n    \"AdditionalFields.Privacy Policy\": (\n      <Text size=\"14\">\n        {t(\"AcceptCheckbox\")}{\" \"}\n        <StyledLink to=\"/privacy-policy\">{t(\"PrivacyPolicy\")}</StyledLink>\n      </Text>\n    ),\n    \"AdditionalFields.Terms of Service\": (\n      <Text size=\"14\">\n        {t(\"AcceptCheckbox\")}{\" \"}\n        <StyledLink to=\"/privacy-policy\">{t(\"TermsOfService\")}</StyledLink>\n      </Text>\n    ),\n  };\n  if (token) {\n    socialAuthorize(token);\n    setTimeout(() => {\n      history.push(\"/\");\n    }, 1000);\n  }\n\n  if (!user.loading && !token && user.value) {\n    history.push(\"/\");\n  }\n\n  useEffect(() => {\n    setModalVisible(view === \"success\");\n  }, [view]);\n\n  const EmailActivation = () => {\n    return (\n      <StyledContent>\n        <Container>\n          <Row justify={\"center\"}>\n            <Col md={12}>\n              <div className=\"content-container\">\n                <Title className=\"email-title\" level={3}>\n                  {t(\"EmailActivation.Title\")}\n                </Title>\n                <MarkdownRenderer\n                  components={{\n                    a: (props) => <span>{props.children}</span>,\n                  }}\n                >\n                  {t(\"EmailActivation.Text\", { email })}\n                </MarkdownRenderer>\n                <MarkdownRenderer>\n                  {t(\"EmailActivation.HelpText\")}\n                </MarkdownRenderer>\n\n                <div className=\"back-text\">\n                  <LinkComponent onClick={() => setView(\"register\")} underline>\n                    {t(\"EmailActivation.RegisterAgain\")}\n                  </LinkComponent>\n                </div>\n              </div>\n            </Col>\n          </Row>\n        </Container>\n      </StyledContent>\n    );\n  };\n\n  return (\n    <Layout metaTitle={t(\"LoginAndRegister\")}>\n      {footerFromApi && (\n        <StyledModal\n          onClose={() => setModalVisible(false)}\n          visible={modalVisible}\n          animation=\"zoom\"\n          maskAnimation=\"fade\"\n          destroyOnClose={true}\n          width={800}\n        >\n          <Title level={4} className=\"modal-title\">\n            {t(\"Warning\")}\n          </Title>\n          <MarkdownRenderer>{footerFromApi}</MarkdownRenderer>\n          <Button mode=\"outline\" onClick={() => setModalVisible(false)}>\n            {t(\"I'm aware\")}\n          </Button>\n        </StyledModal>\n      )}\n\n      {view !== \"success\" ? (\n        <StyledRegisterPage>\n          <Container\n            style={{\n              paddingBottom: `${isMobile ? \"50px\" : \"100px\"}`,\n            }}\n          >\n            <Row justify=\"center\">\n              <Col md={12}>\n                <RegisterForm\n                  return_url={\"#/email-verify\"}\n                  fieldLabels={fieldLabels}\n                  mobile={isMobile}\n                  onLoginLink={() => history.push(\"/login\")}\n                  onSuccess={(\n                    _: any,\n                    values: { email: SetStateAction<string> }\n                  ) => {\n                    setView(\"success\");\n                    setEmail(values.email);\n                  }}\n                />\n              </Col>\n            </Row>\n          </Container>\n        </StyledRegisterPage>\n      ) : (\n        <EmailActivation />\n      )}\n    </Layout>\n  );\n};\n\nexport default RegisterPage;\n"],"sourceRoot":""}