{"version":3,"sources":["components/Course/CourseDownloads/index.tsx","components/Errorbox/index.tsx","components/Course/CourseProgramLessons.tsx","pages/course/index.tsx","components/Breadcrumbs/index.tsx","components/Preloader/index.tsx","../node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js","../node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js","hooks/useLessonProgram.ts","components/Course/CourseSidebar/index.tsx","components/Course/Players/TextPlayer.tsx","components/Course/Players/ScormPlayer.tsx","components/Course/CourseProgramContent.tsx","../node_modules/@escolalms/sdk/lib/index.js"],"names":["StyledDownloads","styled","div","CourseDownloads","resources","subtitle","t","useTranslation","mappedResources","map","item","href","url","fileName","name","Downloads","title","downloads","StyledErrorPage","ErrorBox","error","goTo","goToText","alternativeButton","history","useHistory","buttonText","Layout","size","className","mode","onClick","push","StyledCourse","section","CourseProgramLessons","program","courseId","useLessonProgram","topic","lesson","onNextTopic","onPrevTopic","getNextPrevTopic","isNextTopicButtonDisabled","disableNextTopicButton","sendProgress","progress","courseProgressDetails","useContext","EscolaLMSContext","topicID","useParams","startWithBreakPoint","useLocation","pathname","split","length","getCourseProgress","useMemo","byId","Number","value","find","courseProgress","course","id","onCompleteTopic","useCallback","topic_id","status","topicBreakPoint","currentProgress","lastStartedLesson","filter","API","CourseProgressItemElementStatus","IN_PROGRESS","sort","a","b","Date","started_at","getTime","INCOMPLETE","findLessonBreakPoint","lessons","topics","some","useEffect","window","scrollTo","top","behavior","columnWidth","summary","resetProgress","flatMap","Fragment","Container","Breadcrumbs","items","to","Text","Title","level","lg","introduction","MarkdownRenderer","style","json","wrapperStyle","CourseProgramContent","lessonId","topicId","isThereAnotherTopic","Boolean","sm","md","CourseSidebar","CourseTopNav","onFinish","mobile","isMobile","onNext","isFinished","findIndex","ttopic","COMPLETE","onPrev","addNotes","hasPrev","hasNext","CourseProgramScorm","sco","scorm_sco","uuid","iframeRef","useRef","useState","height","setHeight","apiUrl","current","contentWindow","document","body","scrollHeight","ref","src","scrolling","CourseProgram","fetchProgram","fetchCourseProgress","loading","Preloader","scorm_sco_id","metaTitle","StyledBreadcrumbs","theme","gray5","gray2","StyledLoader","dm__background","background","useTheme","overflow","color","primaryColor","_regeneratorRuntime","exports","Op","Object","prototype","hasOwn","hasOwnProperty","defineProperty","obj","key","desc","$Symbol","Symbol","iteratorSymbol","iterator","asyncIteratorSymbol","asyncIterator","toStringTagSymbol","toStringTag","define","enumerable","configurable","writable","err","wrap","innerFn","outerFn","self","tryLocsList","protoGenerator","Generator","generator","create","context","Context","makeInvokeMethod","tryCatch","fn","arg","type","call","ContinueSentinel","GeneratorFunction","GeneratorFunctionPrototype","IteratorPrototype","this","getProto","getPrototypeOf","NativeIteratorPrototype","values","Gp","defineIteratorMethods","forEach","method","_invoke","AsyncIterator","PromiseImpl","invoke","resolve","reject","record","result","__await","then","unwrapped","previousPromise","callInvokeWithMethodAndArg","state","Error","doneResult","delegate","delegateResult","maybeInvokeDelegate","sent","_sent","dispatchException","abrupt","done","methodName","undefined","TypeError","info","resultName","next","nextLoc","pushTryEntry","locs","entry","tryLoc","catchLoc","finallyLoc","afterLoc","tryEntries","resetTryEntry","completion","reset","iterable","iteratorMethod","isNaN","i","displayName","isGeneratorFunction","genFun","ctor","constructor","mark","setPrototypeOf","__proto__","awrap","async","Promise","iter","keys","val","object","reverse","pop","skipTempReset","prev","charAt","slice","stop","rootRecord","rval","exception","handle","loc","caught","hasCatch","hasFinally","finallyEntry","complete","finish","thrown","delegateYield","asyncGeneratorStep","gen","_next","_throw","_asyncToGenerator","args","arguments","apply","courseRouteName","lessonID","nextTopic","lesson_id","prevTopic","onNextTopicPreview","StyledSidebar","aside","css","agendaVisible","setAgendaVisible","topicIsFinished","allTopics","arrayOfTopics","concat","finishedTopics","progressItem","onNextTopicClick","lIndex","tIndex","currentTopicId","finishedTopicIds","onMarkFinished","onTopicClick","fontSizes","TextPlayer","onLoad","fontSize","components","props","Link","underline","StyledDiv","fullview","ScormPlayer","fullView","setFullView","Button","topicable","StyledPdfPlayer","PdfPlayer","preview","customNoCompletedEventsIds","topicPing","h5pProgress","onXAPI","event","statement","verb","String","isTopicFinished","can_skip","ping","interval","setInterval","clearInterval","topicable_type","TopicType","H5P","H5Player","e","h5pObject","content","OEmbed","OEmbedPlayer","RichText","Video","AudioVideoPlayer","light","Image","ImagePlayer","Audio","audio","Pdf","pageConfig","renderMode","Scorm","__createBinding","o","m","k","k2","getOwnPropertyDescriptor","__esModule","get","__setModuleDefault","v","__importStar","mod","react","require"],"mappings":"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","file":"static/js/8.2e1ba0fe.chunk.js","sourcesContent":["import React from \"react\";\nimport { Downloads } from \"@escolalms/components/lib/components/molecules/Downloads/Downloads\";\nimport styled from \"styled-components\";\nimport { useTranslation } from \"react-i18next\";\nimport { API } from \"@escolalms/sdk/lib\";\n\ntype Props = {\n  resources: API.TopicResource[];\n  subtitle: string;\n};\n\nconst StyledDownloads = styled.div`\n  margin-top: 100px;\n`;\n\nconst CourseDownloads: React.FC<Props> = ({ resources, subtitle }) => {\n  const { t } = useTranslation();\n  const mappedResources = resources.map((item) => {\n    return { href: item.url, fileName: item.name };\n  });\n  return (\n    <StyledDownloads>\n      <Downloads\n        subtitle={subtitle}\n        title={t<string>(\"CourseProgram.TopicAttachment\")}\n        downloads={mappedResources}\n      />\n    </StyledDownloads>\n  );\n};\n\nexport default CourseDownloads;\n","import Layout from \"@/components/_App/Layout\";\nimport { Button, Text } from \"@escolalms/components\";\nimport { useTranslation } from \"react-i18next\";\nimport { useHistory } from \"react-router-dom\";\nimport styled from \"styled-components\";\n\nconst StyledErrorPage = styled.div`\n  min-height: calc(100vh - 150px);\n  text-align: center;\n  display: flex;\n  justify-content: center;\n  align-items: center;\n  flex-direction: column;\n\n  .buttons-block {\n    display: grid;\n    gap: 8px;\n  }\n`;\n\ninterface AlternativeButton {\n  goTo: string;\n  goToText: string;\n}\n\ninterface Props {\n  error: string;\n  goTo?: string;\n  goToText?: string;\n  alternativeButton?: AlternativeButton;\n}\n\nconst ErrorBox: React.FC<Props> = ({\n  error,\n  goTo = \"/courses\",\n  goToText,\n  alternativeButton,\n}) => {\n  const { t } = useTranslation();\n  const history = useHistory();\n  const buttonText = goToText ?? t(\"CoursePage.SeeOtherCourses\");\n\n  return (\n    <Layout>\n      <StyledErrorPage>\n        <Text size=\"16\">\n          <strong>{t(\"CoursePage.ErrorOccurred\")}</strong>\n        </Text>\n        <Text size=\"14\">{error}</Text>\n        <hr />\n        <div className=\"buttons-block\">\n          <Button mode=\"secondary\" onClick={() => history.push(goTo)}>\n            {buttonText}\n          </Button>\n          {alternativeButton && (\n            <Button\n              mode=\"outline\"\n              onClick={() => history.push(alternativeButton.goTo)}\n            >\n              {alternativeButton.goToText}\n            </Button>\n          )}\n        </div>\n      </StyledErrorPage>\n    </Layout>\n  );\n};\nexport default ErrorBox;\n","//@ts-nocheck - remove when Course Top Nav will have fixed notes props\nimport React, { useCallback, useEffect, useMemo, useContext } from \"react\";\nimport { API } from \"@escolalms/sdk/lib\";\nimport CourseProgramContent from \"@/components/Course/CourseProgramContent\";\nimport CourseSidebar from \"@/components/Course/CourseSidebar\";\nimport { useLessonProgram } from \"../../hooks/useLessonProgram\";\nimport { Title } from \"@escolalms/components/lib/components/atoms/Typography/Title\";\nimport { CourseTopNav } from \"@escolalms/components/lib/components/molecules/CourseTopNav/CourseTopNav\";\nimport { MarkdownRenderer } from \"@escolalms/components/lib/components/molecules/MarkdownRenderer/MarkdownRenderer\";\nimport { Text } from \"@escolalms/components/lib/components/atoms/Typography/Text\";\nimport { Link, useHistory, useLocation, useParams } from \"react-router-dom\";\nimport styled from \"styled-components\";\nimport { isMobile } from \"react-device-detect\";\nimport CourseDownloads from \"./CourseDownloads\";\nimport { useTranslation } from \"react-i18next\";\nimport Breadcrumbs from \"../Breadcrumbs\";\nimport { Col, Row } from \"react-grid-system\";\nimport Container from \"../Container\";\nimport { EscolaLMSContext } from \"@escolalms/sdk/lib/react/context\";\nimport ErrorBox from \"../Errorbox\";\nimport { Button } from \"@escolalms/components\";\n\nconst StyledCourse = styled.section`\n  padding-bottom: 110px;\n  .main-title {\n    margin-bottom: 20px;\n  }\n  .course-nav {\n    position: fixed;\n    bottom: 0;\n    left: 0;\n    width: 100%;\n    z-index: 100;\n  }\n  img {\n    max-width: 100%;\n    height: auto;\n  }\n`;\n\nexport const courseIncomplete = 0;\nexport const courseComplete = 1;\nexport const courseInProgress = 2;\n\nexport const CourseProgramLessons: React.FC<{\n  program: API.CourseProgram;\n  courseId?: number;\n}> = ({ program, courseId }) => {\n  const {\n    topic,\n    lesson,\n    onNextTopic,\n    onPrevTopic,\n    getNextPrevTopic,\n    isNextTopicButtonDisabled,\n    disableNextTopicButton,\n    sendProgress,\n    progress,\n  } = useLessonProgram(program);\n  const { courseProgressDetails } = useContext(EscolaLMSContext);\n\n  const { topicID } = useParams<{ lessonID: string; topicID: string }>();\n  const { push } = useHistory();\n  const { t } = useTranslation();\n  const location = useLocation();\n  // if pathname contain 3 splited items we cannot fire topicbreakpoint effect otherwise we can\n  const startWithBreakPoint = location.pathname.split(\"/\").length === 3;\n\n  const getCourseProgress = useMemo(() => {\n    if (\n      //courseProgress. &&\n      courseProgressDetails.byId[Number(courseId)] &&\n      courseProgressDetails.byId[Number(courseId)].value\n    ) {\n      return courseProgressDetails.byId[Number(courseId)].value;\n    }\n    return (\n      progress &&\n      progress.value &&\n      progress.value.find(\n        (courseProgress: API.CourseProgressItem) =>\n          courseProgress.course.id === Number(courseId)\n      )?.progress\n    );\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [progress, courseId]);\n\n  const onCompleteTopic = useCallback((): void => {\n    if (program?.id) {\n      sendProgress(program?.id, [{ topic_id: Number(topicID), status: 1 }]);\n    }\n  }, [program, topicID, sendProgress]);\n\n  const topicBreakPoint = useMemo(() => {\n    const currentProgress = getCourseProgress || [];\n\n    const lastStartedLesson = currentProgress\n      .filter(\n        (topic: API.CourseProgressItemElement) =>\n          topic.status === API.CourseProgressItemElementStatus.IN_PROGRESS\n      )\n      .sort(\n        (a: API.CourseProgressItemElement, b: API.CourseProgressItemElement) =>\n          new Date(b.started_at as string).getTime() -\n          new Date(a.started_at as string).getTime()\n      )[0];\n\n    if (!lastStartedLesson) {\n      return currentProgress.filter(\n        (topic: API.CourseProgressItemElement) =>\n          topic.status === API.CourseProgressItemElementStatus.INCOMPLETE\n      )[0];\n    }\n    return lastStartedLesson;\n  }, [getCourseProgress]);\n\n  const findLessonBreakPoint = useMemo(() => {\n    return (\n      topicBreakPoint &&\n      program.lessons.find(\n        (lesson: API.Lesson) =>\n          lesson &&\n          lesson.topics &&\n          lesson.topics.some(\n            (topic: API.Topic) => topic.id === topicBreakPoint.topic_id\n          )\n      )\n    );\n  }, [program, topicBreakPoint]);\n\n  useEffect(() => {\n    if (startWithBreakPoint) {\n      if (findLessonBreakPoint && topicBreakPoint) {\n        push(\n          `/course/${program.id}/${findLessonBreakPoint.id}/${topicBreakPoint.topic_id}`,\n          null\n        );\n      }\n    }\n  }, [\n    startWithBreakPoint,\n    findLessonBreakPoint,\n    program,\n    push,\n    topicBreakPoint,\n  ]);\n\n  useEffect(() => {\n    window.scrollTo({ top: 0, behavior: \"smooth\" });\n  }, [lesson?.id, topic?.id]);\n\n  useEffect(() => {\n    if (!program || !topic) return;\n    if (getNextPrevTopic(Number(topic?.id)) === null) {\n      disableNextTopicButton(true);\n      sendProgress(program.id, [{ topic_id: Number(topic?.id), status: 1 }]);\n      return;\n    }\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [topic?.id, program]);\n\n  const columnWidth =\n    lesson && lesson.summary && topic && topic.summary ? 6 : 12;\n\n  window.resetProgress = () =>\n    (async () => {\n      await sendProgress(\n        program.id,\n        program.lessons\n          .flatMap((lesson) => lesson.topics)\n          .map((topic) => ({ topic_id: Number(topic?.id), status: 0 }))\n      );\n    })();\n\n  if (!program) {\n    return <ErrorBox error={t(\"CourseProgram.NoProgram\")} />;\n  }\n\n  if (!topic) {\n    return (\n      <ErrorBox\n        error={t(\"CourseProgram.NoTopic\")}\n        goTo={`/course/${program.id}`}\n        goToText={t(\"CoursePage.BackToCourse\")}\n        alternativeButton={{\n          goTo: \"/courses\",\n          goToText: t(\"CoursePage.SeeOtherCourses\"),\n        }}\n      />\n    );\n  }\n\n  return (\n    <React.Fragment>\n      <StyledCourse className=\"course-program-wrapper\">\n        <Container>\n          <Breadcrumbs\n            items={[\n              <Link to=\"/\">{t(\"Home\")}</Link>,\n              <Link to=\"/courses\">{t(\"Courses\")}</Link>,\n              <Text size=\"12\">{program.title}</Text>,\n              <Text size=\"12\">{topic.title}</Text>,\n            ]}\n          />\n          <Title className=\"main-title\" level={3}>\n            {topic.title}\n          </Title>\n          <Row>\n            <Col lg={9}>\n              <div className=\"course-program-player\">\n                <div className=\"course-program-player-content\">\n                  {topic && topic.introduction && (\n                    <MarkdownRenderer>{topic.introduction}</MarkdownRenderer>\n                  )}\n                  <div\n                    className=\"course-program-player-content__wrapper\"\n                    style={{\n                      ...((topic?.json?.wrapperStyle as object) || {}),\n                    }}\n                  >\n                    <CourseProgramContent\n                      key={topic.id}\n                      lessonId={Number(lesson?.id)}\n                      topicId={topic && Number(topic.id)}\n                      disableNextTopicButton={disableNextTopicButton}\n                      isThereAnotherTopic={Boolean(\n                        getNextPrevTopic(Number(topic?.id))\n                      )}\n                    />\n                  </div>\n                </div>\n                <div className=\"course-program-content__container\">\n                  <Row>\n                    {lesson && lesson.summary && (\n                      <Col sm={12} md={columnWidth} lg={columnWidth}>\n                        <div className=\"course-program-summary\">\n                          <MarkdownRenderer>{lesson.summary}</MarkdownRenderer>\n                        </div>\n                      </Col>\n                    )}\n                    {topic && topic.summary && (\n                      <Col sm={12} md={columnWidth} lg={columnWidth}>\n                        <div className=\"course-program-summary\">\n                          <MarkdownRenderer>{topic.summary}</MarkdownRenderer>\n\n                          {topic &&\n                            topic.resources &&\n                            topic.resources?.length > 0 && (\n                              <CourseDownloads\n                                resources={topic.resources || []}\n                                subtitle={topic.introduction || \"\"}\n                              />\n                            )}\n                        </div>\n                      </Col>\n                    )}\n                  </Row>\n                </div>\n              </div>\n            </Col>\n            <Col lg={3}>\n              <CourseSidebar\n                course={program}\n                lessonId={Number(lesson?.id)}\n                topicId={Number(topic?.id)}\n              />\n            </Col>\n          </Row>\n        </Container>\n        <div className=\"course-nav\">\n          <Container>\n            <CourseTopNav\n              onFinish={() => onCompleteTopic()}\n              mobile={isMobile}\n              onNext={onNextTopic}\n              isFinished={\n                getCourseProgress?.findIndex(\n                  (ttopic) =>\n                    ttopic.topic_id === topic.id &&\n                    ttopic.status ===\n                      API.CourseProgressItemElementStatus.COMPLETE\n                ) > -1\n              }\n              onPrev={onPrevTopic}\n              addNotes={false}\n              hasPrev={\n                getNextPrevTopic(Number(topic?.id), false) ? true : false\n              }\n              hasNext={!isNextTopicButtonDisabled}\n            />\n          </Container>\n        </div>\n      </StyledCourse>\n    </React.Fragment>\n  );\n};\n\nexport default CourseProgramLessons;\n","import React, { useContext, useEffect, useRef, useState } from \"react\";\nimport { useParams } from \"react-router-dom\";\nimport { API } from \"@escolalms/sdk/lib\";\nimport { EscolaLMSContext } from \"@escolalms/sdk/lib/react/context\";\nimport Preloader from \"@/components/Preloader\";\nimport Layout from \"@/components/_App/Layout\";\n\nimport CourseProgramLessons from \"@/components/Course/CourseProgramLessons\";\nimport ErrorBox from \"@/components/Errorbox\";\nimport { t } from \"i18next\";\n\n// TODO: 99% same as: src/pages/courses/preview/index.tsx\n\nconst CourseProgramScorm: React.FC<{ program: API.CourseProgram }> = ({\n  program,\n}) => {\n  const sco = program?.scorm_sco;\n  const uuid = sco?.uuid;\n  const iframeRef = useRef<HTMLIFrameElement>(null);\n  const [height, setHeight] = useState(0);\n  const headerAndFooterHeight = 610;\n  const { apiUrl } = useContext(EscolaLMSContext);\n\n  useEffect(() => {\n    if (iframeRef.current) {\n      setHeight(\n        iframeRef.current?.contentWindow?.document?.body?.scrollHeight || 0\n      );\n    }\n  }, [iframeRef]);\n\n  if (!sco && !uuid) {\n    return <React.Fragment />;\n  }\n\n  return (\n    <React.Fragment>\n      <div className=\"container-fluid course-program\">\n        <div\n          className=\"course-program-player scorm\"\n          style={{\n            height: `${headerAndFooterHeight + height}px`,\n          }}\n        >\n          <iframe\n            title={\"scorm-player\"}\n            ref={iframeRef}\n            src={`${apiUrl}/api/scorm/play/${uuid}`}\n            scrolling=\"no\"\n          />\n        </div>\n      </div>\n    </React.Fragment>\n  );\n};\n\nconst CourseProgram = () => {\n  const { id } = useParams<{ id: string }>();\n  const { program, fetchProgram, fetchCourseProgress } =\n    useContext(EscolaLMSContext);\n\n  useEffect(() => {\n    if (id) {\n      fetchProgram(Number(id));\n      fetchCourseProgress(Number(id));\n      //fetchCourseProgress(Number(id));\n      //fetchProgress();\n    }\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [id]);\n\n  if (program.loading) {\n    return <Preloader />;\n  }\n\n  if (program.error) {\n    return <ErrorBox error={t(\"CourseProgram.NoProgram\")} />;\n  }\n\n  if (program.value && program?.value?.scorm_sco_id) {\n    return (\n      <Layout metaTitle={program.value.title}>\n        <CourseProgramScorm program={program.value} />\n      </Layout>\n    );\n  }\n  if (program.value && program.value.lessons && program.value.lessons.length) {\n    return (\n      <Layout metaTitle={program.value.title}>\n        <CourseProgramLessons program={program.value} courseId={Number(id)} />\n      </Layout>\n    );\n  }\n\n  return <Preloader />;\n};\n\nexport default CourseProgram;\n","import React from \"react\";\nimport { BreadCrumbs } from \"@escolalms/components/lib/components/atoms/BreadCrumbs/BreadCrumbs\";\nimport styled from \"styled-components\";\n\ntype Props = {\n  items: React.ReactNode[];\n};\n\nconst StyledBreadcrumbs = styled.div`\n  margin-bottom: 15px;\n  a {\n    text-decoration: none;\n    color: ${({ theme }) =>\n      theme.mode === \"dark\" ? theme.gray5 : theme.gray2}!important;\n  }\n`;\n\nconst Breadcrumbs: React.FC<Props> = ({ items }) => {\n  return (\n    <StyledBreadcrumbs>\n      <BreadCrumbs items={items} />\n    </StyledBreadcrumbs>\n  );\n};\n\nexport default Breadcrumbs;\n","import { useEffect } from \"react\";\nimport { Spin } from \"@escolalms/components/lib/components/atoms/Spin/Spin\";\nimport styled, { useTheme } from \"styled-components\";\n\nconst StyledLoader = styled.div`\n  position: fixed;\n  top: 0;\n  left: 0;\n  height: 100vh;\n  width: 100%;\n  z-index: 999;\n  display: flex;\n  justify-content: center;\n  align-items: center;\n  background-color: ${({ theme }) =>\n    theme.mode === \"dark\" ? theme.dm__background : theme.background};\n`;\n\nconst Preloader = () => {\n  const theme = useTheme();\n  useEffect(() => {\n    document.body.style.overflow = \"hidden\";\n\n    return () => {\n      document.body.style.overflow = \"inherit\";\n    };\n  }, []);\n\n  return (\n    <StyledLoader>\n      <Spin color={theme.primaryColor} />\n    </StyledLoader>\n  );\n};\n\nexport default Preloader;\n","import _typeof from \"./typeof.js\";\nexport default function _regeneratorRuntime() {\n  \"use strict\"; /*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/facebook/regenerator/blob/main/LICENSE */\n  _regeneratorRuntime = function _regeneratorRuntime() {\n    return exports;\n  };\n  var exports = {},\n    Op = Object.prototype,\n    hasOwn = Op.hasOwnProperty,\n    defineProperty = Object.defineProperty || function (obj, key, desc) {\n      obj[key] = desc.value;\n    },\n    $Symbol = \"function\" == typeof Symbol ? Symbol : {},\n    iteratorSymbol = $Symbol.iterator || \"@@iterator\",\n    asyncIteratorSymbol = $Symbol.asyncIterator || \"@@asyncIterator\",\n    toStringTagSymbol = $Symbol.toStringTag || \"@@toStringTag\";\n  function define(obj, key, value) {\n    return Object.defineProperty(obj, key, {\n      value: value,\n      enumerable: !0,\n      configurable: !0,\n      writable: !0\n    }), obj[key];\n  }\n  try {\n    define({}, \"\");\n  } catch (err) {\n    define = function define(obj, key, value) {\n      return obj[key] = value;\n    };\n  }\n  function wrap(innerFn, outerFn, self, tryLocsList) {\n    var protoGenerator = outerFn && outerFn.prototype instanceof Generator ? outerFn : Generator,\n      generator = Object.create(protoGenerator.prototype),\n      context = new Context(tryLocsList || []);\n    return defineProperty(generator, \"_invoke\", {\n      value: makeInvokeMethod(innerFn, self, context)\n    }), generator;\n  }\n  function tryCatch(fn, obj, arg) {\n    try {\n      return {\n        type: \"normal\",\n        arg: fn.call(obj, arg)\n      };\n    } catch (err) {\n      return {\n        type: \"throw\",\n        arg: err\n      };\n    }\n  }\n  exports.wrap = wrap;\n  var ContinueSentinel = {};\n  function Generator() {}\n  function GeneratorFunction() {}\n  function GeneratorFunctionPrototype() {}\n  var IteratorPrototype = {};\n  define(IteratorPrototype, iteratorSymbol, function () {\n    return this;\n  });\n  var getProto = Object.getPrototypeOf,\n    NativeIteratorPrototype = getProto && getProto(getProto(values([])));\n  NativeIteratorPrototype && NativeIteratorPrototype !== Op && hasOwn.call(NativeIteratorPrototype, iteratorSymbol) && (IteratorPrototype = NativeIteratorPrototype);\n  var Gp = GeneratorFunctionPrototype.prototype = Generator.prototype = Object.create(IteratorPrototype);\n  function defineIteratorMethods(prototype) {\n    [\"next\", \"throw\", \"return\"].forEach(function (method) {\n      define(prototype, method, function (arg) {\n        return this._invoke(method, arg);\n      });\n    });\n  }\n  function AsyncIterator(generator, PromiseImpl) {\n    function invoke(method, arg, resolve, reject) {\n      var record = tryCatch(generator[method], generator, arg);\n      if (\"throw\" !== record.type) {\n        var result = record.arg,\n          value = result.value;\n        return value && \"object\" == _typeof(value) && hasOwn.call(value, \"__await\") ? PromiseImpl.resolve(value.__await).then(function (value) {\n          invoke(\"next\", value, resolve, reject);\n        }, function (err) {\n          invoke(\"throw\", err, resolve, reject);\n        }) : PromiseImpl.resolve(value).then(function (unwrapped) {\n          result.value = unwrapped, resolve(result);\n        }, function (error) {\n          return invoke(\"throw\", error, resolve, reject);\n        });\n      }\n      reject(record.arg);\n    }\n    var previousPromise;\n    defineProperty(this, \"_invoke\", {\n      value: function value(method, arg) {\n        function callInvokeWithMethodAndArg() {\n          return new PromiseImpl(function (resolve, reject) {\n            invoke(method, arg, resolve, reject);\n          });\n        }\n        return previousPromise = previousPromise ? previousPromise.then(callInvokeWithMethodAndArg, callInvokeWithMethodAndArg) : callInvokeWithMethodAndArg();\n      }\n    });\n  }\n  function makeInvokeMethod(innerFn, self, context) {\n    var state = \"suspendedStart\";\n    return function (method, arg) {\n      if (\"executing\" === state) throw new Error(\"Generator is already running\");\n      if (\"completed\" === state) {\n        if (\"throw\" === method) throw arg;\n        return doneResult();\n      }\n      for (context.method = method, context.arg = arg;;) {\n        var delegate = context.delegate;\n        if (delegate) {\n          var delegateResult = maybeInvokeDelegate(delegate, context);\n          if (delegateResult) {\n            if (delegateResult === ContinueSentinel) continue;\n            return delegateResult;\n          }\n        }\n        if (\"next\" === context.method) context.sent = context._sent = context.arg;else if (\"throw\" === context.method) {\n          if (\"suspendedStart\" === state) throw state = \"completed\", context.arg;\n          context.dispatchException(context.arg);\n        } else \"return\" === context.method && context.abrupt(\"return\", context.arg);\n        state = \"executing\";\n        var record = tryCatch(innerFn, self, context);\n        if (\"normal\" === record.type) {\n          if (state = context.done ? \"completed\" : \"suspendedYield\", record.arg === ContinueSentinel) continue;\n          return {\n            value: record.arg,\n            done: context.done\n          };\n        }\n        \"throw\" === record.type && (state = \"completed\", context.method = \"throw\", context.arg = record.arg);\n      }\n    };\n  }\n  function maybeInvokeDelegate(delegate, context) {\n    var methodName = context.method,\n      method = delegate.iterator[methodName];\n    if (undefined === method) return context.delegate = null, \"throw\" === methodName && delegate.iterator[\"return\"] && (context.method = \"return\", context.arg = undefined, maybeInvokeDelegate(delegate, context), \"throw\" === context.method) || \"return\" !== methodName && (context.method = \"throw\", context.arg = new TypeError(\"The iterator does not provide a '\" + methodName + \"' method\")), ContinueSentinel;\n    var record = tryCatch(method, delegate.iterator, context.arg);\n    if (\"throw\" === record.type) return context.method = \"throw\", context.arg = record.arg, context.delegate = null, ContinueSentinel;\n    var info = record.arg;\n    return info ? info.done ? (context[delegate.resultName] = info.value, context.next = delegate.nextLoc, \"return\" !== context.method && (context.method = \"next\", context.arg = undefined), context.delegate = null, ContinueSentinel) : info : (context.method = \"throw\", context.arg = new TypeError(\"iterator result is not an object\"), context.delegate = null, ContinueSentinel);\n  }\n  function pushTryEntry(locs) {\n    var entry = {\n      tryLoc: locs[0]\n    };\n    1 in locs && (entry.catchLoc = locs[1]), 2 in locs && (entry.finallyLoc = locs[2], entry.afterLoc = locs[3]), this.tryEntries.push(entry);\n  }\n  function resetTryEntry(entry) {\n    var record = entry.completion || {};\n    record.type = \"normal\", delete record.arg, entry.completion = record;\n  }\n  function Context(tryLocsList) {\n    this.tryEntries = [{\n      tryLoc: \"root\"\n    }], tryLocsList.forEach(pushTryEntry, this), this.reset(!0);\n  }\n  function values(iterable) {\n    if (iterable) {\n      var iteratorMethod = iterable[iteratorSymbol];\n      if (iteratorMethod) return iteratorMethod.call(iterable);\n      if (\"function\" == typeof iterable.next) return iterable;\n      if (!isNaN(iterable.length)) {\n        var i = -1,\n          next = function next() {\n            for (; ++i < iterable.length;) if (hasOwn.call(iterable, i)) return next.value = iterable[i], next.done = !1, next;\n            return next.value = undefined, next.done = !0, next;\n          };\n        return next.next = next;\n      }\n    }\n    return {\n      next: doneResult\n    };\n  }\n  function doneResult() {\n    return {\n      value: undefined,\n      done: !0\n    };\n  }\n  return GeneratorFunction.prototype = GeneratorFunctionPrototype, defineProperty(Gp, \"constructor\", {\n    value: GeneratorFunctionPrototype,\n    configurable: !0\n  }), defineProperty(GeneratorFunctionPrototype, \"constructor\", {\n    value: GeneratorFunction,\n    configurable: !0\n  }), GeneratorFunction.displayName = define(GeneratorFunctionPrototype, toStringTagSymbol, \"GeneratorFunction\"), exports.isGeneratorFunction = function (genFun) {\n    var ctor = \"function\" == typeof genFun && genFun.constructor;\n    return !!ctor && (ctor === GeneratorFunction || \"GeneratorFunction\" === (ctor.displayName || ctor.name));\n  }, exports.mark = function (genFun) {\n    return Object.setPrototypeOf ? Object.setPrototypeOf(genFun, GeneratorFunctionPrototype) : (genFun.__proto__ = GeneratorFunctionPrototype, define(genFun, toStringTagSymbol, \"GeneratorFunction\")), genFun.prototype = Object.create(Gp), genFun;\n  }, exports.awrap = function (arg) {\n    return {\n      __await: arg\n    };\n  }, defineIteratorMethods(AsyncIterator.prototype), define(AsyncIterator.prototype, asyncIteratorSymbol, function () {\n    return this;\n  }), exports.AsyncIterator = AsyncIterator, exports.async = function (innerFn, outerFn, self, tryLocsList, PromiseImpl) {\n    void 0 === PromiseImpl && (PromiseImpl = Promise);\n    var iter = new AsyncIterator(wrap(innerFn, outerFn, self, tryLocsList), PromiseImpl);\n    return exports.isGeneratorFunction(outerFn) ? iter : iter.next().then(function (result) {\n      return result.done ? result.value : iter.next();\n    });\n  }, defineIteratorMethods(Gp), define(Gp, toStringTagSymbol, \"Generator\"), define(Gp, iteratorSymbol, function () {\n    return this;\n  }), define(Gp, \"toString\", function () {\n    return \"[object Generator]\";\n  }), exports.keys = function (val) {\n    var object = Object(val),\n      keys = [];\n    for (var key in object) keys.push(key);\n    return keys.reverse(), function next() {\n      for (; keys.length;) {\n        var key = keys.pop();\n        if (key in object) return next.value = key, next.done = !1, next;\n      }\n      return next.done = !0, next;\n    };\n  }, exports.values = values, Context.prototype = {\n    constructor: Context,\n    reset: function reset(skipTempReset) {\n      if (this.prev = 0, this.next = 0, this.sent = this._sent = undefined, this.done = !1, this.delegate = null, this.method = \"next\", this.arg = undefined, this.tryEntries.forEach(resetTryEntry), !skipTempReset) for (var name in this) \"t\" === name.charAt(0) && hasOwn.call(this, name) && !isNaN(+name.slice(1)) && (this[name] = undefined);\n    },\n    stop: function stop() {\n      this.done = !0;\n      var rootRecord = this.tryEntries[0].completion;\n      if (\"throw\" === rootRecord.type) throw rootRecord.arg;\n      return this.rval;\n    },\n    dispatchException: function dispatchException(exception) {\n      if (this.done) throw exception;\n      var context = this;\n      function handle(loc, caught) {\n        return record.type = \"throw\", record.arg = exception, context.next = loc, caught && (context.method = \"next\", context.arg = undefined), !!caught;\n      }\n      for (var i = this.tryEntries.length - 1; i >= 0; --i) {\n        var entry = this.tryEntries[i],\n          record = entry.completion;\n        if (\"root\" === entry.tryLoc) return handle(\"end\");\n        if (entry.tryLoc <= this.prev) {\n          var hasCatch = hasOwn.call(entry, \"catchLoc\"),\n            hasFinally = hasOwn.call(entry, \"finallyLoc\");\n          if (hasCatch && hasFinally) {\n            if (this.prev < entry.catchLoc) return handle(entry.catchLoc, !0);\n            if (this.prev < entry.finallyLoc) return handle(entry.finallyLoc);\n          } else if (hasCatch) {\n            if (this.prev < entry.catchLoc) return handle(entry.catchLoc, !0);\n          } else {\n            if (!hasFinally) throw new Error(\"try statement without catch or finally\");\n            if (this.prev < entry.finallyLoc) return handle(entry.finallyLoc);\n          }\n        }\n      }\n    },\n    abrupt: function abrupt(type, arg) {\n      for (var i = this.tryEntries.length - 1; i >= 0; --i) {\n        var entry = this.tryEntries[i];\n        if (entry.tryLoc <= this.prev && hasOwn.call(entry, \"finallyLoc\") && this.prev < entry.finallyLoc) {\n          var finallyEntry = entry;\n          break;\n        }\n      }\n      finallyEntry && (\"break\" === type || \"continue\" === type) && finallyEntry.tryLoc <= arg && arg <= finallyEntry.finallyLoc && (finallyEntry = null);\n      var record = finallyEntry ? finallyEntry.completion : {};\n      return record.type = type, record.arg = arg, finallyEntry ? (this.method = \"next\", this.next = finallyEntry.finallyLoc, ContinueSentinel) : this.complete(record);\n    },\n    complete: function complete(record, afterLoc) {\n      if (\"throw\" === record.type) throw record.arg;\n      return \"break\" === record.type || \"continue\" === record.type ? this.next = record.arg : \"return\" === record.type ? (this.rval = this.arg = record.arg, this.method = \"return\", this.next = \"end\") : \"normal\" === record.type && afterLoc && (this.next = afterLoc), ContinueSentinel;\n    },\n    finish: function finish(finallyLoc) {\n      for (var i = this.tryEntries.length - 1; i >= 0; --i) {\n        var entry = this.tryEntries[i];\n        if (entry.finallyLoc === finallyLoc) return this.complete(entry.completion, entry.afterLoc), resetTryEntry(entry), ContinueSentinel;\n      }\n    },\n    \"catch\": function _catch(tryLoc) {\n      for (var i = this.tryEntries.length - 1; i >= 0; --i) {\n        var entry = this.tryEntries[i];\n        if (entry.tryLoc === tryLoc) {\n          var record = entry.completion;\n          if (\"throw\" === record.type) {\n            var thrown = record.arg;\n            resetTryEntry(entry);\n          }\n          return thrown;\n        }\n      }\n      throw new Error(\"illegal catch attempt\");\n    },\n    delegateYield: function delegateYield(iterable, resultName, nextLoc) {\n      return this.delegate = {\n        iterator: values(iterable),\n        resultName: resultName,\n        nextLoc: nextLoc\n      }, \"next\" === this.method && (this.arg = undefined), ContinueSentinel;\n    }\n  }, exports;\n}","function asyncGeneratorStep(gen, resolve, reject, _next, _throw, key, arg) {\n  try {\n    var info = gen[key](arg);\n    var value = info.value;\n  } catch (error) {\n    reject(error);\n    return;\n  }\n  if (info.done) {\n    resolve(value);\n  } else {\n    Promise.resolve(value).then(_next, _throw);\n  }\n}\nexport default function _asyncToGenerator(fn) {\n  return function () {\n    var self = this,\n      args = arguments;\n    return new Promise(function (resolve, reject) {\n      var gen = fn.apply(self, args);\n      function _next(value) {\n        asyncGeneratorStep(gen, resolve, reject, _next, _throw, \"next\", value);\n      }\n      function _throw(err) {\n        asyncGeneratorStep(gen, resolve, reject, _next, _throw, \"throw\", err);\n      }\n      _next(undefined);\n    });\n  };\n}","import { API } from \"@escolalms/sdk/lib\";\nimport { EscolaLMSContext } from \"@escolalms/sdk/lib/react\";\nimport { useCallback, useContext, useMemo, useState } from \"react\";\nimport { useHistory, useParams } from \"react-router-dom\";\n\nexport function useLessonProgram(\n  program: API.CourseProgram,\n  courseRouteName: string = \"/course/\"\n) {\n  const { sendProgress, getNextPrevTopic, progress } =\n    useContext(EscolaLMSContext);\n  const [isNextTopicButtonDisabled, disableNextTopicButton] = useState(false);\n  const { lessonID, topicID } =\n    useParams<{ lessonID: string; topicID: string }>();\n  const { push } = useHistory();\n\n  const lessonId = lessonID ? lessonID : program.lessons[0].id;\n  const topicId = topicID\n    ? topicID\n    : (program &&\n        program.lessons &&\n        program.lessons[0] &&\n        program.lessons[0].topics &&\n        program?.lessons[0]?.topics[0]?.id) ||\n      0;\n\n  const lesson: API.Lesson | undefined = useMemo(\n    () => program.lessons.find((lesson) => lesson.id === Number(lessonId)),\n    [program, lessonId]\n  );\n\n  const topic: API.Topic | undefined = useMemo(\n    () =>\n      lesson &&\n      lesson.topics &&\n      lesson.topics.find((topic) => topic.id === Number(topicId)),\n    [lesson, topicId]\n  );\n\n  const onNextTopic = useCallback(() => {\n    program.id &&\n      sendProgress(program.id, [{ topic_id: Number(topicId), status: 1 }]).then(\n        () => {\n          const nextTopic = getNextPrevTopic(Number(topicId));\n\n          nextTopic &&\n            push(\n              `${courseRouteName}${program.id}/${nextTopic.lesson_id}/${nextTopic.id}`,\n              null\n            );\n        }\n      );\n  }, [topicId, program, push, getNextPrevTopic, sendProgress, courseRouteName]);\n  const onPrevTopic = useCallback(() => {\n    program.id &&\n      sendProgress(program.id, [{ topic_id: Number(topicId), status: 1 }]).then(\n        () => {\n          const prevTopic = getNextPrevTopic(Number(topicId), false);\n\n          prevTopic &&\n            push(\n              `${courseRouteName}${program.id}/${prevTopic.lesson_id}/${prevTopic.id}`,\n              null\n            );\n        }\n      );\n  }, [topicId, program, push, getNextPrevTopic, sendProgress, courseRouteName]);\n\n  const onNextTopicPreview = useCallback(\n    (next = true) => {\n      const nextTopic = getNextPrevTopic(Number(topicId), next);\n\n      nextTopic &&\n        push(\n          `${courseRouteName}${program.id}/${nextTopic?.lesson_id}/${nextTopic?.id}`\n        );\n    },\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n    [lessonId, topicId, program, program.id, push, courseRouteName]\n  );\n\n  return {\n    topic,\n    lesson,\n    onNextTopic,\n    onPrevTopic,\n    getNextPrevTopic,\n    isNextTopicButtonDisabled,\n    disableNextTopicButton,\n    onNextTopicPreview,\n    sendProgress,\n    progress,\n  } as const;\n}\n","import React, { useCallback, useContext, useState, useMemo } from \"react\";\nimport { API } from \"@escolalms/sdk/lib\";\nimport { CourseAgenda } from \"@escolalms/components/lib/components/organisms/CourseAgenda/CourseAgenda\";\nimport { EscolaLMSContext } from \"@escolalms/sdk/lib/react\";\nimport { useHistory } from \"react-router-dom\";\nimport { isMobile } from \"react-device-detect\";\nimport styled, { css } from \"styled-components\";\nimport { useLessonProgram } from \"../../../hooks/useLessonProgram\";\nimport { Button } from \"@escolalms/components\";\nimport { t } from \"i18next\";\nimport { Topic } from \"@escolalms/sdk/lib/types/api\";\n\nconst StyledSidebar = styled.aside`\n  padding-bottom: 100px;\n  .show-agenda-btn {\n    width: 100%;\n  }\n  .agenda-wrapper {\n    ${isMobile &&\n    css`\n      position: fixed;\n      top: 0;\n      left: 0;\n      width: 100%;\n      height: 100vh;\n      transform: translate(100%, 0);\n      transition: transform 0.25s;\n      overflow: scroll;\n      padding: 40px 0 55px;\n      z-index: 10;\n      background-color: ${({ theme }) =>\n        theme.mode === \"dark\" ? theme.dm__background : theme.background};\n\n      &--visible {\n        transform: translate(0, 0);\n      }\n\n      .hide-agenda-btn {\n        display: block;\n        margin: 0 15px 0 auto;\n      }\n    `}\n  }\n`;\n\nexport const CourseSidebar: React.FC<{\n  course: API.CourseProgram;\n  lessonId: number;\n  topicId: number;\n}> = ({ course, lessonId, topicId }) => {\n  const { disableNextTopicButton, sendProgress, progress } =\n    useLessonProgram(course);\n  const { courseProgressDetails } = useContext(EscolaLMSContext);\n\n  const history = useHistory();\n  const [agendaVisible, setAgendaVisible] = useState(false);\n  const program = (course?.lessons || []).filter(\n    (lesson) => lesson && lesson.topics && lesson?.topics?.length > 0\n  ) as API.Lesson[];\n  const { topicIsFinished } = useContext(EscolaLMSContext);\n  const allTopics = course.lessons.map((item) => item.topics);\n  //@ts-ignore\n  const arrayOfTopics = [].concat.apply([], allTopics);\n\n  const onCompleteTopic = useCallback((): void => {\n    disableNextTopicButton && disableNextTopicButton(false);\n    if (course?.id) {\n      sendProgress(course?.id, [{ topic_id: Number(topicId), status: 1 }]);\n    }\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [program, topicId, disableNextTopicButton, sendProgress]);\n\n  const getCourseProgress = useMemo(() => {\n    const courseId = course.id;\n    if (\n      courseProgressDetails &&\n      courseProgressDetails.byId &&\n      courseProgressDetails.byId[Number(courseId)] &&\n      courseProgressDetails.byId[Number(courseId)].value\n    ) {\n      return courseProgressDetails.byId[Number(courseId)].value;\n    }\n    return (\n      progress &&\n      progress.value &&\n      progress.value.find(\n        (courseProgress: API.CourseProgressItem) =>\n          courseProgress.course.id === Number(courseId)\n      )?.progress\n    );\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [progress, course]);\n\n  const finishedTopics = arrayOfTopics\n    .filter((item: API.Topic) => {\n      return (\n        topicIsFinished(item.id) ||\n        getCourseProgress?.some(\n          (progressItem) =>\n            progressItem.topic_id === item.id && progressItem.status === 1\n        )\n      );\n    })\n    .map((item: API.Topic) => item.id);\n\n  if (!course && !program) {\n    return <React.Fragment />;\n  }\n  return (\n    <StyledSidebar>\n      {isMobile && (\n        <Button\n          mode=\"outline\"\n          className=\"show-agenda-btn\"\n          onClick={() => setAgendaVisible(true)}\n        >\n          {t(\"CourseProgram.ShowAgenda\")}\n        </Button>\n      )}\n      <div\n        className={`${\n          agendaVisible\n            ? \"agenda-wrapper agenda-wrapper--visible\"\n            : \"agenda-wrapper\"\n        }`}\n      >\n        {isMobile && (\n          <Button\n            className=\"hide-agenda-btn\"\n            mode=\"secondary\"\n            onClick={() => setAgendaVisible(false)}\n          >\n            &#10005;\n          </Button>\n        )}\n        <CourseAgenda\n          onNextTopicClick={() => {\n            let nextTopic;\n\n            course.lessons.forEach((lesson, lIndex, lessons) => {\n              lesson.topics &&\n                lesson.topics.forEach((topic, tIndex) => {\n                  if (topic.id === topicId) {\n                    // try find next topic in current lesson\n                    if (lesson.topics && lesson.topics[tIndex + 1]) {\n                      nextTopic =\n                        lesson.topics[tIndex + 1] && lesson.topics[tIndex + 1];\n                      // try find first topic in next lesson\n                    } else if (lessons[lIndex + 1]) {\n                      nextTopic =\n                        lessons[lIndex + 1].topics &&\n                        //@ts-ignore\n                        lessons[lIndex + 1].topics[0];\n                      // otherwise this is end so going back to first lesson and topic\n                    } else {\n                      nextTopic = lessons[0].topics && lessons[0].topics[0];\n                    }\n                  }\n                });\n            });\n\n            if (nextTopic) {\n              history.push(\n                `/course/${course.id}/${(nextTopic as Topic).lesson_id}/${\n                  (nextTopic as Topic).id\n                }`\n              );\n              setAgendaVisible(false);\n            }\n          }}\n          mobile={isMobile}\n          lessons={course.lessons}\n          currentTopicId={topicId}\n          finishedTopicIds={finishedTopics}\n          onMarkFinished={() => onCompleteTopic()}\n          onTopicClick={(topic) => {\n            history.push(`/course/${course.id}/${topic.lesson_id}/${topic.id}`);\n            setAgendaVisible(false);\n          }}\n        />\n      </div>\n    </StyledSidebar>\n  );\n};\n\nexport default CourseSidebar;\n","import { MarkdownRenderer } from \"@escolalms/components/lib/components/molecules/MarkdownRenderer/MarkdownRenderer\";\nimport React, { ReactElement, FunctionComponent, useEffect } from \"react\";\nimport { Link } from \"@escolalms/components/lib/components/atoms/Link/Link\";\n\nconst fontSizes = [\"small\", \"regular\", \"bigger\", \"big\"];\n\nconst TextPlayer: FunctionComponent<{\n  value?: string;\n  onLoad?: () => void;\n  fontSize: number;\n}> = ({ value, onLoad, fontSize }): ReactElement => {\n  useEffect(() => {\n    value && onLoad && onLoad();\n  }, [value, onLoad]);\n\n  return (\n    <div\n      className={`center-image-richtext typebase size-${fontSizes[fontSize]}`}\n    >\n      {value && (\n        <MarkdownRenderer\n          components={{\n            a: (props) => <Link {...props} underline />,\n          }}\n        >\n          {value}\n        </MarkdownRenderer>\n      )}\n    </div>\n  );\n};\n\nexport default TextPlayer;\n","import React, {\n  ReactElement,\n  FunctionComponent,\n  useContext,\n  useState,\n} from \"react\";\nimport { Button } from \"@escolalms/components/lib/components/atoms/Button/Button\";\nimport { API } from \"@escolalms/sdk/lib\";\nimport { EscolaLMSContext } from \"@escolalms/sdk/lib/react\";\nimport styled, { css } from \"styled-components\";\nimport { useTranslation } from \"react-i18next\";\nimport { ResizeIcon } from \"../../../icons\";\n\nconst StyledDiv = styled.div<{ fullview: boolean }>`\n  > button {\n    position: fixed;\n    right: 5px;\n    bottom: 5px;\n    z-index: 9999;\n    svg path {\n      fill: white;\n    }\n  }\n  iframe {\n    border: none;\n    display: block;\n    width: 100%;\n  }\n  ${(props) => {\n    if (props.fullview) {\n      return css`\n        iframe {\n          position: fixed;\n          top: 90px;\n          left: 0;\n          height: calc(100% - 90px - 80px);\n\n          z-index: 9999;\n        }\n      `;\n    } else {\n      return css`\n        display: flex;\n\n        min-height: 80vh;\n        max-height: 80vh;\n        height: 100vh;\n        iframe {\n          height: 100%;\n        }\n      `;\n    }\n  }}\n`;\n\nconst ScormPlayer: FunctionComponent<{\n  value: API.TopicScorm;\n}> = ({ value }): ReactElement => {\n  const { apiUrl } = useContext(EscolaLMSContext);\n  const { t } = useTranslation();\n  const [fullView, setFullView] = useState(false);\n\n  return (\n    <div className=\"scorm-wrapper\">\n      <StyledDiv fullview={fullView}>\n        <Button onClick={() => setFullView(!fullView)}>\n          {\" \"}\n          {t(\"Scorm.Resize\")} <ResizeIcon />\n        </Button>\n        <iframe\n          title={value.title}\n          src={`${apiUrl}/api/scorm/play/${value.topicable?.uuid}`}\n        />\n      </StyledDiv>\n    </div>\n  );\n};\n\nexport default ScormPlayer;\n","import React, { useContext, useEffect, useMemo, useCallback } from \"react\";\nimport { EscolaLMSContext } from \"@escolalms/sdk/lib/react/context\";\nimport { TopicType } from \"@escolalms/sdk/lib/services/courses\";\nimport { XAPIEvent } from \"@escolalms/h5p-react\";\nimport TextPlayer from \"./Players/TextPlayer\";\nimport { API } from \"@escolalms/sdk/lib\";\nimport { ImagePlayer } from \"@escolalms/components/lib/components/players/ImagePlayer/ImagePlayer\";\nimport { AudioVideoPlayer } from \"@escolalms/components/lib/components/players/AudioVideoPlayer/AudioVideoPlayer\";\nimport { OEmbedPlayer } from \"@escolalms/components/lib/components/players/OEmbedPlayer/OEmbedPlayer\";\nimport { H5Player } from \"@escolalms/components/lib/components/players/H5Player/H5Player\";\nimport { PdfPlayer } from \"@escolalms/components/lib/components/players/PdfPlayer/PdfPlayer\";\nimport { isMobile } from \"react-device-detect\";\nimport ScormPlayer from \"./Players/ScormPlayer\";\nimport styled from \"styled-components\";\n\nconst StyledPdfPlayer = styled(PdfPlayer)`\n  .course-pdf-player {\n    .react-pdf__Page__svg,\n    svg {\n      width: 100% !important;\n      height: auto !important;\n    }\n  }\n`;\n\nexport const CourseProgramContent: React.FC<{\n  lessonId: number;\n  isThereAnotherTopic?: boolean;\n  topicId?: number;\n  preview?: boolean;\n  customNoCompletedEventsIds?: string[];\n  disableNextTopicButton?: (b: boolean) => void;\n}> = ({\n  lessonId,\n  topicId,\n  preview = false,\n  disableNextTopicButton,\n  customNoCompletedEventsIds = [\n    \"http://h5p.org/libraries/H5P.GuessTheAnswer-1.5\",\n  ],\n  isThereAnotherTopic = true,\n}) => {\n  const {\n    program,\n    topicPing,\n    topicIsFinished,\n    fontSize,\n    sendProgress,\n    h5pProgress,\n  } = useContext(EscolaLMSContext);\n\n  const topic = useMemo(() => {\n    return program.value?.lessons\n      ?.find((lesson: API.Lesson) => lesson.id === lessonId)\n      ?.topics?.find((topic: API.Topic) => topic.id === topicId);\n  }, [program, lessonId, topicId]);\n\n  const onCompleteTopic = useCallback((): void => {\n    if (program?.value?.id) {\n      sendProgress(program?.value?.id, [\n        { topic_id: Number(topicId), status: 1 },\n      ]);\n    }\n  }, [program, topicId, sendProgress]);\n\n  const onXAPI = useCallback(\n    (event: XAPIEvent): void => {\n      isThereAnotherTopic &&\n        disableNextTopicButton &&\n        disableNextTopicButton(!Boolean(event?.statement?.verb?.id));\n\n      if (event?.statement) {\n        h5pProgress(\n          String(program?.value?.id),\n          Number(topicId),\n          event?.statement as API.IStatement\n        );\n      }\n    },\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n    [\n      program,\n      topicId,\n      h5pProgress,\n      disableNextTopicButton,\n      customNoCompletedEventsIds,\n    ]\n  );\n\n  useEffect(() => {\n    const isTopicFinished = topic?.id && topicIsFinished(topic.id);\n\n    isThereAnotherTopic &&\n      disableNextTopicButton &&\n      isTopicFinished &&\n      disableNextTopicButton(!isTopicFinished && !Boolean(topic?.can_skip));\n  }, [disableNextTopicButton, topic, isThereAnotherTopic, topicIsFinished]);\n\n  useEffect(() => {\n    if (!preview) {\n      const ping = () =>\n        topicId && !topicIsFinished(topicId) && topicPing(topicId);\n      const interval = setInterval(() => {\n        ping();\n      }, 5000);\n      ping();\n      return () => clearInterval(interval);\n    }\n  }, [topicPing, preview, topicId, topicIsFinished]);\n\n  if (!topic) {\n    return <React.Fragment />;\n  }\n\n  if (!topic.topicable?.value) {\n    return (\n      <pre className=\"error\">Error: topic.topicable?.value is missing</pre>\n    );\n  }\n  if (topic.topicable_type) {\n    // TODO: specific interface for advanced topic players -> example: ImagePlayer\n    switch (topic.topicable_type) {\n      case TopicType.H5P:\n        return (\n          <H5Player\n            onXAPI={(e: XAPIEvent) => onXAPI(e)}\n            //@ts-ignore\n            h5pObject={topic.topicable.content as API.H5PObject}\n          />\n        );\n      case TopicType.OEmbed:\n        return (\n          <>\n            <OEmbedPlayer url={topic.topicable.value} key={topicId} />\n          </>\n        );\n      case TopicType.RichText:\n        return <TextPlayer value={topic.topicable.value} fontSize={fontSize} />;\n      case TopicType.Video:\n        return (\n          <AudioVideoPlayer\n            mobile={isMobile}\n            url={topic.topicable.url}\n            light\n            onFinish={(): void => onCompleteTopic()}\n          />\n        );\n      case TopicType.Image:\n        return <ImagePlayer topic={topic} onLoad={() => onCompleteTopic()} />;\n\n      case TopicType.Audio:\n        return (\n          <AudioVideoPlayer\n            mobile={isMobile}\n            audio\n            url={topic.topicable.value}\n            light\n            onFinish={(): void => onCompleteTopic()}\n          />\n        );\n\n      case TopicType.Pdf:\n        return (\n          <StyledPdfPlayer\n            url={topic.topicable.url}\n            pageConfig={{\n              renderMode: \"svg\",\n              className: \"course-pdf-player\",\n            }}\n          />\n        );\n\n      case TopicType.Scorm:\n        return <ScormPlayer value={topic} />;\n      default:\n        return <pre>{topic.topicable_type}</pre>;\n    }\n  }\n\n  return <pre>loading... (or error)</pre>;\n};\n\nexport default CourseProgramContent;\n","\"use strict\";\nvar __createBinding = (this && this.__createBinding) || (Object.create ? (function(o, m, k, k2) {\n    if (k2 === undefined) k2 = k;\n    var desc = Object.getOwnPropertyDescriptor(m, k);\n    if (!desc || (\"get\" in desc ? !m.__esModule : desc.writable || desc.configurable)) {\n      desc = { enumerable: true, get: function() { return m[k]; } };\n    }\n    Object.defineProperty(o, k2, desc);\n}) : (function(o, m, k, k2) {\n    if (k2 === undefined) k2 = k;\n    o[k2] = m[k];\n}));\nvar __setModuleDefault = (this && this.__setModuleDefault) || (Object.create ? (function(o, v) {\n    Object.defineProperty(o, \"default\", { enumerable: true, value: v });\n}) : function(o, v) {\n    o[\"default\"] = v;\n});\nvar __importStar = (this && this.__importStar) || function (mod) {\n    if (mod && mod.__esModule) return mod;\n    var result = {};\n    if (mod != null) for (var k in mod) if (k !== \"default\" && Object.prototype.hasOwnProperty.call(mod, k)) __createBinding(result, mod, k);\n    __setModuleDefault(result, mod);\n    return result;\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.react = exports.API = void 0;\nvar API = __importStar(require(\"./types/api\"));\nexports.API = API;\nvar react = __importStar(require(\"./react\"));\nexports.react = react;\n"],"sourceRoot":""}