{"version":3,"sources":["pages/login/index.tsx"],"names":["StyledLoginPage","styled","div","_templateObject","_taggedTemplateLiteral","Login","_useLocation","useLocation","search","state","_useContext","useContext","EscolaLMSContext","user","socialAuthorize","_useState","useState","_useState2","_slicedToArray","view","setView","t","useTranslation","history","useHistory","token","split","referrer","setTimeout","push","loading","value","_jsx","Layout","metaTitle","children","Container","Row","justify","Col","md","LoginForm","onResetPasswordLink","onRegisterLink","mobile","isMobile","ResetPasswordForm","backToLogin","return_url","onFirstStepSuccess","toast","success","onFirstStepError","error"],"mappings":"wPAcMA,EAAkBC,UAAOC,IAAGC,MAAAC,YAAA,oHAgEnBC,UAzDD,WACZ,IAAAC,EAA0BC,cAAlBC,EAAMF,EAANE,OAAQC,EAAKH,EAALG,MAChBC,EAAkCC,qBAAWC,oBAArCC,EAAIH,EAAJG,KAAMC,EAAeJ,EAAfI,gBACdC,EAAwBC,mBAEtB,SAAQC,EAAAC,YAAAH,EAAA,GAFHI,EAAIF,EAAA,GAAEG,EAAOH,EAAA,GAGZI,EAAMC,cAAND,EACFE,EAAUC,cACVC,EAAQjB,EAAOkB,MAAM,WAAW,GAChCC,EACHlB,GAASA,EAAMkB,UAAanB,EAAOkB,MAAM,cAAc,IAAM,IAahE,OAXID,IACFX,EAAgBW,GAChBG,YAAW,WACTL,EAAQM,KAAKF,EACf,GAAG,MAGAd,EAAKiB,SAAYL,IAASZ,EAAKkB,OAClCR,EAAQM,KAAKF,GAIbK,cAACC,IAAM,CAACC,UAAWb,EAAE,oBAAoBc,SACvCH,cAAChC,EAAe,CAAAmC,SACdH,cAACI,IAAS,CAAAD,SACRH,cAACK,MAAG,CAACC,QAAS,SAASH,SACrBH,cAACO,MAAG,CAACC,GAAI,GAAGL,SACA,UAAThB,EACCa,cAACS,YAAS,CACRC,oBAAqB,kBAAMtB,EAAQ,iBAAiB,EACpDuB,eAAgB,kBAAMpB,EAAQM,KAAK,YAAY,EAC/Ce,OAAQC,aAGVb,cAACc,oBAAiB,CAChBF,OAAQC,WACRE,YAAa,kBAAM3B,EAAQ,QAAQ,EACnCuB,eAAgB,kBAAMpB,EAAQM,KAAK,YAAY,EAC/CmB,WAAW,mBACXC,mBAAoB,kBAClBC,IAAMC,QAAQ9B,EAAU,2BAA2B,EAErD+B,iBAAkB,kBAChBF,IAAMG,MAAMhC,EAAU,mBAAmB,aAU7D,C","file":"static/js/37.11d31ca7.chunk.js","sourcesContent":["import { useContext, useState } from \"react\";\nimport { EscolaLMSContext } from \"@escolalms/sdk/lib/react/context\";\nimport { useHistory } from \"react-router-dom\";\nimport Layout from \"@/components/_App/Layout\";\nimport { isMobile } from \"react-device-detect\";\nimport { useLocation } from \"react-router-dom\";\n\nimport { LoginForm, ResetPasswordForm } from \"@escolalms/components\";\nimport { toast } from \"react-toastify\";\nimport { useTranslation } from \"react-i18next\";\nimport styled from \"styled-components\";\nimport { Col, Row } from \"react-grid-system\";\nimport Container from \"@/components/Container\";\n\nconst StyledLoginPage = styled.div`\n  min-height: calc(100vh - 583px);\n  display: flex;\n  align-items: center;\n  justify-content: center;\n`;\n\nconst Login = () => {\n  const { search, state } = useLocation<{ referrer?: string }>();\n  const { user, socialAuthorize } = useContext(EscolaLMSContext);\n  const [view, setView] = useState<\n    \"login\" | \"forgotPassword\" | \"register\" | \"success\"\n  >(\"login\");\n  const { t } = useTranslation();\n  const history = useHistory();\n  const token = search.split(\"?token=\")[1];\n  const referrer =\n    (state && state.referrer) || search.split(\"?referrer=\")[1] || \"/\";\n\n  if (token) {\n    socialAuthorize(token);\n    setTimeout(() => {\n      history.push(referrer);\n    }, 1000);\n  }\n\n  if (!user.loading && !token && user.value) {\n    history.push(referrer);\n  }\n\n  return (\n    <Layout metaTitle={t(\"LoginAndRegister\")}>\n      <StyledLoginPage>\n        <Container>\n          <Row justify={\"center\"}>\n            <Col md={12}>\n              {view === \"login\" ? (\n                <LoginForm\n                  onResetPasswordLink={() => setView(\"forgotPassword\")}\n                  onRegisterLink={() => history.push(\"/register\")}\n                  mobile={isMobile}\n                />\n              ) : (\n                <ResetPasswordForm\n                  mobile={isMobile}\n                  backToLogin={() => setView(\"login\")}\n                  onRegisterLink={() => history.push(\"/register\")}\n                  return_url=\"#/reset-password\"\n                  onFirstStepSuccess={() =>\n                    toast.success(t<string>(\"LoginPage.ForgotSuccess\"))\n                  }\n                  onFirstStepError={() =>\n                    toast.error(t<string>(\"UnexpectedError\"))\n                  }\n                />\n              )}\n            </Col>\n          </Row>\n        </Container>\n      </StyledLoginPage>\n    </Layout>\n  );\n};\n\nexport default Login;\n"],"sourceRoot":""}