(this["webpackJsonpescolalms-demo"]=this["webpackJsonpescolalms-demo"]||[]).push([[13],{419:function(e,n,t){"use strict";t.r(n);var o=t(79),i=t(0),c=t.n(i),r=t(10),s=t(16),l=t(65),a=t(23),d=t(464),u=t(159),b=t(6),v=t(540),j=t(519),p=t(478),m=t(136),f=t(1),O=function(e){var n,t=e.program,o=Object(p.a)(t,"/courses/preview/"),r=o.topic,s=o.lesson,a=o.onNextTopicPreview,d=Object(l.a)().t;return Object(i.useEffect)((function(){window.scrollTo({top:0,behavior:"smooth"})}),[null===r||void 0===r?void 0:r.id,null===s||void 0===s?void 0:s.id]),Object(f.jsx)(c.a.Fragment,{children:Object(f.jsx)("div",{className:"container-fluid course-program course-program-page",children:Object(f.jsx)("div",{className:"course-program-container",children:Object(f.jsxs)("div",{className:"course-program-wrapper course-program-wrapper-preview",children:[Object(f.jsxs)("div",{className:"course-program-player",children:[Object(f.jsxs)("div",{className:"course-program-player-content",children:[Object(f.jsx)("h2",{children:null===r||void 0===r?void 0:r.title}),r&&r.introduction&&Object(f.jsx)("div",{className:"col-lg-12 col-md-12 col-sm-12",children:Object(f.jsx)("div",{className:"container-md",children:Object(f.jsx)(m.MarkdownRenderer,{children:r.introduction})})}),Object(f.jsx)("div",{className:"course-program-player-content__wrapper",style:Object(b.a)({},(null===r||void 0===r||null===(n=r.json)||void 0===n?void 0:n.wrapperStyle)||{}),children:Object(f.jsx)(v.a,{preview:!0,lessonId:Number(null===s||void 0===s?void 0:s.id),topicId:Number(null===r||void 0===r?void 0:r.id)})})]}),Object(f.jsxs)("div",{className:"row",children:[s&&s.summary&&Object(f.jsx)("div",{className:"col-lg-12 col-md-12 col-sm-12",children:Object(f.jsx)("div",{className:"course-program-summary",children:Object(f.jsx)(m.MarkdownRenderer,{children:s.summary})})}),r&&r.summary&&Object(f.jsx)("div",{className:"col-lg-12 col-md-12 col-sm-12",children:Object(f.jsx)("div",{className:"course-program-summary",children:Object(f.jsx)(m.MarkdownRenderer,{children:r.summary})})})]}),Object(f.jsx)("div",{className:"course-program-player-next",children:Object(f.jsxs)("button",{className:"default-btn default-btn-equal",onClick:function(){return a()},children:[Object(f.jsxs)("div",{className:"course-program-player-next-button__wrapper",children:[d("Next Topic")," >"]}),Object(f.jsx)("span",{})]})})]}),Object(f.jsx)(j.a,{course:t,lessonId:Number(null===s||void 0===s?void 0:s.id),topicId:Number(null===r||void 0===r?void 0:r.id)})]})})})})},x=function(e){var n,t,r=e.program,s=null===r||void 0===r||null===(n=r.scorm)||void 0===n||null===(t=n.scos)||void 0===t?void 0:t.find((function(e){return void 0!==e.entry_url})),l=null===s||void 0===s?void 0:s.uuid,d=Object(i.useRef)(null),u=Object(i.useState)(0),b=Object(o.a)(u,2),v=b[0],j=b[1],p=Object(i.useContext)(a.EscolaLMSContext).apiUrl;return Object(i.useEffect)((function(){var e,n,t,o;d.current&&j((null===(e=d.current)||void 0===e||null===(n=e.contentWindow)||void 0===n||null===(t=n.document)||void 0===t||null===(o=t.body)||void 0===o?void 0:o.scrollHeight)||0)}),[d]),s||l?Object(f.jsx)(c.a.Fragment,{children:Object(f.jsx)("div",{className:"container-fluid course-program",children:Object(f.jsx)("div",{className:"course-program-player scorm",style:{height:"".concat(610+v,"px")},children:Object(f.jsx)("iframe",{title:"scorm-player",ref:d,src:"".concat(p,"/api/scorm/play/").concat(l),scrolling:"no"})})})}):Object(f.jsx)(c.a.Fragment,{})};n.default=function(){var e,n,t=Object(l.a)().t,o=Object(r.i)().id,c=Object(i.useContext)(a.EscolaLMSContext),b=c.program,v=c.fetchProgram;return Object(i.useEffect)((function(){o&&v(Number(o))}),[o,v]),b.loading?Object(f.jsx)(d.a,{}):b.error?Object(f.jsx)("div",{className:"container",children:Object(f.jsxs)("div",{className:"alert alert-danger",role:"alert",children:[Object(f.jsx)("h4",{className:"alert-heading",children:t("Error")}),Object(f.jsxs)("p",{children:[" ",b.error.message||b.error.error]}),Object(f.jsx)("hr",{}),Object(f.jsxs)("p",{className:"mb-0",children:[t("CoursePage.Preview.SeeOther"),Object(f.jsx)(s.c,{to:"/courses",children:t("Courses")}),"."]})]})}):b.value&&null!==b&&void 0!==b&&null!==(e=b.value)&&void 0!==e&&null!==(n=e.scorm)&&void 0!==n&&n.id?Object(f.jsx)(u.a,{children:Object(f.jsx)(x,{program:b.value})}):b.value&&b.value.lessons&&b.value.lessons.length?Object(f.jsxs)(u.a,{children:[Object(f.jsx)(O,{program:b.value}),";"]}):Object(f.jsx)(d.a,{})}},464:function(e,n,t){"use strict";var o,i=t(49),c=t(0),r=t(160),s=t(8),l=t(1),a=s.default.div(o||(o=Object(i.a)(["\n  position: fixed;\n  top: 0;\n  left: 0;\n  height: 100vh;\n  width: 100%;\n  z-index: 999;\n  display: flex;\n  justify-content: center;\n  align-items: center;\n  background-color: ",";\n"])),(function(e){var n=e.theme;return"dark"===n.mode?n.backgroundDark:n.backgroundLight}));n.a=function(){var e=Object(s.useTheme)();return Object(c.useEffect)((function(){return document.body.style.overflow="hidden",function(){document.body.style.overflow="inherit"}}),[]),Object(l.jsx)(a,{children:Object(l.jsx)(r.Spin,{color:e.primaryColor})})}},478:function(e,n,t){"use strict";t.d(n,"a",(function(){return s}));var o=t(79),i=t(57),c=t(0),r=t(10);function s(e){var n,t,s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"/course/",l=Object(c.useContext)(i.EscolaLMSContext),a=l.sendProgress,d=l.getNextPrevTopic,u=l.progress,b=Object(c.useState)(!1),v=Object(o.a)(b,2),j=v[0],p=v[1],m=Object(r.i)(),f=m.lessonID,O=m.topicID,x=Object(r.g)(),h=x.push,g=f||e.lessons[0].id,y=O||(e&&e.lessons&&e.lessons[0]&&e.lessons[0].topics&&(null===e||void 0===e||null===(n=e.lessons[0])||void 0===n||null===(t=n.topics[0])||void 0===t?void 0:t.id)||0),N=Object(c.useMemo)((function(){return e.lessons.find((function(e){return e.id===Number(g)}))}),[e,g]),w=Object(c.useMemo)((function(){return N&&N.topics&&N.topics.find((function(e){return e.id===Number(y)}))}),[N,y]),T=Object(c.useCallback)((function(){e.id&&a(e.id,[{topic_id:Number(y),status:1}]).then((function(){var n=d(Number(y));n&&h("".concat(s).concat(e.id,"/").concat(n.lesson_id,"/").concat(n.id),null)}))}),[y,e,h,d,a,s]),k=Object(c.useCallback)((function(){e.id&&a(e.id,[{topic_id:Number(y),status:1}]).then((function(){var n=d(Number(y),!1);n&&h("".concat(s).concat(e.id,"/").concat(n.lesson_id,"/").concat(n.id),null)}))}),[y,e,h,d,a,s]),P=Object(c.useCallback)((function(){var n=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],t=d(Number(y),n);t&&h("".concat(s).concat(e.id,"/").concat(null===t||void 0===t?void 0:t.lesson_id,"/").concat(null===t||void 0===t?void 0:t.id))}),[g,y,e,e.id,h,s]);return{topic:w,lesson:N,onNextTopic:T,onPrevTopic:k,getNextPrevTopic:d,isDisabledNextTopicButton:j,setIsDisabledNextTopicButton:p,onNextTopicPreview:P,sendProgress:a,progress:u}}},488:function(e,n){},512:function(e,n){},513:function(e,n){},514:function(e,n){},515:function(e,n){},516:function(e,n){},519:function(e,n,t){"use strict";var o,i,c=t(79),r=t(49),s=t(0),l=t.n(s),a=t(230),d=t(57),u=t(10),b=t(50),v=t(8),j=t(478),p=t(31),m=t(100),f=t(1),O=v.default.aside(o||(o=Object(r.a)(["\n  padding-bottom: 100px;\n  .show-agenda-btn {\n    width: 100%;\n  }\n  .agenda-wrapper {\n    ","\n  }\n"])),b.isMobile&&Object(v.css)(i||(i=Object(r.a)(["\n      position: fixed;\n      top: 0;\n      left: 0;\n      width: 100%;\n      height: 100vh;\n      transform: translate(100%, 0);\n      transition: transform 0.25s;\n      overflow: scroll;\n      padding: 40px 0 55px;\n      z-index: 10;\n      background-color: ",";\n\n      &--visible {\n        transform: translate(0, 0);\n      }\n\n      .hide-agenda-btn {\n        display: block;\n        margin: 0 15px 0 auto;\n      }\n    "])),(function(e){var n=e.theme;return"dark"===n.mode?n.backgroundDark:n.backgroundLight})));n.a=function(e){var n=e.course,t=(e.lessonId,e.topicId),o=Object(j.a)(n),i=o.setIsDisabledNextTopicButton,r=o.sendProgress,v=Object(u.g)(),x=Object(s.useState)(!1),h=Object(c.a)(x,2),g=h[0],y=h[1],N=((null===n||void 0===n?void 0:n.lessons)||[]).filter((function(e){var n;return e&&e.topics&&(null===e||void 0===e||null===(n=e.topics)||void 0===n?void 0:n.length)>0})),w=Object(s.useContext)(d.EscolaLMSContext).topicIsFinished,T=n.lessons.map((function(e){return e.topics})),k=[].concat.apply([],T).filter((function(e){return w(e.id)})).map((function(e){return e.id})),P=Object(s.useCallback)((function(){i&&i(!1),null!==n&&void 0!==n&&n.id&&r(null===n||void 0===n?void 0:n.id,[{topic_id:Number(t),status:1}])}),[N,t,i,r]);return n||N?Object(f.jsxs)(O,{children:[b.isMobile&&Object(f.jsx)(p.Button,{mode:"outline",className:"show-agenda-btn",onClick:function(){return y(!0)},children:Object(m.t)("CourseProgram.ShowAgenda")}),Object(f.jsxs)("div",{className:"".concat(g?"agenda-wrapper agenda-wrapper--visible":"agenda-wrapper"),children:[b.isMobile&&Object(f.jsx)(p.Button,{className:"hide-agenda-btn",mode:"secondary",onClick:function(){return y(!1)},children:"\u2715"}),Object(f.jsx)(a.CourseAgenda,{mobile:b.isMobile,lessons:n.lessons,currentTopicId:t,finishedTopicIds:k,onMarkFinished:function(){return P()},onTopicClick:function(e){v.push("/course/".concat(n.id,"/").concat(e.lesson_id,"/").concat(e.id)),y(!1)}})]})]}):Object(f.jsx)(l.a.Fragment,{})}},540:function(e,n,t){"use strict";var o=t(17),i=t(0),c=t.n(i),r=t(23),s=t(111),l=t(136),a=t(1),d=["small","regular","bigger","big"],u=function(e){var n=e.value,t=e.onLoad,o=e.fontSize;return Object(i.useEffect)((function(){n&&t&&t()}),[n,t]),Object(a.jsx)("div",{className:"center-image-richtext typebase size-".concat(d[o]),children:n&&Object(a.jsx)(l.MarkdownRenderer,{children:n})})},b=t(517),v=t(510),j=t(508),p=t(518),m=t(511),f=t(50);n.a=function(e){var n,t,l,d=e.lessonId,O=e.topicId,x=e.preview,h=void 0!==x&&x,g=e.setIsDisabledNextTopicButton,y=e.customNoCompletedEventsIds,N=void 0===y?["http://h5p.org/libraries/H5P.GuessTheAnswer-1.5"]:y,w=Object(i.useContext)(r.EscolaLMSContext),T=w.program,k=w.topicPing,P=w.topicIsFinished,C=w.fontSize,I=w.sendProgress,E=w.h5pProgress,M=w.apiUrl,_=Object(i.useMemo)((function(){var e,n,t,o;return null===(e=T.value)||void 0===e||null===(n=e.lessons)||void 0===n||null===(t=n.find((function(e){return e.id===d})))||void 0===t||null===(o=t.topics)||void 0===o?void 0:o.find((function(e){return e.id===O}))}),[T,d,O]);Object(i.useEffect)((function(){g&&g(!1),(null===_||void 0===_?void 0:_.topicable_type)!==s.TopicType.Video&&(null===_||void 0===_?void 0:_.topicable_type)!==s.TopicType.Audio||g&&g(!0)}),[O,d,T,null===_||void 0===_?void 0:_.topicable_type,g]);var S=Object(i.useCallback)((function(){var e,n;(g&&g(!1),null!==T&&void 0!==T&&null!==(e=T.value)&&void 0!==e&&e.id)&&I(null===T||void 0===T||null===(n=T.value)||void 0===n?void 0:n.id,[{topic_id:Number(O),status:1}])}),[T,O,g,I]),F=Object(i.useCallback)((function(e){var n,t,i,c,r,l,a,d,u,b,v,j;(g&&g(!0),null!==e&&void 0!==e&&e.statement)&&((null!==e&&void 0!==e&&null!==(n=e.statement)&&void 0!==n&&null!==(t=n.verb)&&void 0!==t&&t.id&&s.completed.includes(null===e||void 0===e||null===(i=e.statement)||void 0===i||null===(c=i.verb)||void 0===c?void 0:c.id)||[].concat(Object(o.a)(s.noCompletedEventsIds),Object(o.a)(N)).includes((null===e||void 0===e||null===(r=e.statement)||void 0===r||null===(l=r.context)||void 0===l||null===(a=l.contextActivities)||void 0===a?void 0:a.category)&&(null===e||void 0===e||null===(d=e.statement)||void 0===d||null===(u=d.context)||void 0===u||null===(b=u.contextActivities)||void 0===b||null===(v=b.category[0])||void 0===v?void 0:v.id)))&&g&&g(!1),E(String(null===T||void 0===T||null===(j=T.value)||void 0===j?void 0:j.id),Number(O),null===e||void 0===e?void 0:e.statement))}),[T,O,E,g,N]);if(Object(i.useEffect)((function(){if(!h){var e=function(){return O&&!P(O)&&k(O)},n=setInterval((function(){e()}),5e3);return e(),function(){return clearInterval(n)}}}),[k,h,O,P]),!_)return Object(a.jsx)(c.a.Fragment,{});if(null===(n=_.topicable)||void 0===n||!n.value)return Object(a.jsx)("pre",{className:"error",children:"Error: topic.topicable?.value is missing"});if(_.topicable_type)switch(_.topicable_type){case s.TopicType.H5P:return Object(a.jsx)(p.H5Player,{onXAPI:function(e){return F(e)},id:null===_||void 0===_||null===(t=_.topicable)||void 0===t?void 0:t.value});case s.TopicType.OEmbed:return Object(a.jsx)(a.Fragment,{children:Object(a.jsx)(j.OEmbedPlayer,{url:_.topicable.value,FallbackElement:Object(a.jsx)(p.H5Player,{onXAPI:function(e){return F(e)},id:null===_||void 0===_||null===(l=_.topicable)||void 0===l?void 0:l.value})},O)});case s.TopicType.RichText:return Object(a.jsx)(u,{value:_.topicable.value,fontSize:C});case s.TopicType.Video:return Object(a.jsx)(v.AudioVideoPlayer,{mobile:f.isMobile,url:_.topicable.url,light:!0,onFinish:function(){return S()}});case s.TopicType.Image:return Object(a.jsx)(b.ImagePlayer,{topic:_,onLoad:function(){return S()}});case s.TopicType.Audio:return Object(a.jsx)(v.AudioVideoPlayer,{mobile:f.isMobile,audio:!0,url:_.topicable.value,light:!0,onFinish:function(){return S()}});case s.TopicType.Pdf:return Object(a.jsx)(m.PdfPlayer,{url:_.topicable.url});case s.TopicType.Scorm:return Object(a.jsx)("div",{className:"scorm-wrapper",children:Object(a.jsx)("iframe",{title:_.topicable.value,src:"".concat(M,"/api/scorm/play/").concat(_.topicable.uuid)})});default:return Object(a.jsx)("pre",{children:_.topicable_type})}return Object(a.jsx)("pre",{children:"loading... (or error)"})}}}]);
//# sourceMappingURL=13.59f63464.chunk.js.map