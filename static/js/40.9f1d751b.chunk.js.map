{"version":3,"sources":["hooks/useCourseProgram.ts","components/Errorbox/index.tsx","components/Course/CourseProgramLessonsStyles.tsx","components/Course/CourseFinishModal/index.tsx","components/Course/CourseDownloads/index.tsx","components/Course/CourseProgramPlayer/index.tsx","components/Course/CourseProgramLessons.tsx","hooks/useBookmarkNotes.ts","hooks/useCourseBreakPoint.ts","pages/course/index.tsx","components/Breadcrumbs/index.tsx","types/questionnaire.ts","utils/questionnaires.ts","components/QuestionBox/index.tsx","components/RateCourse/index.tsx"],"names":["noCompletedEventsIds","isXAPIEventAllowed","event","_statement$context","_statement$context$co","_statement$context$co2","statement","eventContextCategoriesIds","context","contextActivities","category","map","_ref","id","some","value","includes","StyledErrorPage","styled","div","_templateObject","_taggedTemplateLiteral","ErrorBox","error","goTo","routeRoutes","courses","goToText","alternativeButton","t","useTranslation","history","useHistory","buttonText","_jsx","Layout","children","_jsxs","Text","size","className","Button","mode","onClick","push","StyledCourse","section","CourseFinishModal","courseId","state","setState","useState","show","step","loading","questionnaires","setQuestionnaires","fetchQuestionnaires","fetchQuestionnaire","useContext","EscolaLMSContext","handleClose","useCallback","prevState","length","timer","setTimeout","clearTimeout","useEffect","getQuestionnaires","onSucces","items","onFinish","_Fragment","Spin","myProfile","RateCourse","course","QuestionnaireModelType","COURSE","visible","onClose","questionnaire","StyledDownloads","CourseDownloads","resources","subtitle","mappedResources","item","href","url","fileName","name","Downloads","title","downloads","CourseProgramPlayer","_topic$json","_topic$resources","lesson","topic","disableNextTopicButton","getNextPrevTopic","onXAPI","onVideoEnd","onAudioEnd","onPdfEnd","onQuizEnd","onProjectEnd","onProjectsChange","columnWidth","summary","introduction","MarkdownRenderer","style","json","wrapperStyle","CourseProgramContent","isThereAnotherTopic","Boolean","Number","Row","Col","sm","md","lg","CourseProgramLessons","_ref2","program","onNextTopic","onPrevTopic","isNextTopicButtonDisabled","sendProgress","courseProgressDetails","isLastTopic","useLessonProgram","showFinishModal","setShowFinishModal","isLastTopicFinished","setIsLastTopicFinished","onCompleteTopic","topicID","useParams","h5pProgress","lastH5pEvent","setLastH5pEvent","onCompleteH5pTopic","clearState","arguments","undefined","_h5pProgress","String","then","topicCanSkip","topic_id","status","verb","completed","find","_event$statement","_event$statement$verb","_event$statement2","_event$statement2$ver","useCourseProgram","topicBookmark","handleBookmark","topicNote","_bookmarkNotes$list2","_bookmarkNotes$list4","bookmarkNotes","fetchBookmarkNotes","createBookmarkNote","deleteBookmarkNote","useMemo","_bookmarkNotes$list","list","data","filter","bookmarkable_id","_bookmarkNotes$list3","toast","success","bookmarkable_type","API","BookmarkableType","Topic","useBookmarkNotes","finishedTopicIndex","progress","location","useLocation","startWithBreakPoint","pathname","split","getCourseProgress","_courseProgressDetail","_progress$value$find","byId","courseProgress","topicBreakPoint","currentProgress","lastStartedLesson","CourseProgressItemElementStatus","IN_PROGRESS","sort","a","b","Date","started_at","getTime","INCOMPLETE","findLessonBreakPoint","lessons","topics","concat","findIndex","ttopic","COMPLETE","useCourseBreakPoint","window","scrollTo","top","behavior","nextTopic","can_skip","isTopicFinished","topicId","_progress$byId$course","_progress$byId$course2","findTopic","resetProgress","flatMap","onCompleteTopicCb","showModal","topicable_type","TopicType","Video","Audio","GiftQuiz","Project","Pdf","onAutoCompleteTopic","projects","Container","Breadcrumbs","Link","to","home","Title","level","CourseSidebar","onCourseFinish","CourseTopNav","mobile","isMobile","onNext","isFinished","onPrev","addNotes","newNoteData","type","currentNote","addBookmarks","bookmarkBtnText","onBookmarkClick","hasPrev","hasNext","isLast","onCourseFinished","CourseProgramScorm","sco","scorm_sco","uuid","ScormPlayer","React","Fragment","CourseProgram","_program$value","fetchProgram","fetchCourseProgress","Preloader","scorm_sco_id","metaTitle","StyledBreadcrumbs","theme","gray5","gray2","BreadCrumbs","QuestionType","async","response","questionnairesWithCombinedQuestions","Promise","all","res","questionnaireId","questions","console","log","getQuestionnaire","combinedQuestions","reduce","result","element","matchingElement","updatedElement","rate","note","position","getAverageRate","reviewQuestions","sum","avg_rate","toFixed","getCourseQuestionnaireReviewQuestion","_ref3","_questionnaires$find","_questionnaires$find$","questionType","public_answers","QuestionBox","textareaPlaceholder","withStarsRating","handleSubmit","description","answer","setAnswer","onSubmit","submit","Rate","prev","header","TextArea","placeholder","marginTop","onChange","target","Stack","$gap","width","alignSelf","_questionnaire$questi","sendQuestionnaireAnswer","showLastScreen","handleSendAnswer","question_id","visible_on_front","rating","handleSave","Modal","animation","maskAnimation","destroyOnClose","paddingTop","paddingBottom","textAlign","REVIEW"],"mappings":"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","file":"static/js/40.9f1d751b.chunk.js","sourcesContent":["import { useCallback, useContext, useState } from \"react\";\nimport { useParams } from \"react-router-dom\";\nimport { API } from \"@escolalms/sdk/lib\";\nimport { EscolaLMSContext } from \"@escolalms/sdk/lib/react/context\";\nimport { XAPIEvent } from \"@escolalms/h5p-react\";\nimport { completed } from \"@escolalms/sdk/lib/services/courses\";\n\nexport const noCompletedEventsIds: string[] = [\n  \"http://h5p.org/libraries/H5P.ImageJuxtaposition-1.4\",\n  \"http://h5p.org/libraries/H5P.Crossword-0.4\",\n];\n\nconst isXAPIEventAllowed = (event: XAPIEvent) => {\n  const { statement } = event;\n  const eventContextCategoriesIds =\n    statement?.context?.contextActivities?.category?.map(({ id }) => id);\n  const isContextCategoryAllowed =\n    eventContextCategoriesIds &&\n    noCompletedEventsIds.some((value) =>\n      eventContextCategoriesIds?.some((id) => id.includes(value))\n    );\n  return isContextCategoryAllowed;\n};\n\ninterface Props {\n  program: API.CourseProgram;\n  disableNextTopicButton?: (b: boolean) => void;\n  isThereAnotherTopic?: boolean;\n}\n\nexport const useCourseProgram = ({\n  program,\n  disableNextTopicButton,\n  isThereAnotherTopic = true,\n}: Props) => {\n  const { topicID } = useParams<{ lessonID: string; topicID: string }>();\n  const { sendProgress, h5pProgress } = useContext(EscolaLMSContext);\n  const [lastH5pEvent, setLastH5pEvent] = useState<XAPIEvent | null>(null);\n\n  const onCompleteH5pTopic = useCallback(\n    (event: XAPIEvent, clearState: boolean = true): void => {\n      if (program?.id) {\n        h5pProgress(\n          String(program?.id),\n          Number(topicID),\n          event?.statement as API.IStatement\n        )?.then(() => {\n          if (clearState) {\n            setLastH5pEvent(null);\n          }\n        });\n      }\n    },\n    [program?.id, topicID, h5pProgress]\n  );\n\n  const onCompleteTopic = useCallback(\n    (topicCanSkip?: boolean): void => {\n      disableNextTopicButton && disableNextTopicButton(false);\n      if (program?.id && !lastH5pEvent) {\n        sendProgress(program?.id, [{ topic_id: Number(topicID), status: 1 }]);\n      } else if (lastH5pEvent) {\n        onCompleteH5pTopic(\n          {\n            ...lastH5pEvent,\n            statement: {\n              ...lastH5pEvent.statement,\n              verb: {\n                ...lastH5pEvent.statement.verb,\n                id:\n                  topicCanSkip || isXAPIEventAllowed(lastH5pEvent)\n                    ? (completed.find((value) =>\n                        value.includes(\"completed\")\n                      ) as string)\n                    : lastH5pEvent.statement.verb.id,\n              },\n            },\n          },\n          true\n        );\n      }\n    },\n    [\n      lastH5pEvent,\n      disableNextTopicButton,\n      program?.id,\n      sendProgress,\n      topicID,\n      onCompleteH5pTopic,\n    ]\n  );\n\n  const onXAPI = useCallback(\n    (event: XAPIEvent): void => {\n      isThereAnotherTopic &&\n        disableNextTopicButton &&\n        disableNextTopicButton(!Boolean(event?.statement?.verb?.id));\n\n      setLastH5pEvent(event);\n      if (\n        event?.statement &&\n        event?.statement?.verb?.id !==\n          completed.find((value) => value.includes(\"completed\"))\n      ) {\n        onCompleteH5pTopic(event, false);\n      }\n    },\n    [isThereAnotherTopic, disableNextTopicButton, onCompleteH5pTopic]\n  );\n\n  return {\n    onCompleteTopic,\n    onXAPI,\n    onCompleteH5pTopic,\n  };\n};\n","import Layout from \"@/components/_App/Layout\";\nimport { Button, Text } from \"@escolalms/components\";\nimport { useTranslation } from \"react-i18next\";\nimport { useHistory } from \"react-router-dom\";\nimport styled from \"styled-components\";\nimport routeRoutes from \"@/components/Routes/routes\";\n\nconst StyledErrorPage = styled.div`\n  min-height: calc(100vh - 150px);\n  text-align: center;\n  display: flex;\n  justify-content: center;\n  align-items: center;\n  flex-direction: column;\n\n  .buttons-block {\n    display: grid;\n    gap: 8px;\n  }\n`;\n\ninterface AlternativeButton {\n  goTo: string;\n  goToText: string;\n}\n\ninterface Props {\n  error: string;\n  goTo?: string;\n  goToText?: string;\n  alternativeButton?: AlternativeButton;\n}\n\nconst ErrorBox: React.FC<Props> = ({\n  error,\n  goTo = routeRoutes.courses,\n  goToText,\n  alternativeButton,\n}) => {\n  const { t } = useTranslation();\n  const history = useHistory();\n  const buttonText = goToText ?? t(\"CoursePage.SeeOtherCourses\");\n\n  return (\n    <Layout>\n      <StyledErrorPage>\n        <Text size=\"16\">\n          <strong>{t(\"CoursePage.ErrorOccurred\")}</strong>\n        </Text>\n        <Text size=\"14\">{error}</Text>\n        <hr />\n        <div className=\"buttons-block\">\n          <Button mode=\"secondary\" onClick={() => history.push(goTo)}>\n            {buttonText}\n          </Button>\n          {alternativeButton && (\n            <Button\n              mode=\"outline\"\n              onClick={() => history.push(alternativeButton.goTo)}\n            >\n              {alternativeButton.goToText}\n            </Button>\n          )}\n        </div>\n      </StyledErrorPage>\n    </Layout>\n  );\n};\nexport default ErrorBox;\n","import styled from \"styled-components\";\n\nexport const StyledCourse = styled.section`\n  padding-bottom: 110px;\n  .main-title {\n    margin-bottom: 20px;\n  }\n  .course-nav {\n    position: fixed;\n    bottom: 0;\n    left: 0;\n    width: 100%;\n    z-index: 100;\n  }\n  img {\n    max-width: 100%;\n    height: auto;\n  }\n\n  .course-program-finish-modal {\n    font-family: \"Mulish\", sans-serif;\n    background: #f8f8f8;\n    inset: 0;\n    border: 1px solid #157493;\n    padding: 16px;\n    display: grid;\n    place-content: center;\n    gap: 16px;\n    height: 100%;\n    max-height: 500px;\n\n    p {\n      text-align: center;\n      margin: 0;\n    }\n\n    &__title {\n      font-size: 24px;\n      font-weight: 500;\n    }\n\n    &__paragraph {\n      font-size: 18px;\n    }\n\n    &__buttons {\n      display: grid;\n      grid-auto-flow: column;\n      gap: 8px;\n      justify-content: center;\n      margin-top: 8px;\n    }\n  }\n`;\n","import { useTranslation } from \"react-i18next\";\nimport { Button } from \"@escolalms/components/lib/components/atoms/Button/Button\";\nimport { useHistory } from \"react-router-dom\";\nimport { useCallback, useContext, useEffect, useState } from \"react\";\nimport { API } from \"@escolalms/sdk/lib\";\nimport { EscolaLMSContext } from \"@escolalms/sdk/lib/react\";\nimport RateCourse from \"@/components/RateCourse\";\nimport { QuestionnaireModelType } from \"@/types/questionnaire\";\nimport { Spin } from \"@escolalms/components\";\nimport { getQuestionnaires } from \"@/utils/questionnaires\";\nimport routeRoutes from \"@/components/Routes/routes\";\n\ninterface FinishModalProps {\n  courseId?: number;\n}\n\nconst CourseFinishModal = ({ courseId }: FinishModalProps) => {\n  const { t } = useTranslation();\n  const { push } = useHistory();\n  const [state, setState] = useState({\n    show: false,\n    step: 0,\n    loading: false,\n  });\n  const [questionnaires, setQuestionnaires] = useState<API.Questionnaire[]>([]);\n  const { fetchQuestionnaires, fetchQuestionnaire } =\n    useContext(EscolaLMSContext);\n  const handleClose = useCallback(() => {\n    setState((prevState) => ({\n      ...prevState,\n      show: false,\n    }));\n\n    if (state.step < questionnaires.length - 1) {\n      setState((prevState) => ({\n        ...prevState,\n        step: prevState.step + 1,\n      }));\n\n      const timer = setTimeout(() => {\n        setState((prevState) => ({\n          ...prevState,\n          show: true,\n        }));\n      }, 500);\n      return () => clearTimeout(timer);\n    }\n  }, [questionnaires, state.step]);\n\n  useEffect(() => {\n    setState((prevState) => ({\n      ...prevState,\n      loading: true,\n    }));\n    courseId &&\n      getQuestionnaires({\n        courseId,\n        fetchQuestionnaire,\n        fetchQuestionnaires,\n        onSucces: (items) => {\n          setQuestionnaires(items);\n        },\n        onFinish: () =>\n          setState((prevState) => ({\n            ...prevState,\n            loading: false,\n          })),\n      });\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [courseId]);\n\n  return (\n    <>\n      <div className=\"course-program-finish-modal\">\n        {state.loading ? (\n          <Spin />\n        ) : (\n          <>\n            <p className=\"course-program-finish-modal__title\">\n              {t(\"CourseProgram.FinishTitle\")}\n            </p>\n\n            <p className=\"course-program-finish-modal__paragraph\">\n              {!!questionnaires?.length\n                ? t(\"CourseProgram.FinishSubtitle\")\n                : t(\"CourseProgram.FinishSubtitleNoRating\")}\n            </p>\n            <div className=\"course-program-finish-modal__buttons\">\n              {!!questionnaires?.length && (\n                <Button\n                  mode=\"primary\"\n                  onClick={() =>\n                    setState((prevState) => ({\n                      ...prevState,\n                      show: true,\n                    }))\n                  }\n                >\n                  {t(\"MyProfilePage.RateCourse\")}\n                </Button>\n              )}\n              <Button\n                mode=\"primary\"\n                onClick={() => push(routeRoutes.myProfile)}\n              >\n                {t(\"Menu.Profile\")}\n              </Button>\n              <Button mode=\"primary\" onClick={() => push(routeRoutes.courses)}>\n                {t(\"Menu.Courses\")}\n              </Button>\n            </div>\n          </>\n        )}\n      </div>\n\n      {state.show && courseId && !!questionnaires.length && (\n        <RateCourse\n          course={QuestionnaireModelType.COURSE}\n          courseId={courseId}\n          visible={state.show}\n          onClose={() => handleClose()}\n          questionnaire={questionnaires[state.step]}\n        />\n      )}\n    </>\n  );\n};\n\nexport default CourseFinishModal;\n","import React from \"react\";\nimport { Downloads } from \"@escolalms/components/lib/components/molecules/Downloads/Downloads\";\nimport styled from \"styled-components\";\nimport { useTranslation } from \"react-i18next\";\nimport { API } from \"@escolalms/sdk/lib\";\n\ntype Props = {\n  resources: API.TopicResource[];\n  subtitle: string;\n};\n\nconst StyledDownloads = styled.div`\n  margin-top: 100px;\n`;\n\nconst CourseDownloads: React.FC<Props> = ({ resources, subtitle }) => {\n  const { t } = useTranslation();\n  const mappedResources = resources.map((item) => {\n    return { href: item.url, fileName: item.name };\n  });\n  return (\n    <StyledDownloads>\n      <Downloads\n        subtitle={subtitle}\n        title={t<string>(\"CourseProgram.TopicAttachment\")}\n        downloads={mappedResources}\n      />\n    </StyledDownloads>\n  );\n};\n\nexport default CourseDownloads;\n","import React from \"react\";\nimport { Col, Row } from \"react-grid-system\";\nimport { API } from \"@escolalms/sdk/lib\";\nimport { XAPIEvent } from \"@escolalms/h5p-react\";\nimport { MarkdownRenderer } from \"@escolalms/components/lib/components/molecules/MarkdownRenderer/MarkdownRenderer\";\n\nimport CourseProgramContent from \"@/components/Course/CourseProgramContent\";\nimport CourseDownloads from \"../CourseDownloads\";\nimport { ProjectsData } from \"@escolalms/components/lib/components/players/ProjectPlayer/ProjectPlayer\";\n\ninterface Props {\n  lesson: API.Lesson | undefined;\n  topic: API.Topic | undefined;\n  disableNextTopicButton: React.Dispatch<React.SetStateAction<boolean>>;\n  getNextPrevTopic: (\n    topicId: number,\n    next?: boolean | undefined\n  ) => API.Topic | null;\n  onXAPI?: (event: XAPIEvent) => void;\n  onVideoEnd?: () => void;\n  onAudioEnd?: () => void;\n  onPdfEnd?: () => void;\n  onQuizEnd?: () => void;\n  onProjectEnd?: () => void;\n  onProjectsChange?: (projects: ProjectsData) => void;\n}\n\nconst CourseProgramPlayer = ({\n  lesson,\n  topic,\n  disableNextTopicButton,\n  getNextPrevTopic,\n  onXAPI,\n  onVideoEnd,\n  onAudioEnd,\n  onPdfEnd,\n  onQuizEnd,\n  onProjectEnd,\n  onProjectsChange,\n}: Props) => {\n  const columnWidth =\n    lesson && lesson.summary && topic && topic.summary ? 6 : 12;\n\n  return (\n    <div className=\"course-program-player\">\n      <div className=\"course-program-player-content\">\n        {topic && topic.introduction && (\n          <MarkdownRenderer>{topic.introduction}</MarkdownRenderer>\n        )}\n        <div\n          className=\"course-program-player-content__wrapper\"\n          style={{\n            ...((topic?.json?.wrapperStyle as object) || {}),\n          }}\n        >\n          <CourseProgramContent\n            key={topic?.id}\n            topic={topic}\n            disableNextTopicButton={disableNextTopicButton}\n            isThereAnotherTopic={Boolean(getNextPrevTopic(Number(topic?.id)))}\n            onXAPI={(event) => onXAPI?.(event)}\n            onVideoEnd={onVideoEnd}\n            onAudioEnd={onAudioEnd}\n            onPdfEnd={onPdfEnd}\n            onQuizEnd={onQuizEnd}\n            onProjectEnd={onProjectEnd}\n            onProjectsChange={onProjectsChange}\n          />\n        </div>\n      </div>\n      <div className=\"course-program-content__container\">\n        <Row>\n          {lesson && lesson.summary && (\n            <Col sm={12} md={columnWidth} lg={columnWidth}>\n              <div className=\"course-program-summary\">\n                <MarkdownRenderer>{lesson.summary}</MarkdownRenderer>\n              </div>\n            </Col>\n          )}\n          {topic && topic.summary && (\n            <Col sm={12} md={columnWidth} lg={columnWidth}>\n              <div className=\"course-program-summary\">\n                <MarkdownRenderer>{topic.summary}</MarkdownRenderer>\n\n                {topic && topic.resources && topic.resources?.length > 0 && (\n                  <CourseDownloads\n                    resources={topic.resources || []}\n                    subtitle={topic.introduction || \"\"}\n                  />\n                )}\n              </div>\n            </Col>\n          )}\n        </Row>\n      </div>\n    </div>\n  );\n};\n\nexport default CourseProgramPlayer;\n","import React, { useCallback, useEffect, useState } from \"react\";\nimport { Link } from \"react-router-dom\";\nimport { isMobile } from \"react-device-detect\";\nimport { useTranslation } from \"react-i18next\";\nimport { Col, Row } from \"react-grid-system\";\nimport { toast } from \"react-toastify\";\nimport { API } from \"@escolalms/sdk/lib\";\nimport { Title } from \"@escolalms/components/lib/components/atoms/Typography/Title\";\nimport { Text } from \"@escolalms/components/lib/components/atoms/Typography/Text\";\nimport {\n  CourseTopNav,\n  NoteData,\n} from \"@escolalms/components/lib/components/molecules/CourseTopNav/CourseTopNav\";\n\nimport CourseSidebar from \"@/components/Course/CourseSidebar\";\nimport { useLessonProgram } from \"@/hooks/useLessonProgram\";\nimport { useCourseProgram } from \"@/hooks/useCourseProgram\";\nimport { useBookmarkNotes } from \"@/hooks/useBookmarkNotes\";\nimport { useCourseBreakPoint } from \"@/hooks/useCourseBreakPoint\";\nimport Breadcrumbs from \"../Breadcrumbs\";\nimport Container from \"../Container\";\nimport ErrorBox from \"../Errorbox\";\nimport { StyledCourse } from \"./CourseProgramLessonsStyles\";\nimport CourseFinishModal from \"./CourseFinishModal\";\nimport CourseProgramPlayer from \"./CourseProgramPlayer\";\nimport { BookmarkableType } from \"@escolalms/sdk/lib/types/api\";\nimport routeRoutes from \"@/components/Routes/routes\";\nimport { ContextStateValue } from \"@escolalms/sdk/lib/react/context/types\";\nimport { ProjectsData } from \"@escolalms/components/lib/components/players/ProjectPlayer/ProjectPlayer\";\n\nexport const isTopicFinished = (\n  progress: ContextStateValue<API.CourseProgressDetails>,\n  topicId: number,\n  courseId: number | undefined\n) => {\n  if (!topicId || !courseId || !progress.byId) return false;\n  const findTopic = progress.byId[courseId]?.value?.find(\n    ({ topic_id: id }) => topicId === id\n  );\n  if (findTopic?.status === 1) {\n    return true;\n  }\n  return false;\n};\n\nexport const CourseProgramLessons: React.FC<{\n  program: API.CourseProgram;\n  courseId?: number;\n}> = ({ program, courseId }) => {\n  const {\n    topic,\n    lesson,\n    onNextTopic,\n    onPrevTopic,\n    getNextPrevTopic,\n    isNextTopicButtonDisabled,\n    disableNextTopicButton,\n    sendProgress,\n    courseProgressDetails,\n    isLastTopic,\n  } = useLessonProgram(program);\n  const [showFinishModal, setShowFinishModal] = useState(false);\n  const [isLastTopicFinished, setIsLastTopicFinished] = useState(false);\n  const { onCompleteTopic, onXAPI } = useCourseProgram({ program });\n  const { topicBookmark, handleBookmark, topicNote } = useBookmarkNotes({\n    topic,\n    lesson,\n    program,\n    courseId,\n  });\n  const { finishedTopicIndex } = useCourseBreakPoint({\n    courseId,\n    program,\n    topic,\n  });\n  const { t } = useTranslation();\n\n  useEffect(() => {\n    window.scrollTo({ top: 0, behavior: \"smooth\" });\n  }, [lesson?.id, topic?.id]);\n\n  useEffect(() => {\n    const nextTopic = getNextPrevTopic(Number(topic?.id));\n    if (!program || !topic) return;\n    if (\n      nextTopic === null ||\n      (topic.can_skip === false &&\n        isTopicFinished(courseProgressDetails, topic.id, courseId) === false)\n    ) {\n      disableNextTopicButton(true);\n      return;\n    } else {\n      disableNextTopicButton(false);\n    }\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [topic?.id, program, courseProgressDetails, courseId]);\n\n  //@ts-ignore\n  window.resetProgress = () =>\n    (async () => {\n      await sendProgress(\n        program.id,\n        program.lessons\n          .flatMap((lesson) => lesson.topics)\n          .map((topic) => ({ topic_id: Number(topic?.id), status: 0 }))\n      );\n    })();\n\n  const onCompleteTopicCb = useCallback(\n    (showModal?: boolean) => {\n      // If video, audio or pdf etc can't be skipped not allow to complete\n      // onAudioEnd or onVideoEnd etc in CourseProgramPlayer component will complete topic\n      if (\n        (topic?.topicable_type === API.TopicType.Video ||\n          topic?.topicable_type === API.TopicType.Audio ||\n          topic?.topicable_type === API.TopicType.GiftQuiz ||\n          topic?.topicable_type === API.TopicType.Project ||\n          topic?.topicable_type === API.TopicType.Pdf) &&\n        topic?.can_skip === false &&\n        !isLastTopicFinished\n      ) {\n        return false;\n      }\n      onCompleteTopic(topic?.can_skip);\n      if (showModal) {\n        setShowFinishModal(true);\n      }\n    },\n    [\n      isLastTopicFinished,\n      onCompleteTopic,\n      topic?.can_skip,\n      topic?.topicable_type,\n    ]\n  );\n\n  const onAutoCompleteTopic = useCallback(() => {\n    isLastTopic ? setIsLastTopicFinished(true) : onCompleteTopic();\n  }, [isLastTopic, onCompleteTopic]);\n\n  const onProjectsChange = useCallback(\n    (projects: ProjectsData) => {\n      if (projects.data.length > 0) {\n        onAutoCompleteTopic();\n        return;\n      }\n      if (isLastTopic) {\n        setIsLastTopicFinished(false);\n      }\n    },\n    [isLastTopic, onAutoCompleteTopic]\n  );\n\n  if (!program) {\n    return <ErrorBox error={t(\"CourseProgram.NoProgram\")} />;\n  }\n\n  if (!topic) {\n    return (\n      <ErrorBox\n        error={t(\"CourseProgram.NoTopic\")}\n        goTo={`/course/${program.id}`}\n        goToText={t(\"CoursePage.BackToCourse\")}\n        alternativeButton={{\n          goTo: routeRoutes.courses,\n          goToText: t(\"CoursePage.SeeOtherCourses\"),\n        }}\n      />\n    );\n  }\n\n  return (\n    <StyledCourse className=\"course-program-wrapper\">\n      <Container>\n        <Breadcrumbs\n          items={[\n            <Link to={routeRoutes.home}>{t(\"Home\")}</Link>,\n            <Link to={routeRoutes.courses}>{t(\"Courses\")}</Link>,\n            <Text size=\"12\">{program.title}</Text>,\n            <Text size=\"12\">{topic.title}</Text>,\n          ]}\n        />\n        <Title className=\"main-title\" level={3}>\n          {topic.title}\n        </Title>\n        <Row>\n          <Col lg={9}>\n            {showFinishModal && <CourseFinishModal courseId={courseId} />}\n            {!showFinishModal && (\n              <CourseProgramPlayer\n                lesson={lesson}\n                topic={topic}\n                onXAPI={onXAPI}\n                disableNextTopicButton={disableNextTopicButton}\n                getNextPrevTopic={getNextPrevTopic}\n                onAudioEnd={onAutoCompleteTopic}\n                onVideoEnd={onAutoCompleteTopic}\n                onPdfEnd={onAutoCompleteTopic}\n                onQuizEnd={onAutoCompleteTopic}\n                onProjectEnd={onAutoCompleteTopic}\n                onProjectsChange={onProjectsChange}\n              />\n            )}\n          </Col>\n          <Col lg={3}>\n            <CourseSidebar\n              course={program}\n              topicId={Number(topic?.id)}\n              onCourseFinish={() => onCompleteTopicCb(true)}\n              onCompleteTopic={onCompleteTopicCb}\n            />\n          </Col>\n        </Row>\n      </Container>\n      <div className=\"course-nav\">\n        <Container>\n          <CourseTopNav\n            onFinish={onCompleteTopicCb}\n            mobile={isMobile}\n            onNext={onNextTopic}\n            isFinished={\n              typeof finishedTopicIndex === \"number\"\n                ? finishedTopicIndex > -1\n                : false\n            }\n            onPrev={onPrevTopic}\n            addNotes\n            newNoteData={{\n              id: topic.id,\n              type: `${courseId}/${lesson?.id}/${topic?.id}:${program.title}:${topic?.title}` as BookmarkableType,\n            }}\n            currentNote={topicNote?.[0] as NoteData | undefined}\n            addBookmarks\n            bookmarkBtnText={\n              topicBookmark?.length ? \"deleteBookmark\" : \"addBookmark\"\n            }\n            onBookmarkClick={() => handleBookmark()}\n            hasPrev={!!getNextPrevTopic(Number(topic?.id), false)}\n            hasNext={!isNextTopicButtonDisabled}\n            isLast={isLastTopic}\n            onCourseFinished={() => onCompleteTopicCb(true)}\n          />\n        </Container>\n      </div>\n    </StyledCourse>\n  );\n};\n\nexport default CourseProgramLessons;\n","import { useContext, useMemo } from \"react\";\nimport { toast } from \"react-toastify\";\nimport { useTranslation } from \"react-i18next\";\nimport { EscolaLMSContext } from \"@escolalms/sdk/lib/react/context\";\nimport { API } from \"@escolalms/sdk/lib\";\n\ninterface Props {\n  topic?: API.Topic;\n  courseId?: number;\n  program: API.CourseProgram;\n  lesson?: API.Lesson;\n}\n\nexport const useBookmarkNotes = ({\n  topic,\n  courseId,\n  program,\n  lesson,\n}: Props) => {\n  const {\n    bookmarkNotes,\n    fetchBookmarkNotes,\n    createBookmarkNote,\n    deleteBookmarkNote,\n  } = useContext(EscolaLMSContext);\n  const { t } = useTranslation();\n\n  const topicBookmark = useMemo(\n    () =>\n      bookmarkNotes.list?.data.filter(\n        (item) =>\n          item.bookmarkable_id === Number(topic?.id) && item.value === null\n      ),\n    [bookmarkNotes.list?.data, topic?.id]\n  );\n\n  const handleBookmark = () => {\n    return !topicBookmark?.length\n      ? createBookmarkNote({\n          bookmarkable_id: Number(topic?.id),\n          bookmarkable_type: API.BookmarkableType.Topic,\n          value: null,\n        }).then(() => {\n          fetchBookmarkNotes();\n          toast.success(t<string>(\"Notifications.CreateBookmark\"));\n        })\n      : deleteBookmarkNote(topicBookmark[0].id).then(() => {\n          fetchBookmarkNotes();\n          toast.success(t<string>(\"Notifications.DeleteBookmark\"));\n        });\n  };\n\n  const topicNote = useMemo(\n    () =>\n      bookmarkNotes.list?.data.filter(\n        (item) =>\n          item.bookmarkable_id === Number(topic?.id) && item.value !== null\n      ),\n    [bookmarkNotes.list?.data, topic?.id]\n  );\n\n  return {\n    handleBookmark,\n    topicBookmark,\n    topicNote,\n  };\n};\n","import { useContext, useEffect, useMemo } from \"react\";\nimport { useHistory, useLocation } from \"react-router-dom\";\nimport { API } from \"@escolalms/sdk/lib\";\nimport { EscolaLMSContext } from \"@escolalms/sdk/lib/react/context\";\n\ninterface Props {\n  courseId: number | undefined;\n  program: API.CourseProgram;\n  topic: API.Topic | undefined;\n}\n\nexport const useCourseBreakPoint = ({ courseId, program, topic }: Props) => {\n  const { courseProgressDetails, progress } = useContext(EscolaLMSContext);\n  const location = useLocation();\n  const { push } = useHistory();\n  // if pathname contain 3 splited items we cannot fire topicbreakpoint effect otherwise we can\n  const startWithBreakPoint = location.pathname.split(\"/\").length === 3;\n\n  const getCourseProgress = useMemo(() => {\n    if (\n      courseProgressDetails.byId?.[Number(courseId)] &&\n      courseProgressDetails.byId[Number(courseId)].value\n    ) {\n      return courseProgressDetails.byId[Number(courseId)].value;\n    }\n    return (\n      progress &&\n      progress.value &&\n      progress.value.find(\n        (courseProgress: API.CourseProgressItem) =>\n          courseProgress.course.id === Number(courseId)\n      )?.progress\n    );\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [progress, courseId]);\n\n  const topicBreakPoint = useMemo(() => {\n    const currentProgress = getCourseProgress || [];\n\n    const lastStartedLesson = currentProgress\n      .filter(\n        (topic: API.CourseProgressItemElement) =>\n          topic.status === API.CourseProgressItemElementStatus.IN_PROGRESS\n      )\n      .sort(\n        (a: API.CourseProgressItemElement, b: API.CourseProgressItemElement) =>\n          new Date(b.started_at as string).getTime() -\n          new Date(a.started_at as string).getTime()\n      )[0];\n\n    if (!lastStartedLesson) {\n      return currentProgress.filter(\n        (topic: API.CourseProgressItemElement) =>\n          topic.status === API.CourseProgressItemElementStatus.INCOMPLETE\n      )[0];\n    }\n    return lastStartedLesson;\n  }, [getCourseProgress]);\n\n  const findLessonBreakPoint = useMemo(() => {\n    return (\n      topicBreakPoint &&\n      program.lessons.find(\n        (lesson: API.Lesson) =>\n          lesson &&\n          lesson.topics &&\n          lesson.topics.some(\n            (topic: API.Topic) => topic.id === topicBreakPoint.topic_id\n          )\n      )\n    );\n  }, [program, topicBreakPoint]);\n\n  useEffect(() => {\n    if (startWithBreakPoint) {\n      if (findLessonBreakPoint && topicBreakPoint) {\n        push(\n          `/course/${program.id}/${findLessonBreakPoint.id}/${topicBreakPoint.topic_id}`,\n          null\n        );\n      }\n    }\n  }, [\n    startWithBreakPoint,\n    findLessonBreakPoint,\n    program,\n    push,\n    topicBreakPoint,\n  ]);\n\n  const finishedTopicIndex = getCourseProgress?.findIndex((ttopic) => {\n    return (\n      ttopic.topic_id === topic?.id &&\n      ttopic.status === API.CourseProgressItemElementStatus.COMPLETE\n    );\n  });\n\n  return {\n    getCourseProgress,\n    finishedTopicIndex,\n  };\n};\n","import React, { useContext, useEffect } from \"react\";\nimport { useParams } from \"react-router-dom\";\nimport { API } from \"@escolalms/sdk/lib\";\nimport { EscolaLMSContext } from \"@escolalms/sdk/lib/react/context\";\nimport Preloader from \"@/components/Preloader\";\nimport Layout from \"@/components/_App/Layout\";\n\nimport CourseProgramLessons from \"@/components/Course/CourseProgramLessons\";\nimport ErrorBox from \"@/components/Errorbox\";\nimport { t } from \"i18next\";\nimport ScormPlayer from \"@/components/Course/Players/ScormPlayer\";\n\nconst CourseProgramScorm: React.FC<{ program: API.CourseProgram }> = ({\n  program,\n}) => {\n  const sco = program?.scorm_sco;\n  const uuid = sco?.uuid;\n\n  if (!sco && !uuid) {\n    return <React.Fragment />;\n  }\n\n  return (\n    <ScormPlayer\n      value={{\n        title: sco.title,\n        uuid: sco.uuid,\n      }}\n    />\n  );\n};\n\nconst CourseProgram = () => {\n  const { id } = useParams<{ id: string }>();\n  const { program, fetchProgram, fetchCourseProgress } =\n    useContext(EscolaLMSContext);\n\n  useEffect(() => {\n    if (id) {\n      fetchProgram(Number(id));\n      fetchCourseProgress(Number(id));\n    }\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [id]);\n  if (program.loading) {\n    return <Preloader />;\n  }\n  if (program.error) {\n    return <ErrorBox error={t(\"CourseProgram.NoProgram\")} />;\n  }\n  if (program.value && program?.value?.scorm_sco_id) {\n    return (\n      <Layout metaTitle={program.value.title}>\n        <CourseProgramScorm program={program.value} />\n      </Layout>\n    );\n  }\n  if (program.value && program.value.lessons && program.value.lessons.length) {\n    return (\n      <Layout metaTitle={program.value.title}>\n        <CourseProgramLessons program={program.value} courseId={Number(id)} />\n      </Layout>\n    );\n  }\n\n  return <Preloader />;\n};\n\nexport default CourseProgram;\n","import React from \"react\";\nimport { BreadCrumbs } from \"@escolalms/components/lib/components/atoms/BreadCrumbs/BreadCrumbs\";\nimport styled from \"styled-components\";\n\ntype Props = {\n  items: React.ReactNode[];\n};\n\nconst StyledBreadcrumbs = styled.div`\n  margin-bottom: 15px;\n  a {\n    text-decoration: none;\n    color: ${({ theme }) =>\n      theme.mode === \"dark\" ? theme.gray5 : theme.gray2}!important;\n  }\n`;\n\nconst Breadcrumbs: React.FC<Props> = ({ items }) => {\n  return (\n    <StyledBreadcrumbs>\n      <BreadCrumbs items={items} />\n    </StyledBreadcrumbs>\n  );\n};\n\nexport default Breadcrumbs;\n","export enum QuestionnaireModelType {\n  COURSE = \"course\",\n  WEBINAR = \"webinar\",\n}\n\nexport enum QuestionType {\n  RATE = \"rate\",\n  TEXT = \"text\",\n  REVIEW = \"review\",\n}\n","import { QuestionType, QuestionnaireModelType } from \"@/types/questionnaire\";\nimport { API } from \"@escolalms/sdk/lib\";\nimport { t } from \"i18next\";\nimport { toast } from \"react-toastify\";\n\ntype getQuestionnaireProps = {\n  questionnaireId: number;\n  courseId: number;\n  fetchQuestionnaire: (\n    modelTypeTitle: string,\n    modelID: number,\n    id: number\n  ) => Promise<API.DefaultResponse<API.QuestionnaireAnswerResponse>>;\n};\n\ntype getQuestionnairesProps = {\n  courseId: number;\n  fetchQuestionnaire: (\n    modelTypeTitle: string,\n    modelID: number,\n    id: number\n  ) => Promise<API.DefaultResponse<API.QuestionnaireAnswerResponse>>;\n  fetchQuestionnaires: (\n    model: string,\n    id: number\n  ) => Promise<API.DefaultMetaResponse<API.Questionnaire>>;\n  onSucces: (questionnairesArray: API.Questionnaire[]) => void;\n  onFinish: () => void;\n};\n\nconst getQuestionnaire = async ({\n  courseId,\n  questionnaireId,\n  fetchQuestionnaire,\n}: getQuestionnaireProps) => {\n  try {\n    const response =\n      courseId &&\n      (await fetchQuestionnaire(\n        QuestionnaireModelType.COURSE,\n        courseId,\n        questionnaireId\n      ));\n    if (response && response.success) {\n      return response.data.questions;\n    }\n  } catch (error) {\n    toast.error(t<string>(\"UnexpectedError\"));\n    console.log(error);\n  }\n};\n\nexport const getQuestionnaires = async ({\n  courseId,\n  fetchQuestionnaires,\n  fetchQuestionnaire,\n  onSucces,\n  onFinish,\n}: getQuestionnairesProps) => {\n  try {\n    const response =\n      courseId &&\n      (await fetchQuestionnaires(QuestionnaireModelType.COURSE, courseId));\n    if (response && response.success) {\n      const questionnairesWithCombinedQuestions = await Promise.all(\n        response.data.map(async (data) => {\n          const res = await getQuestionnaire({\n            courseId,\n            questionnaireId: data.id,\n            fetchQuestionnaire,\n          });\n\n          const combinedQuestions = data.questions.reduce((result, element) => {\n            const matchingElement = res?.find((item) => item.id === element.id);\n\n            const updatedElement = {\n              ...element,\n              rate: matchingElement?.rate,\n              note: matchingElement?.note,\n            };\n\n            updatedElement.rate === null &&\n              updatedElement.note === null &&\n              result.push(updatedElement);\n            return result;\n          }, [] as API.QuestionnaireQuestion[]);\n\n          return {\n            ...data,\n            questions: combinedQuestions.sort(\n              (a, b) => a.position - b.position\n            ),\n          };\n        })\n      );\n\n      onSucces(\n        questionnairesWithCombinedQuestions.filter(\n          (item) => !!item.questions.length\n        )\n      );\n    }\n  } catch (error) {\n    toast.error(t<string>(\"UnexpectedError\"));\n    console.log(error);\n  } finally {\n    onFinish();\n  }\n};\n\nexport const getAverageRate = (reviewQuestions: API.QuestionnaireStars[]) => {\n  const avgRate =\n    reviewQuestions.reduce((sum, item) => sum + item.avg_rate, 0) /\n    reviewQuestions.length;\n  return avgRate.toFixed(1);\n};\n\nexport const getCourseQuestionnaireReviewQuestion = ({\n  questionnaires,\n  questionnaireId,\n  questionType,\n}: {\n  questionnaires: API.Questionnaire[];\n  questionnaireId: number | null;\n  questionType: QuestionType;\n}) => {\n  return questionnaires\n    ?.find((element) => element.id === questionnaireId)\n    ?.questions.filter((item) => item.public_answers)\n    .find((item) => item.type === questionType)?.id;\n};\n","import { FC, useState } from \"react\";\nimport { API } from \"@escolalms/sdk/lib\";\nimport {\n  Button,\n  Rate,\n  Stack,\n  TextArea,\n  Title,\n  Text,\n} from \"@escolalms/components\";\nimport { useTranslation } from \"react-i18next\";\ninterface QuestionBoxProps {\n  withStarsRating?: boolean;\n  data: API.QuestionnaireQuestion;\n  textareaPlaceholder: string;\n  handleSubmit: (rate: number, note?: string) => void;\n}\n\nexport const QuestionBox: FC<QuestionBoxProps> = ({\n  data,\n  textareaPlaceholder,\n  withStarsRating,\n  handleSubmit,\n}) => {\n  const { t } = useTranslation();\n  const { title, description } = data;\n  const [answer, setAnswer] = useState({ rate: 0, note: \"\" });\n\n  const submit = () => {\n    handleSubmit(answer.rate, answer.note);\n    setAnswer({ rate: 0, note: \"\" });\n  };\n\n  return (\n    <form onSubmit={submit}>\n      {!!withStarsRating ? (\n        <Rate\n          onSubmit={(rate) => setAnswer((prev) => ({ ...prev, rate }))}\n          header={data.title}\n        >\n          <TextArea\n            placeholder={textareaPlaceholder}\n            style={{ marginTop: \"30px\" }}\n            value={answer.note}\n            onChange={({ target: { value } }) =>\n              setAnswer((prev) => ({ ...prev, note: value }))\n            }\n          />\n        </Rate>\n      ) : (\n        <Stack $gap={30}>\n          <Title>{title}</Title>\n          <Text>{description}</Text>\n          <TextArea\n            placeholder={textareaPlaceholder}\n            value={answer.note}\n            onChange={({ target: { value } }) =>\n              setAnswer((prev) => ({ ...prev, note: value }))\n            }\n          />\n          <Button\n            type=\"submit\"\n            mode=\"primary\"\n            style={{ width: \"fit-content\", alignSelf: \"center\" }}\n          >\n            {answer.note.length\n              ? t(\"RateCourse.SendAnswer\")\n              : t(\"RateCourse.NoAnswer\")}\n          </Button>\n        </Stack>\n      )}\n    </form>\n  );\n};\n","import React, { useCallback, useContext, useState } from \"react\";\nimport { Modal } from \"@escolalms/components/lib/components/atoms/Modal/Modal\";\nimport { EscolaLMSContext } from \"@escolalms/sdk/lib/react\";\nimport { toast } from \"react-toastify\";\nimport { Title } from \"@escolalms/components/lib/components/atoms/Typography/Title\";\nimport { Text } from \"@escolalms/components/lib/components/atoms/Typography/Text\";\nimport { useTranslation } from \"react-i18next\";\nimport { API } from \"@escolalms/sdk/lib\";\nimport { QuestionBox } from \"../QuestionBox\";\nimport { QuestionType } from \"@/types/questionnaire\";\n\ntype Props = {\n  course: string;\n  courseId: number;\n  visible: boolean;\n  questionnaire: API.Questionnaire;\n  onClose: () => void;\n};\n\nconst RateCourse: React.FC<Props> = ({\n  course,\n  courseId,\n  visible,\n  questionnaire,\n  onClose,\n}) => {\n  const { sendQuestionnaireAnswer } = useContext(EscolaLMSContext);\n  const { t } = useTranslation();\n\n  const [state, setState] = useState({\n    loading: false,\n    step: 0,\n    showLastScreen: false,\n  });\n\n  const handleSendAnswer = useCallback(\n    async (rate: number, note?: string) => {\n      if (questionnaire.questions) {\n        setState((prevState) => ({\n          ...prevState,\n          loading: true,\n        }));\n        try {\n          const request = await sendQuestionnaireAnswer(\n            course,\n            courseId,\n            questionnaire.id,\n            {\n              question_id: questionnaire.questions[state.step].id,\n              rate,\n              note,\n              visible_on_front:\n                questionnaire.questions[state.step].public_answers,\n            }\n          );\n          if (request.success) {\n            toast.success(t(\"RateCourse.ThankYouMessage\"));\n          }\n        } catch (error) {\n          toast.error(\"Error\");\n          console.error(error);\n        } finally {\n          setState((prevState) => ({\n            ...prevState,\n            loading: false,\n            step: prevState.step + 1,\n            note: \"\",\n            rating: null,\n          }));\n        }\n      }\n    },\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n    [course, courseId, questionnaire.id, state]\n  );\n\n  const handleSave = useCallback(\n    (rate: number, note?: string) => {\n      handleSendAnswer(rate, note);\n      if (\n        questionnaire.questions &&\n        state.step === questionnaire.questions.length - 1\n      ) {\n        setState((prevState) => ({\n          ...prevState,\n          showLastScreen: true,\n        }));\n      }\n    },\n    [questionnaire, state.step, handleSendAnswer]\n  );\n\n  return (\n    <Modal\n      onClose={onClose}\n      visible={visible}\n      animation=\"zoom\"\n      maskAnimation=\"fade\"\n      destroyOnClose={true}\n      width={468}\n    >\n      {!state.showLastScreen ? (\n        questionnaire.questions && (\n          <QuestionBox\n            textareaPlaceholder={t(\"RateCourse.OptionalComment\")}\n            data={questionnaire.questions[state.step]}\n            handleSubmit={(rate, note) => handleSave(rate, note)}\n            withStarsRating={\n              questionnaire.questions[state.step]?.type === QuestionType.REVIEW\n            }\n          />\n        )\n      ) : (\n        <React.Fragment>\n          <Title\n            level={4}\n            className=\"modal-title\"\n            style={{\n              paddingTop: \"50px\",\n            }}\n          >\n            {t(\"RateCourse.ThankYou\")}\n          </Title>\n          <Text\n            style={{\n              paddingBottom: \"50px\",\n              textAlign: \"center\",\n            }}\n          >\n            {t(\"RateCourse.ThankYouMessage\")}\n          </Text>\n        </React.Fragment>\n      )}\n    </Modal>\n  );\n};\n\nexport default RateCourse;\n"],"sourceRoot":""}